<?xml version="1.0"?>
<!-- **********************************************************************-->
<!-- Copyright 2013-2025                                                   -->
<!-- Nicholas Long, Mitchel Keller, Steven Schlicker                       -->
<!--                                                                       -->
<!-- This file is part of Active Calculus Multivariable.                   -->
<!--                                                                       -->
<!-- Permission is granted to copy, distribute and/or modify this document -->
<!-- under the terms of the Creative Commons BY-NC-SA license.  The work   -->
<!-- may be used for free by any party so long as attribution is given to  -->
<!-- the author(s), the work and its derivatives are used in the spirit of -->
<!-- "share and share alike"; no party may sell this work or any of its    -->
<!-- derivatives for profit.  All trademarks are the registered marks of   -->
<!-- their respective owners.                                              -->
<!-- **********************************************************************-->
<section xml:id="S-11-8-Triple-Integrals-Cylindrical-Spherical" xmlns:xi="http://www.w3.org/2001/XInclude">
  <title>Triple Integrals in Cylindrical and Spherical Coordinates</title>
  
    <objectives>
        <ul>
          <!-- <li>
            <p>
              What are the cylindrical coordinates of a point, and how are they related to Cartesian coordinates?
            </p>
          </li> -->

          <li>
            <p>
              What is the volume element in cylindrical coordinates? How does this inform us about evaluating a triple integral as an iterated integral in cylindrical coordinates?
            </p>
          </li>

         <!--  <li>
            <p>
              What are the spherical coordinates of a point, and how are they related to Cartesian coordinates?
            </p>
          </li> -->

          <li>
            <p>
              What is the volume element in spherical coordinates? How does this inform us about evaluating a triple integral as an iterated integral in spherical coordinates?
            </p>
          </li>
        </ul>
    </objectives>

    <introduction>
    <p>
      In <xref ref="S-11-5-Double-Integrals-Polar"/>, we saw how advantageous it could be to use polar coordinates to write iterated integrals when trying to evaluate a double integral. In particular, we saw that double integrals with integrands and regions of integration that are simple to write in polar coordinates are the most convenient to convert, as well as how the area element would be equal to <m>dA = r dr \, d\theta</m> when using polar coordinates.
    </p>
    <p>
      In <xref ref="S-Precalc-OtherCoordSystems" />, we introduced both cylindrical and spherical coordinate systems and explore converting points, equations, and regions between these and rectangular coordinate systems in three dimensions. Cylindrical coordinates are most commonly used in situations with rotational symmetry around the <m>z</m>-axis, whereas spherical coordinates are primarily used when there is rotational symmetry around the origin. We encourage you to review these elements, including the <xref ref="Cartesian-cylindrical" text="custom">conversion equations between cylindrical and rectangular coordinates</xref> and <xref ref="Spherical-rect" text="custom">conversion equations between spherical and rectangular coordinates</xref>. The following preview activity will include some descriptions of common surfaces given in either cylindrical or spherical coordinates.
    </p>
    <exploration>
      <introduction>
        <p>
          In this Preview Activity, we will be reviewing the meaning of each of the cylindrical and spherical coordinates by looking at a description of a common surface in either cylindrical or spherical coordinates. For each task, you should draw a plot of the surface described by hand and write a few sentences describing how your plot relates to the cylindrical/spherical coordinates.
        </p>
      </introduction>
      <task>
        <statement>
          <p>
            What familiar surface is described by the points in cylindrical coordinates with <m>r=2</m>, <m>0 \leq \theta \leq 2\pi</m>, and <m>0 \leq z \leq 2</m>?  How does this example suggest that we call these coordinates <em>cylindrical coordinates</em>? How does the surface change if we restrict <m>\theta</m> to <m> 0 \leq \theta \leq \pi</m>? 
          </p>
        </statement>
        <solution>
          <p>
            In polar coordinates, the graph of <m>r=2</m> is a circle centered at the origin with radius 2. Extending this to cylindrical coordinates, we obtain a cylinder centered at the origin of radius 2, with base on the <m>xy</m>-plane and height 2.
          </p>
        </solution>
      </task>
      <task>
        <statement>
          <p>
            What familiar surface is described by the points in cylindrical coordinates with <m>\theta=2</m>, <m>0 \leq r \leq 2</m>, and <m>0 \leq z \leq 2</m>?
          </p>
        </statement>
        <solution>
          <p>
            In polar coordinates, the graph of <m>\theta = 2</m> is a line through the origin making an angle of 2 radians with the positive <m>x</m>-axis. Extending this to cylindrical coordinates,the graph of <m>\theta=2</m> is a plane through the origin perpendicular to the <m>xy</m>-plane making an angle of 2 radians with the <m>xz</m>-plane.
          </p>
        </solution>
      </task>
      <task>
        <statement>
          <p>
            Plot the graph of the cylindrical equation <m>z=r</m>, where <m>0 \leq \theta \leq 2\pi</m> and <m>0 \leq r \leq 2</m>. What familiar surface is this a plot of?
          </p>
        </statement>
        <solution>
          <p>
            For a fixed value of <m>r</m>, the graph of <m>z=r</m> and <m>0 \leq \theta \leq 2\pi</m> is a circle of radius <m>r</m> in the plane <m>z=r</m>. As <m>r</m> increases the radii increase, so we will obtain a cone with base at the origin, opening up with height <m>2</m>.
          </p>
        </solution>
      </task>
      <task>
        <statement>
          <p>
             What familiar surface is described by the points in spherical coordinates with <m>\rho = 1</m>, <m>0 \leq \theta \leq 2\pi</m>, and <m>0 \leq \phi \leq \pi</m>? How does this particular example demonstrate the reason for the name of this coordinate system? What if we restrict <m>\phi</m> to <m>0 \leq \phi \leq \frac{\pi}{2}</m>?       
          </p>
        </statement>
        <solution>
          <p>
            Since <m>\rho</m> measures the distance from the origin to a point, the graph of <m>\rho = 1</m> is the set of all points that are a distance 1 from the origin. This makes <m>\rho=1</m> the equation of the sphere of radius 1 centered at the origin.
          </p>
        </solution>
      </task>
      <task>
        <statement>
          <p>
            What familiar surface is described by the points in spherical coordinates with <m>\phi = \frac{\pi}{3}</m>, <m>0 \leq \rho \leq 1</m>, and <m>0 \leq \theta \leq 2\pi</m>? 
          </p>
        </statement>
        <solution>
          <p>
            All points with <m>\phi = \frac{\pi}{3}</m> are at a fixed angle from the positive <m>z</m>-axis. The set of such points with <m>0 \leq \rho \leq 1</m> is a cone making an angle of <m>\frac{\pi}{3}</m> with the positive <m>z</m>-axis having a slant height of 1.
          </p>
        </solution>
      </task>
    </exploration>
    <p>
      In this section, we will look at converting triple integrals to use cylindrical and spherical coordinates and similar to our approach in <xref ref="S-11-5-Double-Integrals-Polar"/>, we will focus conceptually on converting
      <ol>
        <li>the volume element <m>dV</m></li>
        <li>the integrand (the function being integrated)</li>
        <li>the region of integration</li>
      </ol>
      to cylindrical and spherical coordinates.
    </p>
  </introduction>
  <subsection>
    <title>Triple Integrals in Cylindrical Coordinates</title>
    <p>
      To evaluate a triple integral <m>\iiint_S f(x,y,z) \, dV</m> as an iterated integral in Cartesian coordinates, we use the fact that the volume element <m>dV</m> is equal to <m>dz \, dy \, dx</m> (which corresponds to the volume of a small box). To evaluate a triple integral in cylindrical coordinates, we similarly must understand the volume element <m>dV</m> in cylindrical coordinates.
    </p>

    <p>
      In particular, we need to look at the volume of a region created by a small step in each of the coordinates (<m>\Delta r</m>, <m>\Delta \theta</m>, <m>\Delta z</m>). You can see a plot of an example region in <xref ref="F_11_8_Cylindrical_Vol_Element"/> and you should recognize the shaded area in the <m>xy</m>-plane as the area element from our work on double integrals in polar coordinates. Recall that <m>\Delta A</m> was <m>\frac{1}{2}(r_{i+1}+r_i) \Delta r \ \Delta \theta</m> and since <m>z</m> is the perpendicular height of our region, we have
      <me>
        \Delta V = \Delta A \ \Delta z = \frac{(r_{i+1}+r_i)}{2} \Delta r \, \Delta \theta \, \Delta z .
      </me>
    </p>
    <figure xml:id="F_11_8_Cylindrical_Vol_Element">
      <caption>A cylindrical box</caption>
      <interactive title="interactive-F_11_8_Cylindrical_Vol_Element" platform="sage" width="100%" aspect="1:1">
        <slate surface="sage">
          <xi:include href="interacts/cylindrical-vol.txt" parse="text" />            
        </slate>
      </interactive>
    </figure>
    <p>
      Remember that as <m>\Delta r</m> shrinks, <m>\frac{(r_{i+1}+r_i)}{2}</m> approaches the <m>r</m>-coordinate of this block. Therefore the volume element <m>dV</m> in cylindrical coordinates is given by <m>dV = r \, dz \, dr \, d\theta</m>.
    </p>
    <p>  
      We can also convert our integrand to polar coordinates by using <m>x=r\cos(\theta)</m> and <m>y=r\sin(\theta)</m>. Slicing our region into a <xref ref="radiallysimple" text="custom">radially simple</xref> or <xref ref="angsimple" text="custom">angularly simple</xref> description will provide the bounds of our iterated integrals used to evaluate the triple integral. Remember that cylindrical coordinates are really polar coordinates plus <m>z</m>.
    </p>

    <assemblage xml:id="Triple-integral-cylindrical">
      <title>Triple integrals in cylindrical coordinates</title>
      <p>
        Given a continuous function <m>f = f(x,y,z)</m> over a region <m>S</m> in <m>\R^3</m>,
        <me>
          \iiint_S f(x,y,z) \, dV = \iiint_S f(r\cos(\theta), r\sin(\theta), z) \, r \, dz \, dr \, d\theta.
        </me>
      </p>
      <p>
        The latter expression is an <em>iterated integral in cylindrical coordinates</em>.<idx><h>iterated integral</h><h>cylindrical coordinates</h></idx>
      </p>
    </assemblage>



    <p>
      While the volume element and the conversion of the integrand will work the same for every case, the task of writing an iterated integral in cylindrical coordinates will require us to slice the particular region in terms of simple bounds on <m>\theta</m>, <m>r</m>, and <m>z</m>. In the following activity, we explore how to do this in several situations where cylindrical coordinates are natural and advantageous.
    </p>

    <activity xml:id="A_11_8_3">
      <introduction>
        <p>
          In this activity, we will work with a few triple integrals and look at the advantages of utilizing cylindrical coordinates for the iterated integral calculation.
        </p>
      </introduction>
      <task>
        <statement>
          <p>
            Let <m>S</m> be the solid bounded above by the graph of <m>z = x^2+y^2</m> and below by <m>z=0</m> on the unit disk in the <m>xy</m>-plane.
          </p>
          <task marker="i.">
            <statement>
              <p>
                The projection of the solid <m>S</m> onto the <m>xy</m>-plane is a disk. Describe this disk using inequalities in polar coordinates.
              </p>
            </statement>
          </task>
          <task>
            <statement>
              <p>
                Use your inequalities from above to write inequalities in cylindrical coordinates that describe the solid <m>S</m>.
              </p>
            </statement>
          </task>
          <task>
            <statement>
              <p>
                Write out a set of iterated integrals that will evaluate to the volume of <m>S</m>. You do not need to evaluate this integral. 
              </p>
            </statement>
          </task>
        </statement>
        <solution>
          <p>
            Since <m>x^2+y^2=r^2</m> in cylindrical coordinates, our limits on <m>z</m> will be <m>0 \leq z \leq r^2</m>. Thus, an iterated integral in cylindrical coordinates that gives the volume of <m>S</m> is
            <me>
              \int \int \int_S 1 \, dV = \int_{0}^{2\pi} \int_0^1 \int_0^{r^2} (1) r \, dz \, dr \, d\theta
            </me>
            Now
            <md>
              <mrow>\int_{0}^{2\pi} \int_0^1 \int_0^{r^2} r \, dz \, dr \, d\theta \amp = \int_{0}^{2\pi} \int_0^1 \left. rz \restrict0^{r^2} \, dr \, d\theta</mrow>
              <mrow>\amp = \int_{0}^{2\pi} \int_0^1 r^3 \, dr \, d\theta</mrow>
              <mrow>\amp = \int_{0}^{2\pi} \left. \frac{r^4}{4} \restrict0^1 \, d\theta</mrow>
              <mrow>\amp = \frac{1}{4} \int_{0}^{2\pi} \, d\theta</mrow>
              <mrow>\amp = \frac{\pi}{2}</mrow>
            </md>
          </p>
        </solution>
      </task>
      <task>
        <statement>
          <p>
            Suppose the density of the cone defined by <m>r = 1 - z</m>, with <m>z \geq 0</m>, is given by <m>\delta(r, \theta, z) = z</m>. A picture of the cone is shown at in <xref ref="F_11_8_Cylindrical_ex">Figure</xref>. Set up an iterated integral in cylindrical coordinates that gives the mass of the cone. You do not need to evaluate this integral.
          </p>
          <!-- <figure xml:id="F_11_8_Cylindrical_ex">
            <caption>The cylindrical cone <m>r = 1-z</m> and its projection onto the <m>xy</m>-plane.</caption>
            <sidebyside widths="50% 50%">
              <image source="images/fig_11_8_cone"/>
              <image source="images/fig_11_8_cone_project"/>
              </sidebyside>
          </figure> -->
          <figure xml:id="F_11_8_Cylindrical_ex">
            <caption>The cylindrical cone <m>r = 1-z</m></caption>
            <interactive title="interactive-F_11_8_Cylindrical_ex" platform="sage" width="100%" aspect="1:1">
              <slate surface="sage">
                var('r,s,t,x,y,z')
                xscale=1.5;yscale=1.5;zscale=1.5;
                plot2=arrow((0,0,0),(xscale,0,0),color="black",opacity=0.5,width=1)+text3d("x",(xscale+0.15,0,0),fontsize=30)+text3d("y",(0,yscale+0.15,0),fontsize=30)+text3d("z",(0,0,zscale+0.15),fontsize=30)
                plot2+=arrow((0,0,0),(0,yscale,0),color="black",opacity=0.5,width=1)+arrow((0,0,0),(0,0,zscale),color="black",opacity=0.5,width=1)
                plot2+=parametric_plot3d((r*cos(t),r*sin(t),1-r),(r,0,1),(t,0,2*pi),color="lightblue")
                plot2+=parametric_plot3d((r*cos(t),r*sin(t),0),(r,0,1),(t,0,2*pi),color="lightblue")
                plot2              
              </slate>
            </interactive>
          </figure>
        </statement>
        <solution>
          <p>
            Recall that mass is the integral of density, so the mass of the cone is
            <me>
              \int \int \int_S \delta(r, \theta, z) \, dV
            </me>.
            The cone is bounded below by the <m>xy</m>-plane and above by the surface <m>r=1-z</m>. If we integrate with respect to <m>z</m> first, then the limits on <m>z</m> are <m>0 \leq z \leq 1-r</m>. When can project the surface into the <m>xy</m>-plane as shown in <xref ref="F_11_8_Cylindrical_ex">Figure</xref> to find the limits on <m>r</m> and <m>\theta</m>. Note than when <m>z=0</m> we have <m>r=1</m>, so the projection is a circle with radius centered at the origin. Therefore, the mass of the cone given as an iterated integral is
            <me>
              \int \int \int_S \delta(r, \theta, z) \, dV = \int_0^{2\pi} \int_0^1 \int_0^{1-r} zr \, dz \, dr \, d\theta
            </me>.
          </p>
        </solution>
      </task>
      <task>
        <statement>
          <p>
            Write an iterated integral expression in cylindrical coordinates whose value is the volume of the solid bounded below by the cone <m>z = \sqrt{x^2+y^2}</m> and above by the cone <m>z = 4 - \sqrt{x^2+y^2}</m>. A picture is shown in <xref ref="F_11_8_Cylindrical_ex2">Figure</xref>. You do not need to evaluate this integral.
          </p>
          <figure xml:id="F_11_8_Cylindrical_ex2">
            <caption> </caption>
            <interactive title="interactive-F_11_8_Cylindrical_ex2" platform="sage" width="100%" aspect="1:1">
              <slate surface="sage">
                var('r,s,t,x,y,z')
                xscale=2.5;yscale=2.5;zscale=4.5
                plot3=arrow((0,0,0),(xscale,0,0),color="black",opacity=0.5,width=1)+text3d("x",(xscale+0.15,0,0),fontsize=30)+text3d("y",(0,yscale+0.15,0),fontsize=30)+text3d("z",(0,0,zscale+0.15),fontsize=30)
                plot3+=arrow((0,0,0),(0,yscale,0),color="black",opacity=0.5,width=1)+arrow((0,0,0),(0,0,zscale),color="black",opacity=0.5,width=1)
                plot3+=parametric_plot3d((r*cos(t),r*sin(t),4-r),(r,0,2),(t,0,2*pi),color="lightblue")
                plot3+=parametric_plot3d((r*cos(t),r*sin(t),r),(r,0,2),(t,0,2*pi),color="lightblue")
                plot3              
              </slate>
            </interactive>
          </figure>
          <!-- <figure xml:id="F_11_8_Cylindrical_ex2">
            <caption>A solid bounded by the cones <m>z = \sqrt{x^2+y^2}</m>  and <m>z = 4 - \sqrt{x^2+y^2}</m></caption>
            <image width="50%" source="images/fig_11_8_two_cones"/>
          </figure> -->
        </statement>
        <solution>
          <p>
            In cylindrical coordinates the cones are <m>z=r</m> and <m>z=4-r</m>. So we have <m>r \leq z \leq 4-r</m>. Now <m>z=r</m> and <m>z=4-r</m> intersect when <m>r = 4-r</m> or when <m>r=2</m>. So the projection of this solid in the <m>xy</m>-plane is the disk <m>0 \leq r \leq 2</m> and <m>0 \leq \theta \leq 2\pi</m>. So an iterated integral in cylindrical coordinates that gives the volume of this solid is
            <me>
              \int_0^{2\pi} \int_0^2 \int_{r}^{4-r} r \, dz \, dr \, d\theta
            </me>
          </p>
        </solution>
      </task>
    </activity>
  </subsection>

  <subsection>
    <title>Triple Integrals in Spherical Coordinates</title>
    <p>
      Similar to our work with cylindrical and Cartesian coordinates, when it comes to thinking about particular surfaces in spherical coordinates, we usually write <m>\rho</m> as a function of <m>\theta</m> and <m>\phi</m>; this is a natural analog to polar coordinates, where we often think of our distance from the origin in the plane as being a function of <m>\theta</m>. In spherical coordinates, we likewise often view <m>\rho</m> as a function of <m>\theta</m> and <m>\phi</m>, thus viewing distance from the origin as a function of two key angles.
    </p>
    <p>
      As with rectangular and cylindrical coordinates, a triple integral <m>\iiint_S f(x,y,z) \, dV</m> in spherical coordinates can be evaluated as an iterated integral once we understand the volume element <m>dV</m>. In <xref ref="F_11_8_Spherical_Vol_Element"/>, we see a volume given by a change in each of the <m>\rho, \theta, \phi</m> coordinates. A conceptual description for where the volume element comes from is given in the proof to <xref ref="Triple-integral-spherical"/>.
    </p>
    <figure xml:id="F_11_8_Spherical_Vol_Element">
      <caption> </caption>
      <interactive title="interactive-F_11_8_Spherical_Vol_Element" platform="sage" width="100%" aspect="1:1">
        <slate surface="sage">
          <xi:include href="interacts/spherical-vol.txt" parse="text" />
        </slate>
      </interactive>
    </figure>
    <proposition xml:id="Triple-integral-spherical">
      <title>Triple integrals in spherical coordinates</title>
      <statement>
        <p>
          Given a continuous function <m>f = f(x,y,z)</m> over a region <m>S</m> in <m>\R^3</m>, the triple integral <m>\iiint_S f(x,y,z) \, dV</m> is converted to the integral 
          <me>
            \iiint_S f(\rho\sin(\phi)\cos(\theta), \rho \sin(\phi) \sin(\theta), \rho \cos(\phi)) \, \rho^2 \sin(\phi) \, d\rho \, d\theta \, d\phi 
          </me>
          in spherical coordinates. 
        </p>
        <p>
          The latter expression is an <em>iterated integral in spherical coordinates</em><idx><h>iterated integral</h><h>spherical coordinates</h></idx>. Note that the volume element for spherical coordinates is <m>dV= \rho^2 \sin(\phi) \, d\rho \, d\theta \, d\phi</m>
        </p>
      </statement>
      <proof>
        <p>
          The conversion of the function being integrated is straightforward because <m>x= \rho\sin(\phi)\cos(\theta), y=\rho \sin(\phi) \sin(\theta), z=\rho \cos(\phi) </m> does not require interpretation based on the coordinates used.
        </p>
        <p>
          To find the volume element <m>dV</m> in spherical coordinates, we need to understand how to determine the volume of a spherical box of the form <m>\rho_1 \leq \rho \leq \rho_2</m> (with <m>\Delta \rho = \rho_2-\rho_1)</m>, <m>\phi_1 \leq \phi \leq \phi_2</m> (with <m>\Delta \phi = \phi_2-\phi_1</m>), and <m>\theta_1 \leq \theta \leq \theta_2</m> (with <m>\Delta \theta = \theta_2-\theta_1</m>). An illustration of such a box is given in <xref ref="F_11_8_Spherical_Vol_Element">Figure</xref>. This spherical box is a bit more complicated than the cylindrical box we encountered earlier. In this situation, it is easier to approximate the volume <m>\Delta V</m> than to compute it directly. Here we can approximate the volume <m>\Delta V</m> of this spherical box with the volume of a Cartesian box whose sides have the lengths of the sides of this spherical box. We have highlighted the three sides we will use in red, blue, and green.
        </p>
        <p>
          Along the red side, both <m>\theta</m> and <m>\phi</m> are constant and <m>\rho</m> is changing. In fact, the length of the red side is simply the change in <m>\rho</m>.
        </p>
        <p>
          Along the green side, both <m>\theta</m> and <m>\rho</m> are constant and <m>\phi</m> is changing. We can simplify our plot by looking along the plane <m>\theta=\theta_0</m> which will give us the following plot
        </p>
        <figure xml:id="t0face">
          <caption>A plot of the face of our volume element with <m>\theta=\theta_0</m></caption>
          <image width="60%" xml:id="img-t0face">
            <sageplot>
              var('x,y,t,s')
              r1=1;r2=1.5;t1=0.6;t2=1;
              plot5=line([(r1*cos(t2),r1*sin(t2)),(0,0),(r1*cos(t1),r1*sin(t1))],color="gray",thickness=2,axes=True,ticks=[[],[]])
              dt=(t2-t1)/25
              p1=[(r1*cos(t2-i*dt),r1*sin(t2-i*dt)) for i in range(26)]
              p2=[(r2*cos(t1+i*dt),r2*sin(t1+i*dt)) for i in range(26)]
              pp=p1+p2
              plot5+=polygon(pp,color="gray",edgecolor="black",thickness=3,zorder=2)
              plot5+=parametric_plot((0.4*cos(t),0.4*sin(t)),(t,t1,t2),color="black",thickness=2)+text("$\\Delta \\phi$",(0.35,0.35),color="black",fontsize=20)
              plot5+=parametric_plot((r1*cos(t),r1*sin(t)),(t,t1-0.5,t2+0.5),color="gray",thickness=3,linestyle="--",zorder=1)
              plot5+=parametric_plot((r2*cos(t),r2*sin(t)),(t,t1-0.5,t2+0.5),color="gray",thickness=3,linestyle="--",zorder=1)
              plot5+=text("$\\rho_0$",(r1*cos(t1),r1*sin(t1)-0.1),fontsize=20,color="gray")
              plot5+=text("$\\rho_1$",(r2*cos(t1),r2*sin(t1)-0.1),fontsize=20,color="gray")
              plot5+=text("$\\Delta \\rho$",((r1+r2)/2*cos(t2)-0.1,(r1+r2)/2*sin(t2)+0.05),fontsize=20,color="black")
              plot5+=text("$s_1$",(r2*cos((t1+t2)/2)+0.05,r2*sin((t1+t2)/2)+0.05),fontsize=20,color="black")
              plot5+=parametric_plot((r2*cos(t),r2*sin(t)),(t,t1,t2),color="green",thickness=3)
              plot5                  
            </sageplot>
          </image>
        </figure>
        <p>
          Hopefully you recognize this as the same kind of picture as we used when looking at the area element in polar coordinates. The length of the green curve will be <m>\rho_1 \Delta\phi</m> by the same kind of argument.
          <me> (\text{fraction of circle})(\text{circumference of circle})=\left(\frac{\Delta\phi}{2\pi}\right)\left(2\pi \rho_1 \right)= \rho_1 \Delta\phi</me>
        </p>
        <p>
          The blue curve occurs at a constant value of <m>\rho</m> and <m>\phi</m>, with <m>\theta</m> changing. In other words, the blue curve consists of <m>x=\rho_1 \sin(\phi_0) \cos(\theta), y= \rho_1 \sin(\phi_0), z=\rho_1 \cos(\phi_0)</m> which corresponds to a circle of radius <m>\rho_1 \sin(\phi_0)</m> at a height <m>z=\rho_1 \cos(\phi_0)</m>. We can use the same type of argument as above that the arc length of a curve corresponding to an angular change of <m>\Delta \theta</m> along a circle of radius <m>\rho_1 \sin(\phi_0)</m> will be <m>\rho_1 \sin(\phi_0) \Delta \theta</m>. 
        </p>
        <p>
          Remember that as we look at smaller and smaller changes in the coordinates, the difference between the values of the coordinates used will also shrink and <m>\rho=0 \approx \rho_1 \approx \rho</m>, for example. So we can get an idea of how large this volume will be by multiplying the lengths of the red, blue, and green segments to get
          <me>\Delta V \approx \left(\Delta\rho\right) \left(\rho \,  \Delta\phi \right)\left(\rho \sin(\phi) \, \Delta\theta \right) = \rho^2 \sin(\phi) \Delta\phi \, \Delta\theta \, \Delta\rho</me>
        </p>
      </proof>
    </proposition>

    <p>
      Finally, in order to actually evaluate an iterated integral in spherical coordinates, we must of course determine the limits of integration in <m>\phi</m>, <m>\theta</m>, and <m>\rho</m>. The process is similar to our earlier work in other coordinate systems and we will look a few simple cases in the next activities; The central idea in our process is to fix all but one coordinate and give the same bounding functions for the remaining coordinate, then project onto the remaining coordinates and repeat this process.
    </p>

    <activity xml:id="A_11_8_10">
      <introduction>
        <p>
          In this activity, we will use spherical coordinates to help us more easily understand some natural geometric objects.
        </p>
      </introduction>
      <task>
        <statement>
          <p>
            Recall that the sphere of radius <m>a</m> has spherical equation <m>\rho = a</m>.  Set up and evaluate an iterated integral in spherical coordinates to determine the volume of a sphere of radius <m>a</m>.
          </p>
        </statement>
        <solution>
          <p>
            Recall that the volume of a solid <m>S</m> is given by
            <me>
              \int \int \int_S \, dV
            </me>.
            Thus, the volume of a sphere of radius <m>a</m> can be calculated as an iterated integral as follows:
            <md>
              <mrow>\int \int \int_S \, dV \amp = \int_0^{2\pi} \int_0^{\pi} \int_0^{a} \rho^2 \sin(\phi) \, d\rho \, d\phi \, d\theta</mrow>
              <mrow>\amp = \int_0^{2\pi} \int_0^{\pi} \left. \left[\frac{\rho^3}{3} \sin(\phi) \right]\restrict0^a  \, d\phi \, d\theta</mrow>
              <mrow>\amp = \int_0^{2\pi} \int_0^{\pi} \frac{a^3}{3} \sin(\phi) \, d\phi \, d\theta</mrow>
              <mrow>\amp = \int_0^{2\pi} \left. \left[-\frac{a^3}{3} \cos(\phi)\right]\restrict0^{\pi} \, d\theta</mrow>
              <mrow>\amp = \int_0^{2\pi} 2\frac{a^3}{3} \, d\theta</mrow>
              <mrow>\amp = \frac{4}{3}\pi a^3</mrow>
            </md>
          </p>
        </solution>
      </task>
      <task>
        <statement>
          <p>
             Set up, but do not evaluate, an iterated integral expression in spherical coordinates whose value is the mass of the solid obtained by removing the cone <m>\phi=\frac{\pi}{4}</m> from the sphere <m>\rho = 2</m> if the density <m>\delta</m> at the point <m>(x,y,z)</m> is <m>\delta(x,y,z) = \sqrt{x^2+y^2+z^2}</m>.  An illustration of the solid is shown in <xref ref="F_11_8_Spherical_ex2">Figure</xref>.
          </p>
          <figure xml:id="F_11_8_Spherical_ex2">
            <caption>The solid cut from the sphere <m>\rho = 2</m> by the cone <m>\phi=\frac{\pi}{4}</m></caption>
            <interactive title="interactive-F_11_8_Spherical_ex2" platform="sage" width="100%" aspect="1:1">
              <slate surface="sage">
                <xi:include href="interacts/sph-cone.txt" parse="text" />
              </slate>
            </interactive>
          </figure>
          <!-- <figure xml:id="F_11_8_Spherical_ex2">
            <caption>The solid cut from the sphere <m>\rho = 2</m> by the cone <m>\phi=\frac{\pi}{4}</m>.</caption>
            <image width="50%" source="images/fig_11_8_sphere_cone"/>
          </figure> -->
        </statement>
        <solution>
          <p>
            The limits on <m>\rho</m> are <m>0 \leq \rho \leq 2</m> and on <m>\theta</m> are <m>0 \leq \theta \leq 2\pi</m>. To account for the cone being removed from the sphere we restrict <m>\phi</m>. The cone opens from <m>\phi = 0</m> to <m>\phi = \frac{\pi}{4}</m>, so the limits on <m>\phi</m> that remove the cone are <m>\frac{\pi}{4} \leq \phi \leq \pi</m>. Therefore, the density of the solid is found by
            <me>
            \int_{0}^{2\pi} \int_{\pi/4}^{\pi} \int_0^2 \rho^3 \sin(\phi) \, d\rho \, d\phi \, d\theta
            </me>.
          </p>
        </solution>
      </task>
    </activity>
  </subsection>

 

  <subsection>
    <title>Summary</title>
    <p>
    <ul>
      <li>
        <p>
          The volume element <m>dV</m> in cylindrical coordinates is <m>dV = r \, dz \, dr \, d\theta</m>. Hence, a triple integral <m>\iiint_S f(x,y,z) \, dA</m> can be evaluated as the iterated integral of the form
          <me>
            \iiint_S f(r\cos(\theta), r\sin(\theta), z) \, r \, dz \, dr \, d\theta.
          </me>
        </p>
      </li>

      <li>
        <p>
          The volume element <m>dV</m> in spherical coordinates is <m>dV = \rho^2 \sin(\phi) \, d\rho \, d\theta \, d\phi</m>. Thus, a triple integral <m>\iiint_S f(x,y,z) \, dA</m> can be evaluated as the iterated integral of the form
          <me>
            \iiint_S f(\rho\sin(\phi)\cos(\theta), \rho \sin(\phi) \sin(\theta), \rho \cos(\phi)) \, \rho^2 \sin(\phi) \, d\rho \, d\theta \, d\phi.
          </me>
        </p>
      </li>
    </ul>
  </p>
  </subsection>
  <xi:include href="exercises/ez-S_multi_ints_triple_ints_cylsph.ptx" />
    
</section>
