<!-- **********************************************************************-->
<!-- Copyright 2013-2025                                                   -->
<!-- Nicholas Long, Mitchel Keller, Steven Schlicker                       -->
<!--                                                                       -->
<!-- This file is part of Active Calculus Multivariable.                   -->
<!--                                                                       -->
<!-- Permission is granted to copy, distribute and/or modify this document -->
<!-- under the terms of the Creative Commons BY-NC-SA license.  The work   -->
<!-- may be used for free by any party so long as attribution is given to  -->
<!-- the author(s), the work and its derivatives are used in the spirit of -->
<!-- "share and share alike"; no party may sell this work or any of its    -->
<!-- derivatives for profit.  All trademarks are the registered marks of   -->
<!-- their respective owners.                                              -->
<!-- **********************************************************************-->
<section xmlns:xi="http://www.w3.org/2001/XInclude" xml:id="S-mv_deriv-linearization">
  <title>Linearization: Tangent Planes and Differentials</title>
  <objectives>
    <ul>
      <li>
        <p>
          What does it mean for a function of two variables to be locally linear at a point?
        </p>
      </li>
      <li>
        <p>
          How do we find the equation of the plane tangent to a locally linear function at a point?
        </p>
      </li>
      <li>
        <p>
          What is the differential of a multivariable function of two variables and what are its uses?
        </p>
      </li>
    </ul>
  </objectives>
  <introduction component="instructor">
    <title>Notes to the Instructor and Dependencies</title>
    <p>
      This section relies on the ideas of planes from <xref ref="S-Precalc-Lines"/> and first partial derivatives as measuring the tilt of a surface plot at a particular location from <xref ref="S-mv_deriv-first_order"/>. Some instructors will only cover a subset of the linearization tools covered here (tangent plane, total differential, linearization for approximation, differentiabilty, locally linear) but these tools are introduced and defined in such a way that each conceptually flows from the idea of locally linear functions. To cover all the topics in this section will likely take a couple of class meetings. 
    </p>
  </introduction>
  <subsection>
    <title>Introduction</title>
    <p>
      Throughout the study of in single-variable calculus, the tangent line serves as a geometric and conceptual tool to understand the derivative at a point. While the value of a derivative at a point measures the instantaneous rate of change, we visualize the value of the derivative of a function as the slope of the line tangent to its graph. This allowed use to <q>see</q> the value of the derivative in terms of an important behavior of the function's graph.
    </p>
    <!-- <p>
      Additionally, we saw the correspondence between a function's graph being <em>locally linear</em><idx><h>locally linear</h></idx> and the function being differentiable. If we zoom in on the graph of a differentiable function around a point, then the graph will look like the tangent line to the function at that point. <xref ref="LLline2" /> shows the graph of a curve with sliders that allow you to to zoom in around the labeled point on the curve or change the location for the labeled point on the curve. The displayed function's graph is differentiable because at every point on the curve, you can zoom-in around the labeled point and the graph of the function will look linear (for a small region around the point). You should visually verify at several points that this function is differentiable at the labeled point by verifying the graph is locally linear.
    </p>
    <figure xml:id="LLline2">
      <caption>A plot with the ability to zoom in on a point of <m>y=f(x)</m>, where <m>f</m> is a nonlinear, differentiable function</caption>
      <interactive title="interactive-LLline" platform="sage" width="100%" aspect="1:1">
        <slate surface="sage">
          @interact
          def LLline(zoom=slider(0,8,1,default=0,label="Zoom"),val=slider(0,2,0.05,default=1.00,label="Location")):
              var('x')
              f(x)=x*cos(pi*x)
              fv=f(val)
              if(zoom==0):
                  xtop=4;xbottom=-4;
              else:
                  xbottom=val-2^(-zoom+1);xtop=val+2^(-zoom+1);
              plot1=plot(f(x),(x,xbottom,xtop),color="black",gridlines=True,thickness=2)
              plot1+=point((val,fv),color="black",size=40)
              show(plot1)
        </slate>
      </interactive>
    </figure>
    <p>
      When viewing our differentiable function on a very small scale, the graph will be very close to the graph of the tangent line. Thus we can use the derivative as the slope of our tangent line in order to measure how tilted our graph is on a small scale. Because the graph of the function and the tangent line are so similar for a small region around the given point, the tangent line will allow us to approximate the output value of the function or the change in the output value for inputs near the given point. Tangent lines were used in many different applications and extensions of derivatives; For example, horizontal tangent lines gave critical points for optimization problems and tangent lines were used to approximate zeros or roots of functions when developing the Newton-Raphson Method. 
    </p>  -->
    <p>
      In <xref ref="tangentlines"/>, we saw that a curve in space, as the graph of a vector-valued function of one variable, is locally linear and approximated well by a tangent line provided that the function is differentiable. So a curve in space/vector-valued function will be differentiable if the graph looks like a line on a small scale.
    </p>  
    <p>
      In this section, we will explore the various ways in which we can extend the ideas described above to a function of two variables. Geometrically, this means we will use a tangent plane as a <q>flat</q> analog for surfaces of the form <m>z=f(x,y)</m>.<fn>For graphs in the cartesian plane, there was only one type of flat graph: a line. When we generalized to higher dimensions, we saw how both lines and planes can be considered <q>flat</q> graphs in three dimensions. However, we noted that lines are 1-dimensional flat graphs because there is only direction to move along the graph. On the other hand, planes are 2-dimensional flat graphs.
      </fn>
      We will also introduce a couple of new tools to help us describe change in the output of <m>f(x,y)</m> algebraically and numerically.
    </p>
    <!-- <p>
      In single variable calculus, we learned that a differentiable function is <em>locally linear</em>. <idx><h>locally linear</h></idx> In other words, if we zoom in on the graph of a differentiable function around a point, the graph will look like the tangent line to the function at that point. In <xref ref="LLline2" /> you can look at the graph of a curve and zoom in around a point on that curve to see that eventually the graph of the function will look linear. You can use the sliders above the plot to change how closely zoomed in the plot will be or change the location on the curve that you are examining. You should visually verify at a several points that this function is differentiable because at any point shown, the graph is locally linear.
    </p>
    <figure xml:id="LLline2">
      <caption>A plot with the ability to zoom in on a point of <m>y=f(x)</m>, where <m>f</m> is a nonlinear, differentiable function</caption>
      <interactive title="interactive-LLline" platform="sage" width="100%" aspect="1:1">
        <slate surface="sage">
          @interact
          def LLline(zoom=slider(0,8,1,default=0,label="Zoom"),val=slider(0,2,0.05,default=1.00,label="Location")):
            var('x')
            f(x)=x*cos(pi*x)
            fv=f(val)
            plot1=plot(f(x),(x,-4,4),color="black",gridlines=True,thickness=2)
            plot1+=point((val,fv),color="black",size=40,xmin=val-2^(-zoom+1),xmax=val+2^(-zoom+1),ymin=fv-2^(-zoom+1),ymax=fv+2^(-zoom+1))
            show(plot1)
        </slate>
      </interactive>
    </figure>
    <p>
      When viewing our differentiable function on a very small scale, the graph will be very close to the graph of the tangent line. Remember that we can use the derivative of our function to find the slope of our tangent line as a measure of how tilted the graph is on a small scale. 
    </p> -->
    <p>
      To start our investigation, let's consider the graph of a <q>nice</q> two-variable function on a small scale. We will look at
      <me>
        f(x,y) = 6 - \frac{x^2}{2} - y^2,
      </me>
      whose graph is shown in <xref ref="fig-mv_deriv-linearization-tangent_4">Figure</xref>.
    </p>
    <!-- <figure xml:id="F_10_4_tangent_1">
      <caption>A plot of <m>f(x,y)=6-\frac{x^2}{2}-y^2</m> with the point <m>(1,1,\frac{9}{2})</m> highlighted</caption>
      <interactive label="interactive-F_10_4_tangent_1" platform="sage" width="100%" aspect="1:1">
        <slate surface="sage">
          var('x,y,t,s')
          plot2=plot3d(6-x^2/2-y^2,(x,-2,2),(y,-2,2),color="blue",plot_points=21,opacity=0.4,mesh=True)
          plot2+=parametric_plot3d((s,t,0),(s,-2,2),(t,-2,2),color="gray",opacity=0.2,plot_points=3,mesh=True)
          plot2+=point((1,1,4.5),color="black",size=30)
          plot2+=point((1,1,0),color="gray",size=30)
          plot2+=line([(1,1,4.5),(1,1,0)],color="gray",thickness=2)
          show(plot2,viewpoint=[[-0.3161,-0.525,-0.7902],129.11],camera_position=[7.2388,3.9416,3.9252],aspect_ratio=(1,1,0.5))
        </slate>
      </interactive>
    </figure> -->
    <!-- <figure xml:id="F_10_4_tangent_1">
      <caption>The graph of <m>f(x,y)=6-x^2/2 - y^2</m>.</caption>
      <image width="50%" source="images/fig_10_4_tangent_1"/>
    </figure> -->
    <p>
      Examine the behavior of <m>f</m> near the input <m>(x_0,y_0) = (1,1)</m>, which has output of <m>f(1,1)=4.5</m>. Adjust the Zoom slider in <xref ref="fig-mv_deriv-linearization-tangent_4">Figure</xref> to view the graph of <m>z=f(x,y)</m> on smaller and smaller scales around the point <m>(1,1,4.5)</m>. With zoom set to 0, the plot clearly reveals that the surface is curved. However, once you increase the zoom level to 3 or higher, the surface looks more like a tilted plane than a curved surface. 
      <!-- On plots like <xref ref="fig-mv_deriv-linearization-tangent_4">Figure</xref>, you should pay attention to the scale on the edge of the plot to see how small of a scale you are viewing around your point.  -->
    </p>
    <figure xml:id="fig-mv_deriv-linearization-tangent_4">
      <caption>A plot of <m>f(x,y)=6-\frac{x^2}{2}-y^2</m> with the point <m>(1,1,\frac{9}{2})</m> highlighted and the option to zoom in around the highlighted point.</caption>
      <interactive label="interactive-fig-mv_deriv-linearization-tangent_4" platform="sage" width="100%" aspect="1:1.15">
        <description><p>A plot of <m>f(x,y)=6-\frac{x^2}{2}-y^2</m> with the point <m>(1,1,\frac{9}{2})</m> highlighted and the option to zoom in around the highlighted point.</p>
      </description><slate surface="sage">
          var('x,y,s,t')
          @interact
          def LLsurface2(a=slider(0,8,1,default=0,label="Zoom"),sp=checkbox(False,label="Show Tangent Plane:")):
              z=4*2^(-a)
              g(x,y)=6-x^2/2-y^2
              #plot4=plot3d(6-x^2/2-y^2,(x,1-z,1+z),(y,1-z,1+z),color="lightblue",plot_points=21,opacity=0.4,mesh=True)
              param(s,t)=(s,t,g(s,t));s1=1-z;s2=z+1;t1=1-z;t2=1+z;
              #set up grid      n is number of steps in s    m is number of steps in t  
              #a1 is min s    a2 is max s   b1 is min t    b2 is max t
              n=4;m=4;a1=s1;a2=s2;b1=t1;b2=t2; 
              #c1 is surface color     o1 is surface opacity
              #c2 and o2 are for constant t value traces
              #c3 and o3 are for constant s value traces
              c1="lightblue"; c2="gray"; c3="gray"; o1=0.5; o2=0.8; o3=0.8;
              plot4=parametric_plot3d(param,(s,s1,s2),(t,t1,t2),color=c1,opacity=o1)
              for i in range(n+1):
                sv=a1+i/n*(a2-a1)
                plot4+=parametric_plot3d(param(sv,t),(t,b1,b2),color=c2,opacity=o2)
              for i in range(m+1):
                tv=b1+i/m*(b2-b1)
                plot4+=parametric_plot3d(param(s,tv),(s,a1,a2),color=c3,opacity=o3)
              plot4+=point3d((1,1,4.5),color="black",size=30*z)
              if(sp):
                plot4+=parametric_plot3d((1-s,1-t,4.5+s+2*t),(s,-z,z),(t,-z,z),color="pink",opacity=0.5,plot_points=5,mesh=True)
              show(plot4,viewpoint=[[-0.2344,-0.6058,-0.7603],147.21],camera_position=[8.2585,8.9748,2.9946],aspect_ratio=(1,1,0.35),frame=False)
        </slate>
      </interactive>
    </figure>
    <!-- <figure xml:id="F_10_4_tangent_2">
      <caption>The graph of <m>f(x,y)=6-x^2/2 - y^2</m>.</caption>
      <sidebyside widths="50% 50%">
      <image source="images/fig_10_4_tangent_2"/>
      <image source="images/fig_10_4_tangent_3"/>
      </sidebyside>
    </figure> -->
    <p>
      Just as the graph of a differentiable single-variable function or a differentiable vector-valued function of one variable looks like a line when viewed on a small scale, the graph of this two-variable function looks like a plane when viewed on a small scale. The Preview Activity guies you through finding an equation for this plane, but we first state a key idea that will be helpful algebraic form to use when thinking about tangent planes to surfaces of the form <m>z=f(x,y)</m>.
    </p>
    <!-- <figure xml:id="fig-mv_deriv-linearization-tangent_4">
      <caption>A plot of <m>f(x,y)=6-\frac{x^2}{2}-y^2</m> with tangent plane at the point <m>(1,1,\frac{9}{2})</m> drawn and the option to zoom in around <m>(1,1,\frac{9}{2})</m></caption>
      <interactive label="interactive-fig-mv_deriv-linearization-tangent_4" platform="sage" width="100%" aspect="1:1">
        <slate surface="sage">
          var('x,y,s,t')
          @interact
          def LLsurface(a=slider(0,6,1,default=0,label="Zoom")):
            z=2*2^(-a)
            plot4=plot3d(6-x^2/2-y^2,(x,1-z,1+z),(y,1-z,1+z),color="blue",plot_points=13,opacity=0.4,mesh=True)
            plot4+=point((1,1,4.5),color="black",size=30*z)
            plot4+=parametric_plot3d((1-s,1-t,4.5+s+2*t),(s,-z,z),(t,-z,z),color="red",opacity=0.3,plot_points=5,mesh=True)
            show(plot4,viewpoint=[[-0.5332,-0.5677,-0.6272],119],camera_position=[1.1679,1.0105,2.2664],aspect_ratio=(1,1,0.5))
        </slate>
      </interactive>
    </figure> -->
    <!-- <figure xml:id="fig-mv_deriv-linearization-tangent_4">
      <caption>The graph of <m>f(x,y)=6-x^2/2 - y^2</m>.</caption>
      <image width="50%" source="images/fig_10_4_tangent_4"/>
    </figure> -->
    <proposition xml:id="nvplaneeqn">
      <statement>
        <p>
          A non-vertical plane that goes through the point <m>(x_0,y_0,z_0)</m> can be expressed in the form <m>z = z_0 + a(x-x_0) + b(y-y_0)</m>, where <m>a</m> and <m>b</m> are constants.
        </p>
      </statement>
      <proof>
        <p>
          As we saw in <xref ref="S-Precalc-Planes">Section</xref>, the equation of a plane passing through the point <m>(x_0, y_0, z_0)</m> may be written in the form <m>A(x-x_0) + B(y-y_0) + C(z-z_0) = 0</m>.  If the plane is not vertical, then <m>C\neq 0</m>, and we can rearrange this equation and write <m>C(z-z_0) = -A(x-x_0) - B(y-y_0)</m> and thus
          <md>
            <mrow>z \amp  = z_0-\frac{A}{C}(x-x_0) - \frac{B}{C}(y-y_0)</mrow>
            <mrow>\amp  = z_0 + a(x-x_0) + b(y-y_0)</mrow>
          </md>
          where <m>a=-A/C</m> and <m>b=-B/C</m>, respectively.
        </p>
        <p>
          After our work in the Preview Activity, we will look at how to obtain this equation in terms of the normal vector of this plane that best describes the surface at a particular point.
        </p>
      </proof>
    </proposition>
    <worksheet>
  <exploration workspace="1.5in" xml:id="PA-mv_deriv-linearization">
    <introduction>
      <p>
        We want to find the equation of the plane, using the form given in <xref ref="nvplaneeqn"/>, that best describes the surface given by <m>z=f(x,y)=6-\frac{x^2}2 - y^2</m> for input values around <m>(x_0,y_0) = (1,1)</m>. In particular, we will need to find how the values of <m>z_0</m>, <m>a</m>, and <m>b</m> are related to <m>f(x,y)</m>. 
      </p>
    </introduction>
    <task>
      <statement>
        <p>
          Find <m>f(1,1)</m>, <m>f_x(1,1)</m>, and <m>f_y(1,1)</m>. 
        </p>
      </statement>
      <answer>
        <p>
          <m>f(1,1) = \frac{9}{2}</m>, <m>f_x(1,1) = -1</m>, and <m>f_y(1,1) = -2</m>.
        </p>
      </answer>
      <solution>
        <p>
          Since <m>f_x(x,y) = -x</m> and <m>f_y(x,y) = -2y</m> we have <m>f(1,1) = \frac{9}{2}</m>, <m>f_x(1,1) = -1</m>, and <m>f_y(1,1) = -2</m>.
        </p>
      </solution>
    </task>
    <task>
      <statement>
        <p>
          We want the plane to match the height of the surface at <m>(1,1)</m>. For this to happen, the value <m>z_0</m> from <xref ref="nvplaneeqn"/> must be the <m>z</m>-coordinate value where the plane intersects the surface. What is the <m>z</m>-coordinate of the point where the tangent plane and the surface intersect?
          <!-- We know one point on the tangent plane;  namely, the <m>z</m>-value of the tangent plane agrees with the <m>z</m>-value on the graph of <m>f(x,y) = 6 - \frac{x^2}2 - y^2</m> at the point <m>(x_0, y_0)</m>.  In other words, both the tangent plane and the graph of the function <m>f</m> contain the point <m>(x_0, y_0, z_0)</m>. Use this observation to determine <m>z_0</m> in the expression <m>z = z_0 + a(x-x_0) + b(y-y_0)</m>. -->
        </p>
      </statement>
      <answer>
        <p>
          4.5
        </p>
      </answer>
      <solution>
        <p>
          Since <m>f(1,1) = \frac{9}{2}</m> we must have <m>z_0=\frac{9}{2}</m>.
        </p>
      </solution>
    </task>
    <task>
      <statement>
        <p>
          For the plane to have the same behavior as the surface <m>z=f(x,y)</m> near <m>(1,1)</m>, the plane must match the behavior of the traces <m>x=1</m> and <m>y=1</m> near this point.
        </p>
        <p>
          Sketch the traces of <m>f(x,y) = 6 - \frac{x^2}2 - y^2</m> for <m>y=y_0=1</m> and <m>x=x_0=1</m> below. Draw the tangent lines to the each of the traces when the appropriate input is 1. 
        </p>
        <sidebyside widths="50% 50%">
          <image source="images/fig_10_4_tangent_trace_y"><description><p>ADD ALT TEXT TO THIS IMAGE</p></description></image>
          <image source="images/fig_10_4_tangent_trace_x"><description><p>ADD ALT TEXT TO THIS IMAGE</p></description></image>
        </sidebyside>
      </statement>
      <answer>
        <p>
          The slope of the tangent line to the trace of <m>f</m> with <m>y=1</m> (in the <m>x</m> direction) at <m>x_0=1</m> is <m>f_x(1,1) = -1</m>. So the equation of this tangent line is <m>y = \frac{9}{2} - (x-1)</m>.
        </p>
        <p>
          The slope of the tangent line to the trace of <m>f</m> with <m>x=1</m> (in the <m>y</m> direction) at <m>y_0=1</m> is <m>f_y(1,1) = -2</m>. So the equation of this tangent line is <m>y = \frac{9}{2} - (y-1)</m>.
        </p>
      </answer>
      <solution>
        <p>
          The slope of the tangent line to the trace of <m>f</m> with <m>y=1</m> (in the <m>x</m> direction) at <m>x_0=1</m> is <m>f_x(1,1) = -1</m>. So the equation of this tangent line is <m>y = \frac{9}{2} - (x-1)</m>.
        </p>
        <p>
          The slope of the tangent line to the trace of <m>f</m> with <m>x=1</m> (in the <m>y</m> direction) at <m>y_0=1</m> is <m>f_y(1,1) = -2</m>. So the equation of this tangent line is <m>y = \frac{9}{2} - (y-1)</m>.
        </p>
      </solution>
    </task>
    <task>
      <statement>
        <p>
          What are the slopes of the tangent lines to the traces that you drew in the previous part? Write a couple of sentences to explain why the tilt of the tangent plane in the <m>x</m>-direction is given by the partial derivative <m>f_x</m> and the tilt of the tangent plane in the <m>y</m>-direction is given by the partial derivative <m>f_y</m>. Your answer should discuss how each of these slopes/partial derivatives relates to the traces of the surface and the plane illustrated below.
        </p>
          <interactive label="interactive-F_10_4_tangent_traces" platform="sage" width="91%" aspect="1:1">
            <slate surface="sage">
              var('x,y,z,t,s')
              f(x,y)=6-x^2/2-y^2
              param(s,t)=(s,t,f(s,t))
              param2(s,t)=(s,t,4.5-(s-1)-2*(t-1))
              #set up grid      n is number of steps in s    m is number of steps in t  
              #a1 is min s    a2 is max s   b1 is min t    b2 is max t
              n=5;m=5;a1=1/2;a2=1.5;b1=1/2;b2=1.5; 
              #c1 is surface color     o1 is surface opacity
              #c2 and o2 are for constant t value traces
              #c3 and o3 are for constant s value traces
              c1="blue"; c2="black"; c3="black"; o1=0.3; o2=0.4; o3=0.4;
              plot6=parametric_plot3d(param,(s,a1,a2),(t,b1,b2),color=c1,opacity=o1)
              plot6+=parametric_plot3d(param2,(s,a1,a2),(t,b1,b2),color="red",opacity=o1)
              for i in range(n+1):
                sv=a1+i/n*(a2-a1)
                plot6+=parametric_plot3d(param(sv,t),(t,b1,b2),color=c2,opacity=o2)
                plot6+=parametric_plot3d(param2(sv,t),(t,b1,b2),color=c2,opacity=o2)
              for i in range(m+1):
                tv=b1+i/m*(b2-b1)
                plot6+=parametric_plot3d(param(s,tv),(s,a1,a2),color=c3,opacity=o3)
                plot6+=parametric_plot3d(param2(s,tv),(s,a1,a2),color=c3,opacity=o3)
              plot6+=point((1,1,4.5),color="black",size=10)
              sv=1; plot6+=parametric_plot3d(param(sv,t),(t,b1,b2),color="blue",thickness=3)
              tv=1; plot6+=parametric_plot3d(param(s,tv),(s,a1,a2),color="blue",thickness=3)
              sv=1; plot6+=parametric_plot3d(param2(sv,t),(t,b1,b2),color="red",thickness=3)
              tv=1; plot6+=parametric_plot3d(param2(s,tv),(s,a1,a2),color="red",thickness=3)
              show(plot6,aspect_ratio=(1,1,0.35),viewpoint=[[-0.396,-0.6577,-0.6407],137.81],camera_position=[3.2568,2.1949,1.6581])
            </slate>
          <description><p>ADD ALT TEXT TO THIS IMAGE</p></description></interactive>
      </statement>
      <answer>
        <p>
          The tangent line of the trace on the surface in the <m>x</m> direction at the point <m>(x_0,y_0,z_0)</m> is the same as the tangent line found in the last part of this activity with <m>y</m> constant at <m>1</m>. The slope of this line tells us how <m>z</m> changes as we change only the <m>x</m> coordinate at this point. So that slope, <m>f_x(x_0,y_0)</m>, should be the value of <m>a</m> in the equation <m>z = z_0+a(x-x_0) + b(y-y_0)</m> of the tangent plane. In other words, <m>f_x(x_0,y_0)</m> should be equal to <m>z_x(x_0,y_0)</m>.
        </p> 
        <p>
          The tangent line of the trace on the surface in the <m>y</m> direction at the point <m>(x_0,y_0,z_0)</m> is the same as the tangent line <m>y = \frac{9}{2} - (y-1)</m> just found with <m>x</m> constant at <m>1</m>. The slope of this line tells us how <m>z</m> changes as we change only the <m>y</m> coordinate at this point. So that slope, <m>f_y(x_0,y_0)</m>, should be the value of <m>b</m> in the equation <m>z = z_0+a(x-x_0) + b(y-y_0)</m> of the tangent plane. In other words, <m>f_y(x_0,y_0)</m> should be equal to <m>z_y(x_0,y_0)</m>.
        </p>
      </answer>
      <solution>
        <p>
          The tangent line of the trace on the surface in the <m>x</m> direction at the point <m>(x_0,y_0,z_0)</m> is the same as the tangent line found in the last part of this activity with <m>y</m> constant at <m>1</m>. The slope of this line tells us how <m>z</m> changes as we change only the <m>x</m> coordinate at this point. So that slope, <m>f_x(x_0,y_0)</m>, should be the value of <m>a</m> in the equation <m>z = z_0+a(x-x_0) + b(y-y_0)</m> of the tangent plane. In other words, <m>f_x(x_0,y_0)</m> should be equal to <m>z_x(x_0,y_0)</m>.
        </p> 
        <p>
          The tangent line of the trace on the surface in the <m>y</m> direction at the point <m>(x_0,y_0,z_0)</m> is the same as the tangent line <m>y = \frac{9}{2} - (y-1)</m> just found with <m>x</m> constant at <m>1</m>. The slope of this line tells us how <m>z</m> changes as we change only the <m>y</m> coordinate at this point. So that slope, <m>f_y(x_0,y_0)</m>, should be the value of <m>b</m> in the equation <m>z = z_0+a(x-x_0) + b(y-y_0)</m> of the tangent plane. In other words, <m>f_y(x_0,y_0)</m> should be equal to <m>z_y(x_0,y_0)</m>.
        </p>
      </solution>
    </task>
    <task>
      <statement>
        <p>
          Fill in the blanks below with the proper values to give the tangent plane to the graph of <m>f(x,y)=6-x^2/2 - y^2</m> at the point <m>(x_0,y_0)=(1,1)</m>.
          <me>z=z_0 + a(x-x_0) + b(y-y_0)= <fillin characters="1"/> + <fillin characters="1"/>(x-<fillin characters="1"/>) +<fillin characters="1"/>(y-<fillin characters="1"/>)</me>.
        </p>
      </statement>
      <answer>
        <p>
          The equation of the tangent plane to the graph of
          <m>f(x,y)=6-x^2/2 - y^2</m> at the point <m>(x_0,y_0)=(1,1)</m> is
          <md>
            <mrow> z \amp = z_0 + a(x-x_0) + b(y-y_0)</mrow>
            <mrow> \amp = z_0 + f_x(x_0,y_0)(x-x_0) + f_y(x_0,y_0)(y-y_0)</mrow>
            <mrow> \amp = \frac{9}{2} - (x-1) - 2(y-1) </mrow>
          </md>
        </p>
      </answer>
      <solution>
        <p>
          The equation of the tangent plane to the graph of
          <m>f(x,y)=6-x^2/2 - y^2</m> at the point <m>(x_0,y_0)=(1,1)</m> is
          <md>
            <mrow> z \amp = z_0 + a(x-x_0) + b(y-y_0)</mrow>
            <mrow> \amp = z_0 + f_x(x_0,y_0)(x-x_0) + f_y(x_0,y_0)(y-y_0)</mrow>
            <mrow> \amp = \frac{9}{2} - (x-1) - 2(y-1) </mrow>
          </md>
        </p>
      </solution>
    </task>
            <!-- <li>
              <p>
                Determine the equation of the tangent line of the trace that you sketched in the previous part with <m>y=1</m> (in the <m>x</m> direction) at the point <m>x_0=1</m>.
                <figure xml:id="F_10_4_tangent_traces">
                  <caption>The traces of <m>f(x,y)</m> and the tangent plane.</caption>
                  <sidebyside widths="50% 50%">
                  <image source="images/fig_10_4_tangent_5"/>
                  <image source="images/fig_10_4_tangent_6"/>
                  </sidebyside>
                </figure>
              </p>
            </li>
            <li xml:id="PA-mv_deriv-linearization_tangent_line_plane">
              <p>
                <xref ref="F_10_4_tangent_traces">Figure</xref> shows the traces of the function and the traces of the tangent plane.  Explain how the tangent line of the trace of <m>f</m>, whose equation you found in the last part of this activity, is related to the tangent plane.  How does this observation help you determine the constant <m>a</m> in the equation for the tangent plane <m>z = z_0+a(x-x_0) + b(y-y_0)</m>?  (Hint: How do you think <m>f_x(x_0,y_0)</m> should be related to <m>z_x(x_0,y_0)</m>?)
              </p>
            </li>
            <li>
              <p>
                In a similar way to what you did in (d), determine the equation of the tangent line of the trace with <m>x=1</m> at the point <m>y_0=1</m>.  Explain how this tangent line is related to the tangent plane, and use this observation to determine the constant <m>b</m> in the equation for the tangent plane <m>z=z_0+a(x-x_0) + b(y-y_0)</m>. (Hint: How do you think <m>f_y(x_0,y_0)</m> should be related to <m>z_y(x_0,y_0)</m>?)
              </p>
            </li>
 -->
    </exploration>
</worksheet>
  </subsection>

  <subsection>
    <title>Differentiability and Local Linearity</title>
    <p>
      We will soon state a general formula for the equation of the tangent plane at a particular point on the graph of <m>z=f(x,y)</m>. However, before we do this, we briefly discuss some ways in which a function can fail to be locally linear. In single-variable calculus, one of the first functions you studied that was continuous but had a point where it was not locally linear was the absolute value function <m>f(x) = |x|</m>. When zooming in on the graph of <m>f</m> near the point <m>(0,0)</m>, the graph maintains a sharp corner, and thus <m>f</m> is not locally linear at the point on its graph with <m>x=0</m>.
    </p>
    <!-- <p>  
      As we have noted, when we look at the graph of a <q>nice</q> single-variable function on a small scale near a point <m>x_0</m>, we expect to see a line; in this case, we say that <em><m>f</m> is locally linear near <m>x_0</m></em> since the graph looks like a linear function locally around <m>x_0</m>. Of course, there are functions, such as the absolute value function given by <m>f(x)=|x|</m>, that are not locally linear at every point. In single-variable calculus, we learn that if the derivative of a function exists at a point, then the function is guaranteed to be locally linear there.
    </p> -->
    <p>
      In a similar way, we say that a two-variable function <term><m>f</m> is locally linear<idx><h>function</h><h>locally linear</h></idx> near <m>(x_0,y_0)</m></term> provided that the graph of <m>f</m> looks like a plane (its <term>tangent plane</term>) when viewed on a small scale near <m>(x_0,y_0)</m>. Determining when a function of two variables is locally linear at a point involves more nuance than in the single-variable setting, as the next example illustrates.
    </p>
    <example>
      <task>
        <statement>
          <p>
            The function <m>f(x,y)=|x|+|y|</m> is graphed in <xref ref="fig-mv_deriv-linearization-absxabsy"/>. No matter how much you zoom in around the origin, the surface will not look like a plane. You can also see this if you zoom in near any point on the surface with either <m>x=0</m> or <m>y=0</m>. While this function is continuous at every point, neither partial derivative will be defined when either <m>x</m> or <m>y</m> is zero. 
          </p>
          <figure xml:id="fig-mv_deriv-linearization-absxabsy">
            <caption>A plot of <m>f(x,y)=|x|+|y|</m> </caption>
            <interactive label="interactive-fig-mv_deriv-linearization-absxabsy" platform="sage" width="91%" aspect="1:1">
              <description><p>A plot of <m>f(x,y)=|x|+|y|</m> </p>
            </description><slate surface="sage">
                from sage.plot.plot3d.plot3d import axes
                plot8=axes(2.5,1,color="black")+text3d("x",(3,0,0),fontsize=30)+text3d("y",(0,3,0),fontsize=30)+text3d("z",(0,0,3),fontsize=30)
                var('x,y')
                plot8+=plot3d(abs(x)+abs(y),(x,-2,2),(y,-2,2),plot_points=31,mesh=True,opacity=0.8,color="lightblue")
                show(plot8)
              </slate>
            </interactive>
          </figure>
        </statement>
      </task>
      <task>
        <statement>
          <p>
            Your experience from single-variable calculus may lead you to reasonably expect that if <m>f_x(a,b)</m> and <m>f_y(a,b)</m> both exist at a point <m>(a,b)</m>, then <m>f</m> is locally linear at <m>(a,b)</m>. <alert>This is not sufficient, however.</alert> To illustrate this, consider the function defined by <m>f(x,y) = x^{1/3} y^{1/3}</m>. You can see from the figure below that as you zoom in around the origin, the graph does not flatten out and look like a plane. In <xref ref="Ez_10_4_0" text="type-local"/> guides you through using the limit definition of the partial derivative to show that <m>f_x(0,0)</m> and <m>f_y(0,0)</m> both exist, but that <m>f</m> is not locally linear at <m>(0,0)</m>. 
          </p>
          <figure xml:id="fig-mv_deriv-linearization-x13y13">
            <caption>A plot of <m>f(x,y)= x^{1/3} y^{1/3}</m> </caption>
            <interactive label="interactive-fig-mv_deriv-linearization-x13y13" platform="sage" width="100%" aspect="1:1">
              <description><p>A plot of <m>f(x,y)= x^{1/3} y^{1/3}</m> </p>
            </description><slate surface="sage">
                var('x,y,t,s')
                f(x,y)=x^(1/3.)*y^(1/3.)
                @interact
                def notLL1(a=slider(0,6,1,default=0,label="Zoom:")):
                    b=2^(-a)
                    p1=parametric_plot3d((s,t,f(s,t)),(s,0,b),(t,0,b),mesh=True,plot_points=21,opacity=0.5,color="lightblue")
                    p1+=parametric_plot3d((-s,-t,f(s,t)),(s,0,b),(t,0,b),mesh=True,plot_points=21,opacity=0.5)
                    p1+=parametric_plot3d((-s,t,-f(s,t)),(s,0,b),(t,0,b),mesh=True,plot_points=21,opacity=0.5)
                    p1+=parametric_plot3d((s,-t,-f(s,t)),(s,0,b),(t,0,b),mesh=True,plot_points=21,opacity=0.5)
                    show(p1)
              </slate>
            </interactive>
          </figure>
        </statement>
      </task>
    </example>
    <p>
      A precise discussion of differentiability of functions of more than one variable is beyond the scope of this text, but if you are interested in exploring these ideas a bit more, see <xref ref="Ez_10_4_4" text="type-local"/>. We will be content to define a stronger, but more easily verified, set of conditions called continuous differentiability that ensure local linearity. For our purposes, continuous differentiability is the only condition we will need to use. All of the results we encounter will apply to differentiable functions, and so also apply to continuously differentiable functions.
    </p>
    <assemblage xml:id="Differentiability">
      <title>Differentiability</title>
      <p>
        If <m>f</m> is a function of <m>x</m> and <m>y</m> for which both <m>f_x</m> and <m>f_y</m> exist and are continuous in an open disk containing the point <m>(x_0,y_0)</m>, then <m>f</m> is <term>continuously differentiable</term><idx><h>function</h><h>continuously differentiable</h></idx> at <m>(x_0,y_0)</m>.
      </p>
    </assemblage>

    <p>
      If a function <m>f</m> of two variables is continuously differentiable at a point <m>(x_0,y_0)</m>, then <m>f</m> has a tangent plane at <m>(x_0,y_0)</m>. This means that when viewed up close, the tangent plane and the graph of the function are virtually indistinguishable. You can see this illustrated in <xref ref="fig-mv_deriv-linearization-tangent_4"/> if you enable the Show Tangent Plane check box. 
    </p>
    </subsection>
    <subsection xml:id="subsec-tangentplane">
      <title>The Tangent Plane</title>
    <p>  
       Now that we have a good set of conditions to check if a tangent plane exists at a point, we return to the result of <xref ref="PA-mv_deriv-linearization">Preview Activity</xref> and have the following general formula for the tangent plane. 
    </p>

    <assemblage xml:id="Tangent-plane">
      <title>The Tangent Plane</title>
      <p>
        If <m>f(x,y)</m> is continuously differentiable at <m>(x_0,y_0)</m>, then the equation of the plane tangent to the graph of <m>f</m> at the point <m>(x_0,y_0,f(x_0,y_0))</m> is
        <men xml:id="eq_mv_deriv-linearization_tan_plane">
          z = f(x_0,y_0) + f_x(x_0,y_0)(x-x_0) + f_y(x_0,y_0)(y-y_0)
        </men>.
      </p>
    </assemblage>

    <p>
      Having the equation for a tangent plane in the form given by <m>z = f(x_0,y_0) + f_x(x_0,y_0)(x-x_0) + f_y(x_0,y_0)(y-y_0)</m> allows us to quickly identify important information about the function <m>f</m> at the point <m>(x_0,y_0)</m>. For example, if a function <m>f</m> has a tangent plane given by <m>z = 7 - 2(x-3) + 4(y+1)</m>, then we can immediately read from this form of the tangent plane equation the following:
      <ul>
        <li>
          <p>
            <m>f_x(3,-1) = -2</m>,
          </p>
        </li>
        <li>
          <p>
            <m>f_y(3,-1) = 4</m>,
          </p>
        </li>
        <li>
          <p>
            <m>f_x(3,-1)=-2</m> is the slope of the trace to both <m>f</m> and the tangent plane in the <m>x</m>-direction at <m>(3,-1)</m>, and
          </p>
        </li>
        <li>
          <p>
            <m>f_y(3,-1) = 4</m> is the slope of the trace of both <m>f</m> and the tangent plane in the <m>y</m>-direction at <m>(3,-1)</m>.
          </p>
        </li>
      </ul>
    </p>

        <!-- NEL: I don't really like this activity but this might be a nice low end thing to do after the heavier discussion of not locally linear -->
        <!-- MTK: Yeah, the original version of this activity was *bad*. I moved the heavier discussion later, removed the silly first task, and added one that asks students to read off features from the equation of the tangent plane -->
    <worksheet>
  <activity workspace="1.5in" xml:id="act-mv_deriv-linearization-tanplane">
    <!-- <task>
      <statement>
        <p>
          Find the equation of the tangent plane to function given by <m>f(x,y) = 2 + 4x - 3y</m> at the point <m>(1,2)</m>. You should simplify your equation for the tangent plane as much as possible and explain why this result should make sense in terms of the function <m>f</m>. 
        </p>
      </statement>
      <answer>
        <p>
          Since <m>\frac{\partial f}{\partial x} = 4</m> and <m>\frac{\partial f}{\partial y} = -3</m> we have <m>f_x(1,2) = 4</m> and <m>f_y(1,2) = -3</m>. So the equation of the plane tangent to <m>f</m> at <m>(1,2)</m> is
          <me>
            z = f_x(1,2)(x-1) + f_y(1,2)(y-2) + f(1,2)
          </me>
          or
          <me>
            z = 4(x-1) + (-3)(y-2) + 0
          </me>.
          Simplifying yields 
          <me>
            z = 4x -3y + 2
          </me>, 
          which is the same as the original function! However, note that the original function is the function of a plane. Since the tangent plane is the plane that is closest to (or best approximates) the original function at the point of tangency, it makes sense that the tangent plane to a plane is exactly the original plane itself.
        </p>
      </answer>
      <solution>
        <p>
          Since <m>\frac{\partial f}{\partial x} = 4</m> and <m>\frac{\partial f}{\partial y} = -3</m> we have <m>f_x(1,2) = 4</m> and <m>f_y(1,2) = -3</m>. So the equation of the plane tangent to <m>f</m> at <m>(1,2)</m> is
          <me>
            z = f_x(1,2)(x-1) + f_y(1,2)(y-2) + f(1,2)
          </me>
          or
          <me>
            z = 4(x-1) + (-3)(y-2) + 0
          </me>.
          Simplifying yields 
          <me>
            z = 4x -3y + 2
          </me>, 
          which is the same as the original function! However, note that the original function is the function of a plane. Since the tangent plane is the plane that is closest to (or best approximates) the original function at the point of tangency, it makes sense that the tangent plane to a plane is exactly the original plane itself.
        </p>
      </solution>
    </task> -->
    <task>
      <statement>
        <p>
          Find the equation of the tangent plane to <m>f(x,y) = x^2y</m> at the point <m>(1,2)</m>.
        </p>
      </statement>
      <answer>
        <p>
          Since <m>\frac{\partial f}{\partial x} = 2xy</m> and <m>\frac{\partial f}{\partial y} = x^2</m> we have <m>f_x(1,2) = 4</m> and <m>f_y(1,2) =1</m>. So the equation of the plane tangent to <m>f</m> at <m>(1,2)</m> is
          <me>
            z = f_x(1,2)(x-1) + f_y(1,2)(y-2) + f(1,2)
          </me>
          or
          <me>
            z = 4(x-1) + (y-2) + 2
          </me>
        </p>
      </answer>
      <solution>
        <p>
          Since <m>\frac{\partial f}{\partial x} = 2xy</m> and <m>\frac{\partial f}{\partial y} = x^2</m> we have <m>f_x(1,2) = 4</m> and <m>f_y(1,2) =1</m>. So the equation of the plane tangent to <m>f</m> at <m>(1,2)</m> is
          <me>
            z = f_x(1,2)(x-1) + f_y(1,2)(y-2) + f(1,2)
          </me>
          or
          <me>
            z = 4(x-1) + (y-2) + 2
          </me>
        </p>
      </solution>
    </task>  
    <task>
      <statement>
        <p>
          Suppose that the tangent plane to the graph of a continuously differentiable function <m>z=g(x,y)</m> is given in the form 
          <me>
            z = 5 - 3(x+2) + (y-3)
          </me>.
          Use the equation of the tangent plane to identify a point on the graph as well as a value of <m>g_x</m> and a value of <m>g_y</m>. Be sure to identify at what point(s) you have found the values of the partial derivatives.
        </p>
      </statement>
      <answer>
        <p>
          <m>(-2,3,5)</m>, <m>g_x(-2,3) = -3</m>, <m>g_y(-2,3) = 1</m>
        </p>
      </answer>
      <solution>
        <p>
          The point of tangency is <m>(-2,3,5)</m>, which we obtain by reading the values of <m>x_0</m>, <m>y_0</m>, and <m>z_0</m> from the tangent plane equation. The coefficient on the term involving <m>x</m> gives that <m>g_x(-2,3)=-3</m>, while the coefficient on the term involving <m>y</m> tells us that <m>g_y(-2,3)=1</m>.
        </p>
      </solution>
    </task>
    </activity>
</worksheet>
    <p>
      <alert>Important Note:</alert> As discussed before, the function <m>f(x,y)=x^{1/3}y^{1/3}</m>, which we saw in <xref ref="fig-mv_deriv-linearization-x13y13"/>, is not locally linear as we zoom in near the point <m>(0,0)</m>. However, as <xref ref="Ez_10_4_0" text="type-local"/> demonstrates, both <m>f_x(0,0)</m> and <m>f_y(0,0)</m> exist for this function. Thus, we can define the plane <m>z = f(x_0,y_0) + f_x(x_0,y_0)(x-x_0) + f_y(x_0,y_0)(y-y_0)</m>. However, this plane is <em>not</em> <q>tangent</q> to the graph in any reasonable sense. This is why we have specified that we require that <m>f</m> be continuously differentiable at a point in order to discuss the tangent plane at that point. The function <m>f(x,y)=x^{1/3}y^{1/3}</m> is not continuously differentiable (or differentiable) at <m>(0,0)</m>! Differentiability for a function of two variables implies the existence of a tangent plane. However, the existence of the two first order partial derivatives of a function at a point does <em>not</em> imply differentiability. This is quite different from single-variable calculus, where the derivative existing at a point is equivalent to the function being locally linear at that point. 
    </p>
    

  </subsection>
  <subsection>
    <title>Linearization</title>
    <p>
      In single-variable calculus, an important use of the tangent line is to approximate a differentiable function. Near the point <m>x_0</m>, the tangent line to the graph of <m>f</m> at <m>x_0</m> is close to the graph of <m>f</m> for input values close to <m>x_0</m>, as shown in <xref ref="fig-mv_deriv-linearization-LL2">Figure</xref>. Adjust the Zoom slider to examine a small region around the highlighted point to see how the tangent line is a good approximation for a small region around that point. In fact, the smaller the scale around the point, the better the approximation is. 
    </p>
    <figure xml:id="fig-mv_deriv-linearization-LL2">
      <caption>A plot of a locally linear function <m>f</m> </caption>
      <interactive label="interactive-LL2" platform="sage" width="100%" aspect="1:1">
        <description><p>A plot of a locally linear function <m>f</m> </p>
      </description><slate surface="sage">
          @interact
          def LL2D(zoom=slider(0,8,1,default=0,label="Zoom")):
              var('x')
              val=1
              s=0.8
              f(x)=x*cos(pi*x)
              df(x)=diff(f,x)
              fv=f(val)
              dfv=df(val)
              if(zoom==0):
                xtop=4;xbottom=-4;
              else:
                xbottom=val-2^(-zoom+1);xtop=val+2^(-zoom+1);
              plot1=plot(f(x),(x,xbottom,xtop),color="black",gridlines=True,thickness=2)
              plot1+=point((val,fv),color="black",size=40)
              plot1+=line([(xbottom,fv-dfv*(1-xbottom)),(xtop,fv+(xtop-1)*dfv)],color="red",thickness=2)
              show(plot1)
        </slate>
      </interactive>
    </figure>
    <!-- <figure xml:id="F_10_4_2d_linear">
      <caption>The linearization of the single-variable function <m>f(x)</m>.</caption>
      <sidebyside widths="50% 50%">
      <image source="images/fig_10_4_2d_linear"/>
      <image source="images/fig_10_4_2d_linear_gray"/>
      </sidebyside>
    </figure> -->

    <p>
      In this single-variable setting, we let <m>L</m> denote the function whose graph is the tangent line, and thus
      <me>
        L(x) = f(x_0) + f'(x_0)(x-x_0)
      </me>.
      Furthermore, <m>f(x) \approx L(x)</m> near <m>x_0</m>. We call <m>L</m> the <term>linearization</term> of <m>f</m>.
    </p>
    <p>
      In the same way, the tangent plane to the graph of a differentiable function <m>z = f(x,y)</m> at a point <m>(x_0,y_0)</m> provides a good approximation of <m>f(x,y)</m> near <m>(x_0, y_0)</m>. Here, we define the <term>linearization</term>, <m>L</m>, to be the two-variable function whose graph is the tangent plane. Thus
      <men xml:id="linearizationeqn">
        L(x,y) = f(x_0,y_0) + f_x(x_0,y_0)(x-x_0) + f_y(x_0,y_0)(y-y_0)
      </men>
      is the linearization of <m>f</m> at <m>(x_0,y_0)</m>. Note that <m>f(x,y)\approx L(x,y)</m> for points near <m>(x_0, y_0)</m>, which is illustrated in <xref ref="fig-mv_deriv-linearization-tangent_linearization">Figure</xref>.
    </p>
    <figure xml:id="fig-mv_deriv-linearization-tangent_linearization">
      <caption>A plot of a locally linear function <m>f(x,y)</m> </caption>
      <interactive label="interactive-fig-mv_deriv-linearization-tangent_linearization" platform="sage" width="91%" aspect="1:1">
        <description><p>A plot of a locally linear function <m>f(x,y)</m> </p>
      </description><slate surface="sage">
          var('x,y,s,t')
          a=2
          z=2*2^(-a)
          plot6=plot3d(6-x^2/2-y^2,(x,1-z,1+z),(y,1-z,1+z),color="blue",plot_points=13,opacity=0.4,mesh=True)
          plot6+=point((1,1,4.5),color="black",size=30*z)
          plot6+=parametric_plot3d((1-s,1-t,4.5+s+2*t),(s,-z,z),(t,-z,z),color="red",opacity=0.3,plot_points=5,mesh=True)
          show(plot6,viewpoint=[[-0.5332,-0.5677,-0.6272],119],camera_position=[1.1679,1.0105,2.2664],aspect_ratio=(1,1,0.3))
        </slate>
      </interactive>
    </figure>
    <!-- <figure xml:id="fig-mv_deriv-linearization-tangent_linearization">
      <caption>The linearization of <m>f(x,y)</m>.</caption>
      <image width="50%" source="images/fig_10_4_tangent_9"/>
    </figure> -->
    <p>
      Using a function's linearization when you already have an algebraic expression for the function provides little value. However, in many applications the function of interest does not have an algebraic formula. For instance, if you were working for a mining company and were trying to map a pocket of some resource underground, it would be <em>very</em> expensive to drill out a bunch of samples to make a chart with amounts of the resource at a comprehensive grid of locations. Instead, you could be more selective in obtaining data via sampling and then use linearization to make estimates for intermediate locations. Linearization is a valuable first step in determining a way to estimate values across different input locations. In later courses, you may encounter more sophisticated ways to estimate between data points and discuss the advantages and drawbacks of these ideas. 
    </p>
    <example>
      <p>
        In this example, we will give the equation of the tangent plane to <m>f(x,y)=6-\frac{x^2}{2}-y^2</m> at the point <m>(1,1)</m>, state the associated linearization, and use this linearization to estimate the output of <m>f</m> for a nearby input.
      </p>
      <p>
        The partial derivatives of <m>f</m> are <m>f_x=-x</m> and <m>f_y=-2y</m>. This gives the values <m>f_x(1,1)=-1</m> and <m>f_y(1,1)=-2</m>. Using <m>f(1,1)=4.5</m>, the tangent plane to <m>f</m> at the point <m>(1,1)</m> is <me>z=4.5+(-1)(x-1)+(-2)(y-1)</me>.
      </p>
      <p>
        The linearization of <m>f</m> at <m>(1,1)</m> is <me>L(x,y)=4.5+(-1)(x-1)+2(y-1)</me>. Notice that the same information is used to find the tangent plane and the linearization. Generally speaking, we consider the tangent plane to be a geometric tool, while and the linearization is a function or algebraic tool. However, both describe <m>f</m> near <m>(1,1)</m>. We can use the linearization to estimate <m>f(0.9,1.2)</m>:
        <md>
          <mrow>f(0.9,1.2) \amp \approx L(0.9,1.2) = 4.5+(-1)(0.9-1)+(-2)(1.2-1)</mrow>
          <mrow> \amp= 4.5+(0.1)-0.4=4.8</mrow>
        </md>.
      </p>
    </example>
    <p>
      Because we had an algebraic expression for <m>f</m> in the previous example, we could have evaluated <m>f(0.9,1.2)</m> directly. However, as the next activity shows, many applications of multivariable functions use tables or graphs where it is not possible to have the function's output at every possible input. 
    </p>
    <worksheet>
  <activity workspace="1.5in" xml:id="act-mv_deriv-linearization-tanplane1">
    <introduction>
      <p>
        In this activity, we will find the linearization of several different functions that are given in algebraic, tabular, or graphical form.
      </p>
    </introduction>
    <task>
      <statement>
        <p>
          Find the linearization <m>L(x,y)</m> for the function <m>g</m> defined by
          <me>
            g(x,y) = \frac{x}{x^2+y^2}
          </me>
          at the point <m>(1,2)</m>.  Use the linearization to estimate the value of <m>g(0.8, 2.3)</m>.
        </p>
      </statement>
      <answer>
        <p>
          <m>
            L(x,y) = \frac{1}{5} + \frac{3}{25}(x-1) - \frac{4}{25}(y-2) </m>.
          <m>
            g(0.8,2.3) \approx 0.128
          </m>.
        </p>
      </answer>
      <solution>
        <p>
          To find the linearization of <m>g</m> we need the first order partials. Now
          <md>
            <mrow>g_x(x,y) \amp = \frac{(x^2+y^2)-2x^2}{(x^2+y^2)^2} = \frac{y^2-x^2}{(x^2+y^2)^2}</mrow>
            <mrow>g_y(x,y) \amp = \frac{-2xy}{(x^2+y^2)^2}</mrow>
          </md>.
          So the linearization of <m>g</m> at the point (1,2) is
          <md>
            <mrow> L(x,y) \amp = g(1,2) +g_x(1,2)(x-1) + g_y(1,2)(y-2)</mrow>
            <mrow> \amp = \frac{1}{5} + \frac{3}{25}(x-1) - \frac{4}{25}(y-2) </mrow>
          </md>.
          It follows that
          <me>
            g(0.8,2.3) \approx L(0.8,2.3) = \frac{1}{5} - \frac{3}{25}(0.2) - \frac{4}{25}(0.3) = 0.128
          </me>.
          Since <m>g(0.8,2.3) \approx 0.135</m>, we have a fair approximation. This should be expected since the step sizes of 0.2 and 0.3 are not that small.
        </p>
      </solution>
    </task>  
    <task xml:id="task-act-mv_deriv-linearization-windchill-linearization">
      <statement>
        <p>
          The table below provides a collection of values of the wind chill <m>w(v,T)</m>, in degrees Fahrenheit, as a function of  wind speed, in miles per hour, and temperature, also in degrees Fahrenheit.
        </p>
          <tabular halign="center">
            <row>
              <cell><m>v \backslash T</m></cell>
              <cell bottom="medium"><m>-20</m></cell>
              <cell bottom="medium"><m>-15</m></cell>
              <cell bottom="medium"><m>-10</m></cell>
              <cell bottom="medium"><m>-5</m></cell>
              <cell bottom="medium"><m>0</m></cell>
              <cell bottom="medium"><m>5</m></cell>
              <cell bottom="medium"><m>10</m></cell>
            </row>
            <row>
              <cell right="medium"><m>10</m></cell>
              <cell><m>-41</m></cell>
              <cell><m>-35</m></cell>
              <cell><m>-28</m></cell>
              <cell><m>-22</m></cell>
              <cell><m>-16</m></cell>
              <cell><m>-10</m></cell>
              <cell><m>-4</m></cell>
            </row>
            <row>
              <cell right="medium"><m>15</m></cell>
              <cell><m>-45</m></cell>
              <cell><m>-39</m></cell>
              <cell><m>-32</m></cell>
              <cell><m>-26</m></cell>
              <cell><m>-19</m></cell>
              <cell><m>-13</m></cell>
              <cell><m>-7</m></cell>
            </row>
            <row>
              <cell right="medium"><m>20</m></cell>
              <cell><m>-48</m></cell>
              <cell><m>-42</m></cell>
              <cell><m>-35</m></cell>
              <cell><m>-29</m></cell>
              <cell><m>-22</m></cell>
              <cell><m>-15</m></cell>
              <cell><m>-9</m></cell>
            </row>
            <row>
              <cell right="medium"><m>25</m></cell>
              <cell><m>-51</m></cell>
              <cell><m>-44</m></cell>
              <cell><m>-37</m></cell>
              <cell><m>-31</m></cell>
              <cell><m>-24</m></cell>
              <cell><m>-17</m></cell>
              <cell><m>-11</m></cell>
            </row>
            <row>
              <cell right="medium"><m>30</m></cell>
              <cell><m>-53</m></cell>
              <cell><m>-46</m></cell>
              <cell><m>-39</m></cell>
              <cell><m>-33</m></cell>
              <cell><m>-26</m></cell>
              <cell><m>-19</m></cell>
              <cell><m>-12</m></cell>
            </row>
            <row>
              <cell right="medium"><m>35</m></cell>
              <cell><m>-55</m></cell>
              <cell><m>-48</m></cell>
              <cell><m>-41</m></cell>
              <cell><m>-34</m></cell>
              <cell><m>-27</m></cell>
              <cell><m>-21</m></cell>
              <cell><m>-14</m></cell>
            </row>
          </tabular>
        <p>
          Use the data to first estimate the appropriate partial derivatives, and then find the linearization <m>L(v,T)</m> at the point <m>(20,-10)</m>.  Finally, use the linearization to estimate <m>w(10,-10)</m>, <m>w(20,-12)</m>, and <m>w(18,-12)</m>. Compare your results to what you obtained in <xref ref="act-mv_deriv-first_order-table">Activity</xref>.
        </p>
      </statement>
      <answer>
        <p>
          <m>
            L(v,T) \approx -37 - 0.4(v-25) + 0.7(T+10)
          </m>.
          <md>
            <mrow>w(25,-12) \amp \approx  -38.4</mrow>
            <mrow>w(23, -10) \amp \approx -36.2</mrow>
            <mrow>w(23, -12) \amp \approx  -37.6</mrow>
          </md>
        </p>
      </answer>
      <solution>
        <p>
           We need <m>w_v(25,-10)</m> and <m>w_T(25,-10)</m> to find the linearization. Using the symmetric difference quotients gives us
          <md>
            <mrow>w_v(25,-10) \amp \approx \frac{w(30,-10)-w(20,-10)}{10} = \frac{-39-(-35)}{10} = -0.4</mrow>
            <mrow>w_T(25,-10) \amp \approx \frac{w(25,-5)-w(25,-15)}{10} = \frac{-31-(-44)}{10} = 0.7</mrow>
          </md>.
          So the linearization of <m>w</m> at <m>(25, -10)</m> is
          <me>
            L(v,T) \approx -37 - 0.4(v-25) + 0.7(T+10)
          </me>.
          Thus,
          <md>
            <mrow>w(25,-12) \amp \approx L(25,-12) \approx -37 - 0.4(0) + 0.7(-2) = -38.4</mrow>
            <mrow>w(23, -10) \amp \approx L(23,-10) \approx -37 - 0.4(-2) + 0.7(0) = -36.2</mrow>
            <mrow>w(23, -12) \amp \approx L(23,-12) \approx -37 - 0.4(-2) + 0.7(-2) = -37.6</mrow>
          </md>
        </p>
      </solution>
    </task>  
    <task>
      <statement>
        <p>
          The image below gives a contour  plot of a continuously differentiable function <m>f</m>. After estimating appropriate partial derivatives, determine the linearization <m>L(x,y)</m> at the point <m>(2,1)</m>, and use it to estimate <m>f(2.2, 1)</m>, <m>f(2, 0.8)</m>, and <m>f(2.2, 0.8)</m>.
        </p>
            <image width="50%" source="images/fig_10_3_activity_contour"><description><p>ADD ALT TEXT TO THIS IMAGE</p></description></image>
      </statement>
      <answer>
        <p>
          <m>
            L(x,y) \approx 3 - 1.45(x-2) + 1.25(y-1)
          </m>.
          Thus,
          <md>
            <mrow>f(2.2,1) \amp \approx 2.71</mrow>
            <mrow>f(2, 0.8) \amp \approx  2.75</mrow>
            <mrow>f(-1.8, 2.1) \amp \approx 2.46</mrow>
          </md>.
        </p>
      </answer>
      <solution>
        <p>
          We need <m>f_x(2,1)</m> and <m>f_y(2,1)</m> to find the linearization. Using the symmetric difference quotients gives us
          <md>
            <mrow>f_x(2,1) \amp \approx \frac{f(3,1)-f(1,1)}{2} \approx \frac{1.9-4.8)}{2} = -1.45</mrow>
            <mrow>f_y(2,1) \amp \approx \frac{f(2,2)-f(2,0)}{2} \approx \frac{4.3-1.8}{10} = 1.25</mrow>
          </md>.
          So the linearization of <m>f</m> at <m>(2, 1)</m> is
          <me>
            L(x,y) \approx 3 - 1.45(x-2) + 1.25(y-1)
          </me>.
          Thus,
          <md>
            <mrow>f(2.2,1) \amp \approx L(2.2,1) \approx 3 - 1.45(0.2) + 1.25(0) = 2.71</mrow>
            <mrow>f(2, 0.8) \amp \approx L(2, 0.8) \approx 3 - 1.45(0) + 1.25(-0.2) = 2.75</mrow>
            <mrow>f(-1.8, 2.1) \amp \approx L(2.2, 0.8) \approx 3 - 1.45(0.2) + 1.25(-0.2) = 2.46</mrow>
          </md>.
          The last two should be poor approximations since we are approximating quite far from the base point of <m>(2,1)</m>.
        </p>
      </solution>
    </task>
    </activity>
</worksheet>
  </subsection>
  <subsection>
    <title>Differentials</title>
    <p>
      As we have seen, the linearization <m>L(x,y)</m> allows us to estimate the value of <m>f(x,y)</m> for points <m>(x,y)</m> near the point <m>(x_0, y_0)</m>. Sometimes, however, we are more interested in the <em>change</em> in <m>f</m> as we move from the point <m>(x_0,y_0)</m> to another point <m>(x,y)</m>.
    </p>
    <figure xml:id="fig-mv_deriv-linearization-differential">
      <caption>A plot of a locally linear function <m>f(x,y)</m> </caption>
      <interactive label="interactive-fig-mv_deriv-linearization-differential" platform="sage" width="91%" aspect="1:1">
        <description><p>A plot of a locally linear function <m>f(x,y)</m> </p>
      </description><slate surface="sage">
          <xi:include href="interacts/differentialplot.txt" parse="text"/>
        </slate>
      </interactive>
    </figure>
    <!-- <figure xml:id="fig-mv_deriv-linearization-differential">
      <caption>The differential <m>df</m> approximates the change in <m>f(x,y)</m>.</caption>
      <image width="50%" source="images/fig_10_4_tangent_10"/>
    </figure> -->
    <p>
      <xref ref="fig-mv_deriv-linearization-differential">Figure</xref> illustrates a perspective on measuring the change in the output of <m>f</m>. The graph of <m>f</m> is shown in blue, while the graph of its tangent plane is shown in red. The change we seek to measure is identified as <m>\Delta f</m> in blue. If we consider the displacement <m>\langle \Delta x, \Delta y\rangle</m> to a new point <m>(x,y) = (x_0+\Delta x, y_0 + \Delta y)</m>, we would like to know how much the output of the function <m>f</m> has changed. We denote this change by <m>\Delta f</m>, where
      <me>
        \Delta f = f(x,y) - f(x_0, y_0)
      </me>.
    </p>
    <p>
      A simple way to estimate the change <m>\Delta f</m> is to approximate it by <m>df</m>, which represents the change in the linearization <m>L(x,y)</m> as we move from <m>(x_0,y_0)</m> to <m>(x,y)</m>. This gives
      <md>
        <mrow>\Delta f \approx df \amp = L(x,y)-L(x_0, y_0)</mrow>
        <mrow>\amp = [f(x_0,y_0)+ f_x(x_0,y_0)(x-x_0) + f_y(x_0,y_0)(y-y_0)] - f(x_0, y_0)</mrow>
        <mrow>\amp = f_x(x_0,y_0)\Delta x + f_y(x_0, y_0)\Delta y</mrow>
      </md>.
    </p>
    <p>
      For consistency, we will denote the change in the input variables as <m>dx = \Delta x</m> and <m>dy = \Delta y</m>. These quantities are equal because the change in the <m>x</m>- and <m>y</m>-coordinates are the same whether we use the function <m>f</m> or the linearization <m>L</m>. Thus,
      <men xml:id="eq-mv_deriv-linearization-differential">
        \Delta f \approx df = f_x(x_0,y_0) dx + f_y(x_0,y_0) dy
      </men>.
    </p>
    <p>
      The equivalent expression using Leibniz notation is
      <men xml:id="eq-mv_deriv-linearization-differential_leib">
        df = \frac{\partial f}{\partial x} dx + \frac{\partial f}{\partial y} dy
      </men>.
    </p>
    <p>
      We call the quantities <m>dx</m>, <m>dy</m>, and <m>df</m> <term>differentials</term><idx><h>differentials</h></idx>, and we think of them as measuring small changes in the quantities <m>x</m>, <m>y</m>, and <m>f</m>. Equations <xref ref="eq-mv_deriv-linearization-differential"/> and <xref ref="eq-mv_deriv-linearization-differential_leib"/> express the relationship between these changes. Equation <xref ref="eq-mv_deriv-linearization-differential_leib"/> resembles an important idea from single-variable calculus: when <m>y</m> depends on <m>x</m>, we can use the notation of differentials to write
      <me>
        dy = y' dx = \frac{dy}{dx} dx
      </me>.
    </p>
    <p>
      We will illustrate the use of differentials with an example. 
    </p>
    <example>
      <p>
        Suppose we have a machine that cuts rectangles of width <m>x=20</m> cm and height <m>y=10</m> cm. However, the machine isn't perfect, and therefore the width could be off by <m>dw = \Delta w = 0.2</m> cm and the height could be off by <m>dh = \Delta h = 0.4</m> cm.
      </p>
      <p>
        The area of the rectangle is
        <me>
          A(w,h) = wh,
        </me>
        which means that the area of a perfectly-manufactured rectangle is <m>A(20, 10) = 200</m> square centimeters. Since the machine isn't perfect, we would like to know how much the area of a given rectangle could differ from the perfect rectangle. We will estimate the uncertainty in the area using <xref ref="eq-mv_deriv-linearization-differential"/>, and find that
        <me>
          \Delta A \approx dA = A_w(20, 10) \enspace dw + A_h(20,10)\enspace dh
        </me>
      </p>
      <p>
        By computing partial derivatives, we find that <m>A_w = h</m> and <m>A_h = w</m>. This implies that
        <me>
          \Delta A \approx dA = 10 \enspace dw + 20 \enspace dh = 10 (0.2) + 20 (0.4) = 10
        </me>.
        That is, we estimate that the area in our rectangles could be off by as much as 10 square centimeters.
      </p>
      <p>
        We can apply our differential for a box of a different size as well. If we wanted to make rectangles that are 63 cm wide and 25 cm high and our machines had the same tolerances (<m>dw = \Delta w = 0.2</m> cm and <m>dh = \Delta h = 0.4</m> cm), then our target rectangle would have area 1,575 square centimeters but the uncertainty in the area would be <m>30.2 cm^2</m>:
        <md>
          <mrow> \Delta A \approx dA =\amp A_w(63, 25) \enspace dw + A_h(63,25) \enspace dh</mrow>
          <mrow> \amp=  25 dw + 63 dh</mrow>
          <mrow> \amp= 25 (0.2) + 63 (0.4) = 30.2 </mrow>
        </md>
      </p>
    </example>
    <p>
      In the next activity, we will explore the differential in several different contexts. First, however, we highlight some of the differences in meaning and usage between the change in the output of a function, the linearization, and the differential. In particular, we will look back at <xref ref="fig-mv_deriv-linearization-differential"/>, equation <xref ref="eq-mv_deriv-linearization-differential"/>, and equation <xref ref="linearizationeqn"/>.
    </p>
    <p>  
      The linearization of a function at a point is the algebraic function equivalent to the tangent plane at that point. If a function is <q>nice</q> (meaning differentiable or continuously differentiable), then the tangent plane/linearization will be close to the actual function on a small neighborhood around the base point. This gives us both a geometric tool in the form of the tangent plane and a numerical tool in the form of the lienarization to estimate the function's outputs in a small region around the point of interest.
    </p>
    <p>  
      As <xref ref="fig-mv_deriv-linearization-differential"/> shows visually, the difference between a function's output at <m>(x_0,y_0)</m> and at <m>(x,y)</m> is given by <m>\Delta f</m>. The difference between the linearization at <m>(x_0,y_0)</m> and <m>(x,y)</m> is given by <m>df</m>. If we look at a small enough scale, the difference between the differential and <m>\Delta f</m> will be small. The differential is primarily an algebraic tool that will allow us to talk how the change in the output of our function varies depending on the location we consider, which changes <m>f_x</m> and <m>f_y</m>, and how much change we will allow in the input variables, represented as <m>dx</m> and <m>dy</m>.
    </p>
    <worksheet>
  <activity workspace="1.5in" xml:id="act-mv_deriv-linearization-tanplane2">
      <task>
        <statement>
          <p>
            Suppose that the elevation of a plot of land is given by the function <m>h</m>, where we additionally know that <m>h(3,1) = 4.35</m>, <m>h_x(3,1) = 0.27</m>, and <m>h_y(3,1) = -0.19</m>. Assume that <m>x</m> and <m>y</m> are measured in miles in the east and north directions, respectively, from <m>(0,0)</m>.
          </p>
          <p>
            Your GPS device says that you are currently at the point <m>(3,1)</m>. However, you know that the coordinates are only accurate to within <m>0.2</m> miles; that is, <m>dx = \Delta x = 0.2</m> and <m>dy= \Delta y = 0.2</m>.  Estimate the uncertainty in your elevation using differentials.
          </p>
        </statement>
        <answer>
          <p>
            <me>
              \Delta h \approx  0.016
            </me>
          </p>
        </answer>
        <solution>
          <p>
            The error is approximated by the differential
            <me>
              \Delta h \approx dh = h_x(3,1)~dx + h_y(3,1)~dy = 0.27(0.2) - 0.19(0.2) = 0.016
            </me>.
          </p>
        </solution>
      </task>
      <task>
        <statement>
          <p>
            The pressure, volume, and temperature of an ideal gas are related by the equation
            <me>
              P= P(T,V) = 8.31 \frac{T}{V},
            </me>
            where <m>P</m> is measured in kilopascals, <m>V</m> in liters, and <m>T</m> in kelvin.  Find the pressure when the volume is 12 liters and the temperature is 310 K. Use differentials to estimate the change in the pressure when the volume increases to 12.3 liters and the temperature decreases to 305 K.
          </p>
        </statement>
        <answer>
          <p>
            <m>P(310,12) = 214.675</m>. 
            Therefore, the pressure decreases by about 8.82938 kilopascals.
          </p>
        </answer>
        <solution>
          <p>
            First note that <m>P(310,12) = 214.675</m>. To find the differential, we need both <m>P_T(310,12)</m> and <m>P_V(310,12)</m>. Our differentiation rules give us
            <md>
              <mrow>P_T(T,V) \amp = 8.31\frac{1}{V}</mrow>
              <mrow>P_V(T,V) \amp = -8.31\frac{T}{V^2}</mrow>
            </md>.
            So <m>P_T(310,12) = 0.6925</m> and <m>P_V(310,12) \approx -17.8896</m>. We have <m>dT = -5</m> and <m>dV = 0.3</m>, and the change in pressure is
            <md>
              <mrow> \Delta P \amp \approx dP  = P_T(310,12)~dT + P_V(310,12)~dV </mrow>
              <mrow> \amp \approx 0.6925(-5) - 17.8896(0.3)  = -8.82938 </mrow>
            </md>.
            Therefore, the pressure decreases by about 8.82938 kilopascals.
          </p>
        </solution>
      </task>
      <task>
        <statement>
          <p>
            Use the table of values for the wind chill <m>w(v,T)</m>, in degrees Fahrenheit, as a function of temperature, also in degrees Fahrenheit, and wind speed, in miles per hour provided in <xref ref="task-act-mv_deriv-linearization-windchill-linearization"/> for this part. Suppose your anemometer<fn>An instrument for measuring wind speed.</fn> says the wind is blowing at <m>25</m> miles per hour and your thermometer<fn>An instrument for measuring the temperature.</fn> shows a reading of <m>-15^\circ</m> degrees. However, you know your thermometer is only accurate to within <m>2^\circ</m> degrees and your anemometer is only accurate to within <m>3</m> miles per hour.  What is the wind chill based on your measurements? Estimate the uncertainty in your measurement of the wind chill.
          </p>
        </statement>
        <answer>
          <p>
            <m>w(25,-15) = -44^{\circ}F</m>.
            <m>
              \Delta w 1.6^{\circ}F
            </m>.
          </p>
        </answer>
        <solution>
          <p>
            First note that
            <md>
              <mrow>w_v(25,-15) \amp \approx \frac{w(30,-15)-w(20,-15)}{10} = \frac{-46-(-42)}{10} = -0.4</mrow>
              <mrow>w_T(25,-15) \amp \approx \frac{w(25,-10)-w(25,-20)}{10} = \frac{-37-(-51)}{10} = 1.4</mrow>
            </md>.
            The wind chill is <m>w(25,-15) = -44^{\circ}F</m>. But since <m>dT = 2</m> and <m>dv = 3</m>, our wind chill measurement has an error of
            <me>
              \Delta w \approx dw = -0.4(3) + 1.4(2) = 1.6^{\circ}F
            </me>.
          </p>
        </solution>
      </task>
    </activity>
</worksheet>
    <p>
      We close this section by highlighting an idea that was used throughout this section and will be used time and again in this chapter. For a <q>nice</q> function (e.g., locally linear, differentiable, or continuously differentiable), the rate of change in the output of the function as you approach a specific point is the same as the rate of change along the linearization. In other words, we can approximate change near a point by looking at the change on the linearization. We can also evaluate the rates of change along our surface by evaluating the corresponding change on the linearization. Regardless of the direction, these rates of change will be the same at the specified point.
    </p>
  </subsection>
  <subsection>
    <title>Summary</title>
    <ul>
      <li>
        <p>
          A function <m>f</m> of two independent variables is locally linear at a point <m>(x_0,y_0)</m> if the graph of <m>z=f(x,y)</m> looks like a plane as we zoom in on the graph (around the point <m>(x_0,y_0)</m>).  In this case, the equation of the tangent plane is given by
          <me>
            z = f(x_0,y_0) + f_x(x_0,y_0)(x-x_0) + f_y(x_0,y_0)(y-y_0).
          </me>
        </p>
      </li>

      <li>
        <p>
          The function <m>L(x,y) = f(x_0,y_0) + f_x(x_0,y_0)(x-x_0) + f_y(x_0,y_0)(y-y_0)</m> is called the linearization of a differentiable function <m>f</m> at <m>(x_0,y_0)</m> and may be used to estimate values of <m>f(x,y)</m>;  that is, <m>f(x,y) \approx L(x,y)</m> for points <m>(x,y)</m> near <m>(x_0,y_0)</m>. The graph of the linearization function is the tangent plane.
        </p>
      </li>

      <li>
        <p>
          A function <m>f</m> of two independent variables is differentiable at <m>(x_0,y_0)</m> provided that both <m>f_x</m> and <m>f_y</m> exist and are continuous in an open disk containing the point <m>(x_0,y_0)</m>.
        </p>
      </li>

      <li>
        <p>
          The differential <m>df</m> of a function <m>f= f(x,y)</m> is related to the differentials <m>dx</m> and <m>dy</m> by
          <me>
            df = f_x(x_0,y_0) dx + f_y(x_0,y_0)dy.
          </me>
          We can use this relationship to approximate small changes in the output of <m>f</m> that results from small changes in <m>x</m> and <m>y</m>.
        </p>
      </li>
    </ul>

    </subsection>
<xi:include href="./exercises/ez-S_mv_Linearization.ptx"/>
</section>
