<?xml version="1.0"?>
<!-- **********************************************************************-->
<!-- Copyright 2013-2025                                                   -->
<!-- Nicholas Long, Mitchel Keller, Steven Schlicker                       -->
<!--                                                                       -->
<!-- This file is part of Active Calculus Multivariable.                   -->
<!--                                                                       -->
<!-- Permission is granted to copy, distribute and/or modify this document -->
<!-- under the terms of the Creative Commons BY-NC-SA license.  The work   -->
<!-- may be used for free by any party so long as attribution is given to  -->
<!-- the author(s), the work and its derivatives are used in the spirit of -->
<!-- "share and share alike"; no party may sell this work or any of its    -->
<!-- derivatives for profit.  All trademarks are the registered marks of   -->
<!-- their respective owners.                                              -->
<!-- **********************************************************************-->
<section xml:id="S-mv_deriv-directional" xmlns:xi="http://www.w3.org/2001/XInclude">
  <title>Directional Derivatives and the Gradient</title>
  <objectives>
      <ul>
        <li>
          <p>
            The partial derivatives of a function <m>f</m> tell us the rate of change of <m>f</m> in the direction of the coordinate axes. How can we measure the rate of change of <m>f</m> in other directions?
          </p>
        </li>
        <li>
          <p>
            What is the gradient of a multivariable function and what does it tell us about the rate of change in different directions?
          </p>
        </li>
      </ul>
  </objectives>
  <introduction component="instructor">
    <title>Notes to the Instructor and Dependencies</title>
    <p>
      This section relies on many of the tools we have developed throughout <xref ref="C_MVF"/>, most importantly we will use the linearization from <xref ref="S-mv_deriv-linearization"/>. The chain rule introduced in <xref ref="S_mv_deriv-chain_rule"/> is used to define an efficient calculation of the directional derivative but is not critical for this section.
    </p>
    <p>
      You will likely want to cover this section over several classes since these ideas are important to many other partner fields. The gradient is defined after the development of the directional derivative because the interpretations of the gradient are dependent on the directional derivative. 
    </p>
  </introduction>
  <subsection>
    <title>Introduction</title>
    <p>
      The partial derivatives of a multivariable function tell us the instantaneous rate at which the function's output changes as we hold all but one input variable constant (allowing the remaining input variable to change). It is natural to wonder how we can measure the rate at which a function changes in a direction other than parallel to a coordinate axes. In this section, we investigate this question and will connect the rates of change in other directions to the rates of change given by the partial derivatives. The Preview Activity investigates these concepts in terms of a contour map representing elevation in terms of location.
    </p>
    <p>
      We can use cardinal directions to specify the direction of displacement vectors. These directions can be described by a compass rose. The compass rose given in <xref ref="comp_rose1" /> is an example of a sixteen point compass rose. Directions of the form ESE are read as <q>east-southeast</q> and point in the direction halfway between east and southeast.
    </p>
    <figure xml:id="comp_rose1">
      <caption>An example of a sixteen-point compass rose (from <url
      href="https://commons.wikimedia.org/w/index.php?curid=667281" visual="commons.wikimedia.org/w/index.php?curid=667281">By Brosen~commonswiki - Own work, CC BY 2.5</url>)</caption>
      <image width="50%" source="/Brosen_windrose.png">
        <shortdescription>A sixteen-point compass rose</shortdescription>
        <description><p>A sixteen-point compass rose</p></description>
      </image>
    </figure>
    <worksheet>
  <exploration workspace="1.5in"
 xml:id="PA-DD">
      <introduction>
        <p>
          Below is a contour plot showing the elevations for a region of a nearby park. <!-- The elevations are given in meters above sea level and the horizontal and vertical grid lines are 1 km apart. Several locations are labeled on <xref ref="PA-DDcontour1"/> with capital letters. --> We will be referring to <m>h(x,y)</m> as the function of two variables that gives the elevation as a function of <m>x</m>-coordinate (location in the east-west or horizontal direction) and <m>y</m>-coordinates (location in the north-south or vertical direction).
        </p>
        <image width="60%">
          <shortdescription>A contour plot with three locations marked</shortdescription>
          <description>
            <p>A contour plot on which three points (<m>A</m>, <m>B</m>, and <m>C</m>) are marked.
            </p>
          </description>
          <sageplot label="img-PA-DDcontour1">
            from matplotlib import ticker
            var('x,y,z,s,t')
            f(x,y)=(x*y+(y-20)^2)/125+90*exp(-(((x-70)/90)^2+((y+10)/30)^2))+100+100*exp(-(((x+75)/30)^2+((y-50)/60)^2))
            n=20
            c=[100+i*7.5 for i in range(n)]
            plot2=contour_plot(f(x,y),(x,-100,100),(y,-100,100),fill=False,cmap="twilight",labels=True,label_inline=True,linewidths=1,contours=c,label_fmt="%1.0f",gridlines=True,plot_points=100,tick_formatter=(ticker.NullFormatter(),
            ticker.NullFormatter()))
            plot2+=arrow((-90,-90),(-80,-90),color="black",arrowsize=2)+arrow((-90,-90),(-90,-80),color="black",arrowsize=2)
            plot2+=arrow((-90,-90),(-100,-90),color="black",arrowsize=2)+arrow((-90,-90),(-90,-100),color="black",arrowsize=2)
            plot2+=text("N",(-90,-75),color="black")+text("S",(-90,-105),color="black")
            plot2+=text("E",(-75,-90),color="black")+text("W",(-105,-90),color="black")
            plot2+=text("A",(0,15),color="red",zorder=5)
            plot2+=text("B",(50,-30),color="red",zorder=5)
            plot2+=text("C",(60,65),color="red",zorder=5)
            plot2
          </sageplot>
        </image>
      </introduction>
      <task>
        <statement>
          <p>
            Using the contour plot and treating the elevation as a multivariable function <m>h(x,y)</m>, state whether each of the following is positive, negative, or zero. Write a sentence to justify your reasoning.
            <ol marker="i." cols="3">
              <li><m>h_x(A)</m></li>
              <li><m>h_y(A)</m></li>
              <li><m>h_x(B)</m></li>
              <li><m>h_y(B)</m></li>
              <li><m>h_x(C)</m></li>
              <li><m>h_y(C)</m></li>
            </ol>  
          </p>
        </statement>
      </task>
      <task>
        <statement>
          <p>
            Suppose you are standing at point <m>B</m>. Do you expect the elevation to increase, decrease, or remain constant if you take a step in the northeast direction? Write a sentence to explain your reasoning.
          </p>
        </statement>
      </task>
       <task>
        <statement>
          <p>
            Suppose you are standing at point <m>B</m>. Do you expect the elevation to increase, decrease, or remain constant if you take a step in the southeast direction? Write a sentence to explain your reasoning.
          </p>
        </statement>
      </task>
       <task>
        <statement>
          <p>
            Suppose you are standing at point <m>A</m>. Do you expect the elevation to increase, decrease, or remain constant if you take a step in the southwestdirection? Write a sentence to explain your reasoning.
          </p>
        </statement>
      </task>
      <task>
        <statement>
          <p>
            Suppose you are standing at point <m>C</m>. In what direction would you take a step to move in the steepest downhill direction? Write a sentence to explain your reasoning.
          </p>
        </statement>
      </task>
      <task>
        <statement>
          <p>
            Suppose you are standing at point <m>A</m>. In what direction would you take a step to move in the steepest uphill direction? Write a sentence to explain your reasoning.
          </p>
        </statement>
      </task>
      <task>
        <statement>
          <p>
            Suppose you are standing at point <m>B</m>. Rank the following directions in order of steepness (from most steep and uphill to level to most steep downhill): northeast, north, east, west, south
          </p>
        </statement>
      </task>
    </exploration>
</worksheet>
    <p>
      The Preview Activity demonstrates how visual information such as a contour plot or a surface plot can be helpful in determining information about how quickly the output of a function changes as its inputs change in different directions. In this section, we will focus on how to calculate this kind of directional derivative using algebraic or numerical representations of functions and relate this calculation to other ways we have described change for a function. 
    </p>
    
  </subsection>

  <subsection>
    <title>Directional Derivatives</title>
    <p>
      We begin by determining how to measure the rate of change for a function of two variables in a direction that is not parallel to one of the coordinate directions. We use the classic calculus approach to set up this measurement: approximate the measurement, quantify how the approximation changes on a smaller scale, and finally use a limit to find the value. To measure the rate of change in the output of a function, we use a difference quotient:
      <me>
        \text{rate of change} = \frac{\text{change in output}}{\text{change in input}}
      </me>.
    </p>
    <p>
      Let <m>f</m> be a function of the variables <m>x</m> and <m>y</m>. We wish to measure the rate of change of <m>f</m> at the base point <m>(x_0,y_0)</m> in the direction of the vector <m>\langle a,b\rangle</m>. To do this, we write the difference quotient using the points <m>(x_0+a,y_0+b)</m> and <m>(x_0,y_0</m>):
      <me>\frac{f(x_0+a,y_0+b)-f(x_0,y_0)}{\sqrt{a^2+b^2}}</me>.
      The denominator comes from using the distance formula to measure the change in the input as distance in the <m>xy</m>-plane. <xref ref="CCA-DD1" /> shows the plot of a surface given by <m>z=f(x,y)</m> with the points used in the difference quotient labeled.
    </p>
    <figure xml:id="CCA-DD1">
      <caption>A plot of <m>f(x,y)</m> with the measurements of change in input and output labeled for a change of inputs given by <m>\langle a,b\rangle</m></caption>
      <interactive label="interactive-CCA-DD1" platform="sage" width="91%" aspect="1:1">
        <slate surface="sage">
          <xi:include href="interacts/CCA-DD1.txt" parse="text" />
        </slate>
      </interactive>
    </figure>
    <p>
      The difference quotient above is the first step in the classic calculus approach and provides a good start to approximating the rate of change for the output of <m>f</m> in the direction <m>\langle a,b\rangle</m>. However, it is not clear how this approximation changes when we look at smaller scales. Specifically, we need to look at what happens to this approximation as we shrink the step size <m>\sqrt{a^2+b^2}</m> to <m>0</m> while maintaining the same direction of change. In order to maintain our direction <em>and</em> look at smaller step sizes, we must separate the length of the vector <m>\langle a,b \rangle </m> from its direction. To do this, we use the unit vector in the direction of <m>\langle a,b \rangle</m>.
    </p>
    <p>
      Let <m>\vu=\langle u_1,u_2\rangle </m> be the unit vector in the same direction as <m>\langle a,b \rangle</m>. Vectors in the same direction as <m>\langle a,b \rangle</m> can be written in the form <m> t \langle u_1,u_2\rangle</m>, where <m>t</m> is the step size and <m>\vu=\langle u_1,u_2\rangle </m> is the unit vector. Taking a step of length <m>t</m> in the direction <m>\langle u_1,u_2 \rangle</m>, the difference quotient can be written as
      <me>\frac{f(x_0+t (u_1),y_0+t(u_2))-f(x_0,y_0)}{t}</me>.
      We will look at how this difference quotient changes at smaller scales, i.e., when the step size <m>t</m> gets smaller. This accomplishes the second step of the classic calculus approach because it quantifyies how the approximation works on smaller scales. We can now take the limit as <m>t \to 0</m> to define the directional derivative.
    </p>
    <definition xml:id="defn-DD">
      <statement>
        <p>
          Let <m>f(x,y)</m> be a function of two variables. The <term>derivative of <m>f</m> at the point <m>(x,y)</m> in the direction of the unit vector <m>\vu = \langle u_1, u_2 \rangle</m></term><idx><h>directional derivative</h></idx> is denoted <m>D_{\vu}f(x,y)</m> and is given by
          <men xml:id="E_DirDerDef">
            D_{\vu}f(x,y) = \lim_{t \to 0} \frac{f(x+u_1 t, y+u_2 t) - f(x,y)}{t}
          </men>
          for those values of <m>x</m> and <m>y</m> for which the limit exists. 
        </p>
      </statement>
    </definition>
    <p>
      The notation <m>D_{\vu}f(x,y)</m> can also be read as <q>the directional derivative of <m>f</m> in the direction <m>\vu</m> at the point <m>(x,y)</m>.</q> While this may seem like a mouthful, each piece of this phrase is necessary to specify a directional derivative: we must specify the function, the location at which to measure the rate of change, <em>and</em> the direction in which the inputs change. When we evaluate the directional derivative <m>D_{\vu} f(x,y)</m> at a point <m>(x_0, y_0)</m>, the result <m>D_{\vu} f(x_0,y_0)</m> tells us the instantaneous rate at which <m>f</m> changes at <m>(x_0, y_0)</m> per unit increase in the direction of the vector <m>\vu</m>.
    </p>
    <p>
      We can connect <xref ref="E_DirDerDef">equation</xref> to our work on traces earlier in this chapter. When initially exploring surface plots, we simplified our approach by looking at slices that were parallel to one of the coordinate axes, obtained by holding the other input variable constant. This allowed us to use ideas from single-variable calculus to understand more about the surface and to motivate the definitions of partial derivatives. Similarly, we can cut the surface in the <m>\langle u_1,u_2\rangle </m> direction through the base point and then think about the directional derivative as a single-variable calculus problem. In particular, we can parameterize the trace along the surface by noticing our inputs correspond to the line in the xy-plane given by <m>\langle x_0+ u_1 t, y_0 + u_2 t\rangle</m>, which is shown in red on <xref ref="CCA-DD2"/>. 
    </p>
    <figure xml:id="CCA-DD2">
      <caption>A plot of <m>f(x,y)</m> with a trace shown from the point <m>(x_0,y_0)</m> in the direction <m>\langle u_1,u_2 \rangle</m></caption>
      <interactive label="interactive-CCA-DD2" platform="sage" width="91%" aspect="1:1">
        <slate surface="sage">
          <xi:include href="interacts/CCA-DD2.txt" parse="text" />
        </slate>
      </interactive>
    </figure>
    <p>
      When <m>t=0</m>, the location is <m>(x_0,y_0)</m>. The trace along the surface is given by <m>\vr(t)=\langle x_0+ u_1 t, y_0 + u_2 t , f(x_0+ u_1 t, y_0 + u_2 t) \rangle</m>. This trace is shown in blue in <xref ref="CCA-DD2"/>. We can also plot the trace of this surface in the direction of <m>\langle u_1,u_2 \rangle</m> as a function of <m>t</m> using a two-dimensional plot. This plot is shown in <xref ref="CCA-DD3"/>. We can visualize the directional derivative as the slope of a tangent line at the base point. This tangent line is drawn in black on <xref ref="CCA-DD3"/>. The scalar <m>D_{\vu} f(x_0,y_0)</m> tells us the slope of the line tangent to the surface in the direction of <m>\vu</m> at the point <m>(x_0,y_0,f(x_0,y_0))</m>. 
    </p>
    <figure xml:id="CCA-DD3">
      <caption>A plot of the trace of <m>f</m> along the direction <m>\langle u_1,u_2\rangle</m> with tangent line drawn at point corresponding to <m>(x_0,y_0)</m></caption>
      <image width="60%" >
        <shortdescription>A curve with a tangent line</shortdescription>
        <description>
          <p>A two-dimensional plot of the trace <m>f(x_0+tu_1,y_0+tu_2)</m> with the horizontal axis labeled <m>t</m>. A tangent line to the trace is also shown.
          </p>
        </description>
        <sageplot label="img-PA-DDcontour3">
          from matplotlib import ticker
          var('x,y,z,t,s')
          f(x,y)=3*exp(-(x-1/2)^2/2-y^2/4)-1
          a=2/3;b=1/3 ;x0=1/2;y0=1;
          fx=diff(f,x);fy=diff(f,y);
          fxv=fx(x=x0,y=y0);fyv=fy(x=x0,y=y0);
          plot4=plot(f(x0+a*t,y0+b*t),(t,0,2),color="blue",axes_labels=["$t$","$f(x_0+t u_1,y_0+t u_2)$"],thickness=2,gridlines=True,ymin=0,ymax=2,aspect_ratio=1,tick_formatter=(ticker.NullFormatter(),
          ticker.NullFormatter()))
          plot4+=parametric_plot((t,f(x0,y0)+a*fxv*t+b*fyv*t),(t,0,1/2),color="black",thickness=2)
          plot4
        </sageplot>
      </image>
    </figure>
  </subsection>

  <subsection>
    <title>Efficiently Computing the Directional Derivative</title>
    <p>
      We want to find a way to evaluate directional derivatives without resorting to evaluating the limit definition in <xref ref="E_DirDerDef">equation</xref> every time. We will look at this algebraic approach from two perspectives. First, we will use the chain rule from <xref ref="S_mv_deriv-chain_rule"/> to define a simple algebraic rule which will allow us to efficiently calculate directional derivatives. Second, we will use the linearization of a locally linear function to compute directional derivatives.
    </p>
    <p>
      We are interested in the instantaneous rate of change of <m>f</m> at a point <m>(x_0,y_0)</m> in the direction of a unit vector <m>\vu = \langle u_1, u_2 \rangle</m>. In particular, the input variables <m>x</m> and <m>y</m> are changing according to
      <me>
        x = x_0 + u_1t \quad \text{ and }  \quad y = y_0 + u_2t
      </me>.
      A trace along the surface in the direction of <m>\langle u_1,u_2\rangle</m> is given by <m>\vr(t)=\langle x_0+ u_1 t, y_0 + u_2 t , f(x_0+ u_1 t, y_0 + u_2 t) \rangle</m>. Observe that <m>\frac{dx}{dt} = u_1</m> and <m>\frac{dy}{dt} = u_2</m> for all values of <m>t</m>. Since <m>\vu</m> is a unit vector in the <m>xy</m>-plane, a unit change in the parameter <m>t</m> corresponds to moving one unit in the <m>\vu</m> direction. This allows us to use the multivariable chain rule to calculate the directional derivative as a measure of the instantaneous rate of change of <m>f</m> in the direction <m>\vu</m>.
    </p>
    <p>
      The output of <m>f</m> along the given direction can be written as a composition of functions, <m>f(t)=f(\vr(t))=f(x(t), y(t))</m>, which means we can apply the multivariable chain rule:
      <md>
        <mrow>D_{\vu}f(x_0,y_0) \amp = \frac{d}{dt}\left[ f(\vr(t)) \right] </mrow>
        <mrow> \amp = f_x(x_0,y_0)\frac{dx}{dt} + f_y(x_0,y_0)\frac{dy}{dt} </mrow>
        <mrow> \amp = f_x(x_0,y_0) u_1 + f_y(x_0,y_0) u_2 </mrow>
      </md>
      This allows us to compute the directional derivative at an arbitrary point according to the following formula.
    </p>

    <theorem xml:id="Directional-derivative">
      <title>Calculating Directional Derivatives</title>
      <p>
        Given a differentiable function <m>f = f(x,y)</m> and a unit vector <m>\vu = \langle u_1, u_2 \rangle</m>, the directional derivative <m>D_{\vu}f(x,y)</m> can be computed by
        <men xml:id="eq_mv_deriv-directional-DD">
          D_{\vu}f(x,y) = f_x(x,y) u_1 + f_y(x,y) u_2
        </men>.
      </p>
    </theorem>
    <p>
      To use <xref ref="eq_mv_deriv-directional-DD">equation</xref>, we must have a <em>unit</em> vector <m>\vu = \langle u_1, u_2 \rangle</m> in the direction of motion. In the event that we have a direction prescribed by a non-unit vector, we must first scale the vector to have length 1. 
    </p>
    <example>
      <p>
        We will look at an example that is algebraically and geometrically simple but allows us to use <xref ref="Directional-derivative"/>. We will consider the rate of change for the function <m>f(x,y)=2.5-\frac{(x-1)^2}{2}-\frac{(y+1)^2}{9}</m> at the input point <m>(2,2)</m> in several directions. Because <m>f(2,2)=2.5-\frac{(2-1)^2}{2}-\frac{(2-2)^2}{9}=2.5-0.5-1=1</m>, this point lies on the level curve with value <m>1</m> as shown in <xref ref="DDexample1"/>.
      </p>
      <figure xml:id="DDexample1">
        <caption>A contour plot of <m>f(x,y)=2.5-\frac{(x-1)^2}{2}-\frac{(y+1)^2}{9}</m> with the point <m>(2,2)</m> highlighted</caption>
        <image width="60%">
          <shortdescription>A contour plot</shortdescription>
          <description>
            <p>A contour plot that shows several concentric ellipses. The point <m>(2,2)</m> is marked as is a vector pointing left and up from this point.
            </p>
          </description>
          <sageplot label="img-DDexample1">
            var('x,y,z,t,s')
            f(x,y)=2.5-(x-1)^2/2-(y+1)^2/9
            plot7=contour_plot(f(x,y),(x,-2,4),(y,-4,4),aspect_ratio=1,labels=True,label_fmt="%1.0f",gridlines=True,label_inline=True,label_inline_spacing=5,fill=True)
            plot7+=arrow((2,2),(2-2/sqrt(5),2+1/sqrt(5)),color="red")
            plot7+=point((2,2),size=30,zorder=10,color="black")
            plot7
          </sageplot>
        </image>
      </figure>
      <p>
        We will compute the directional derivative of <m>f</m> at the point <m>(2,2)</m> in the direction of <m>\langle-2,-1\rangle</m>. Since <m>\langle-2,1\rangle</m> is not a unit vector, we use <m>\vu=\frac{1}{\sqrt{5}}\langle -2,1\rangle</m> as the unit vector in this direction. To use <xref ref="eq_mv_deriv-directional-DD">equation</xref>, we will need the partial derivatives of <m>f</m>:
        <me> f_x= -\frac{2(x-1)}{2} \quad \text{ and } \quad f_y=-\frac{2(y+1)}{9} </me>
        At <m>(2,2)</m>, we have <m>f_x(2,2)=-1</m> and <m>f_y(2,2)=-\frac{2}{3}</m>. By <xref ref="eq_mv_deriv-directional-DD">equation</xref>, the directional derivative of <m>f</m> at <m>(2,2)</m> in the direction <m>\vu</m> is
        <me>Df_\vu (2,2)=f_x(2,2) u_1 + f_y(2,2) u_2 = (-1)(-\frac{2}{\sqrt{5}})+\left(-\frac{2}{3}\right)(\frac{1}{\sqrt{5}})=\frac{4}{3\sqrt{5}} </me>.
        We can interpret this as saying that for a small step in the direction of <m>\vu</m> at <m>(2,2)</m>, we would expect the output of <m>f</m> to increase by <m>\frac{4}{3\sqrt{5}}</m> times the step size.
      </p>
      <p>
        This may be a bit difficult to see based on the contour plot in <xref ref="DDexample1"/>. However, the surface plot combined with a plot of the path of inputs in the direction <m>\vu</m> gives a better visualization. <xref ref="DDexample2"/> shows a surface plot of <m>z=f(x,y)</m> with the trace in the <m>\vu</m>-direction shown in blue and the direction vector <m>\vu</m> shown in red on the <m>xy</m>-plane. The black line segment shows how <m>Df_\vu(2,2)</m> is positive because the <m>z</m>-coordinate of this tangent line increases as we move away from <m>(2,2)</m> in the <m>\vu</m>-direction.
      </p>
      <figure xml:id="DDexample2">
      <caption>A plot of <m>z=f(x,y)</m> with trace in the direction <m>\vu</m> through <m>(2,2,1)</m> shown including the tangent line</caption>
        <interactive label="interactive-DDexample2" platform="sage" width="91%" aspect="1:1">
          <slate surface="sage">
            <xi:include href="interacts/DDexample2.txt" parse="text" />
          </slate>
        </interactive>
      </figure>
      <p>  
        Remember that the directional derivative is a local measurement and only applies in a small neighborhood of a point and only in the direction <m>\vu</m>. In other words, <m>Df_\vu(2,2)</m> does not describe the the rate of change at other points along the blue curve, only the rate of change along the blue curve for a small step away from our base point in the red direction. With plots like <xref ref="DDexample1"/>, you may be tempted to use information far away from the point of interest to try to figure out the rate of change. However, like most calculus measurements, we must only use plots to provide information on what is happening near a specific point. 
      </p>
      <p>
        If we compute <m>Df_\vj(2,2)</m>, the rate of change for the output of <m>f</m> in the direction <m>\vj=\langle 0,1\rangle</m> at <m>(2,2)</m>, using <xref ref="eq_mv_deriv-directional-DD">equation</xref>, then we have
        <me>Df_\vj (2,2)=f_x(2,2) u_1+f_y(2,2) u_2=(-1)(0)+(-\frac{2}{3})(1)=-\frac{2}{3} </me>.
        This corresponds to the partial derivative of <m>f</m> with respect to <m>y</m>.
      </p>
      <p>
        <xref ref="DDexample3"/> allows you to adjust the direction of the trace shown. By default, it shows the direction vector <m>\vj</m>, the cooresponding trace, and tangent line to the surface in the <m>\vj</m> direction. Use the slider at the top of <xref ref="DDexample3"/> to change the direction in which you want to evaluate the directional derivative. As you do so, examine how the steepness of the black tangent segment varies depending on the direction. 
      </p>
      <figure xml:id="DDexample3">
      <caption>An intereactive plot of <m>z=f(x,y)</m> with trace in the direction <m>\vu</m> through (2,2,1) shown including the tangent line</caption>
        <interactive title="interactive-DDexample3" platform="sage" width="100%" aspect="1:1">
          <slate surface="sage">
            <xi:include href="interacts/DDexample3.txt" parse="text" />
          </slate>
        </interactive>
      </figure>
    </example>
    <p>
      In the following activity, we use algebraic techniques to calculate and interpret the of directional derivative of a function.
    </p>
    <worksheet>
  <activity workspace="1.5in" xml:id="act-mv_deriv-directional-algebraic">
      <introduction>
        <p>
          In this activity, we will use <xref ref="eq_mv_deriv-directional-DD">equation</xref> to calculate and interpret directional derivatives for the function <m>f(x,y) = 3xy-x^2y^3</m>.
        </p>
      </introduction>
      <task>
        <statement>
          <p>
            Calculate <m>f_x(x,y)</m> and <m>f_y(x,y)</m>.
          </p>
        </statement>
        <answer>
          <p>
            <me>
              \frac{\partial f}{\partial x} = 3y-2xy^3 \ \ \text{ and }  \ \ \frac{\partial f}{\partial y} = 3x - 3x^2y^2
            </me>
          </p>
        </answer>
        <solution>
          <p>
            <me>
              \frac{\partial f}{\partial x} = 3y-2xy^3 \ \ \text{ and }  \ \ \frac{\partial f}{\partial y} = 3x - 3x^2y^2
            </me>
          </p>
        </solution>
      </task>
      <task>
        <statement>
          <p>
            Use <xref ref="eq_mv_deriv-directional-DD">equation</xref> to determine <m>D_{\vi} f(x,y)</m> and <m>D_{\vj} f(x,y)</m>. Write a couple of sentences to describe what familiar functions <m>D_{\vi} f</m> and <m>D_{\vj} f</m> are. 
          </p>
        </statement>
        <hint>
          <p>
            Remember that <m>\vi</m> is the unit vector in the positive <m>x</m>-direction and <m>\vj</m> is the unit vector in the positive <m>y</m>-direction.
          </p>
        </hint>
        <answer>
          <p>
            <me>
                D_{\vi}f(x,y) = f_x(x,y)
              </me>,
              <me>
                D_{\vj}f(x,y) = f_y(x,y)
              </me>
          </p>
        </answer>
        <solution>
          <p>
            Since <m>\vi = \langle 1, 0 \rangle</m>, we have
            <me>
              D_{\vi}f(x,y) = f_x(x,y)(1) + f_y(x,y)(0) = f_x(x,y)
            </me>.
            So the derivative of <m>f</m> in the direction of the vector <m>\vi</m> is just the partial derivative of <m>f</m> with respect to <m>x</m>. Similarly,
            <me>
              D_{\vj}f(x,y) = f_x(x,y)(0) + f_y(x,y)(1) = f_y(x,y)
            </me>.
            So the derivative of <m>f</m> in the direction of the vector <m>\vj</m> is just the partial derivative of <m>f</m> with respect to <m>y</m>.
          </p>
        </solution>
      </task>
      <task>
        <statement>
          <p>
            Use <xref ref="eq_mv_deriv-directional-DD">equation</xref> to find the derivative of <m>f</m> in the direction of the vector <m>\vv = \langle 2, 3 \rangle</m> at the point <m>(1,-1)</m>.  
          </p>
        </statement>
        <hint>
          <p>
            Remember that a <em>unit</em> direction vector is needed.
          </p>
        </hint>
        <answer>
          <p>
            <me>
                D_{\vv}f(1,-1) = -\frac{2}{\sqrt{13}}
              </me>
          </p>
        </answer>
        <solution>
          <p>
            At the point <m>(1,-1)</m> we have
              <me>
                f_x(1,-1) = -1 \ \ \text{ and }  \ \ f_y(1,-1) = 0
              </me>.
              So the derivative of <m>f</m> in the direction of the unit vector
              <m>\frac{1}{|\vv|} \vv = \frac{1}{\sqrt{13}}\langle 2, 3 \rangle</m> at the point <m>(1,-1)</m> is
              <me>
                D_{\vv}f(1,-1) = f_x(1,-1) \left(\frac{2}{\sqrt{13}}\right) + f_y(1,-1) \left(\frac{3}{\sqrt{13}}\right) = -\frac{2}{\sqrt{13}}
              </me>
          </p>
        </solution>
      </task>
      <task>
        <statement>
          <p>
            Find the derivative of <m>f</m> in the direction of the vector <m>\vv = \langle 4, 6 \rangle</m> at the point <m>(1,-1)</m>.           
          </p>
        </statement>
         <answer>
          <p>
            <me>
                D_{\vv}f(1,-1) = -\frac{2}{\sqrt{13}}
              </me>
          </p>
        </answer>
        <solution>
          <p>
            At the point <m>(1,-1)</m> we have
            <me>
              f_x(1,-1) = -1 \ \ \text{ and }  \ \ f_y(1,-1) = 0
            </me>.
            So the derivative of <m>f</m> in the direction of the unit vector
            <m>\frac{1}{|\vv|} \vv = \frac{1}{2\sqrt{13}}\langle 4,63 \rangle</m> at the point <m>(1,-1)</m> is
            <me>
              D_{\vv}f(1,-1) = f_x(1,-1) \left(\frac{2}{2\sqrt{13}}\right) + f_y(1,-1) \left(\frac{3}{2\sqrt{13}}\right) = -\frac{2}{2\sqrt{13}}
            </me>
            The result is the same as the previous task because the unit vector in the given direction is the same.
          </p>
        </solution>
      </task>
      <task>
        <statement>
          <p>
            Use <xref ref="eq_mv_deriv-directional-DD">equation</xref> to find the derivative of <m>f</m> in the direction of the vector <m>\vv = \langle -2, -3 \rangle</m> at the point <m>(1,-1)</m>. Write a couple of sentences to explain why this result is different from your answer to the previous two tasks, even though the direction vectors are parallel.
          </p>
        </statement>
         <answer>
          <p>
            <me>
                D_{\vv}f(1,-1) = \frac{2}{\sqrt{13}}
              </me>
          </p>
        </answer>
        <solution>
          <p>
            At the point <m>(1,-1)</m> we have
            <me>
              f_x(1,-1) = -1 \ \ \text{ and }  \ \ f_y(1,-1) = 0
            </me>.
            So the derivative of <m>f</m> in the direction of the unit vector
            <m>\frac{1}{|\vv|} \vv = \frac{1}{\sqrt{13}}\langle -2, -3 \rangle</m> at the point <m>(1,-1)</m> is
            <me>
              D_{\vv}f(1,-1) = f_x(1,-1) \left(\frac{-2}{\sqrt{13}}\right) + f_y(1,-1) \left(\frac{-3}{\sqrt{13}}\right) = \frac{2}{\sqrt{13}}
            </me>
            Because our direction vector is in the opposite direction, we ended up with a directional derivative having the same magnitude but a positive value. This makes sense because if we were going down the surface in the direction <m>\langle 2, 3 \rangle</m>, then the surface is going up in exactly the same way in the direction <m>\langle -2, -3 \rangle</m>. 
          </p>
        </solution>
      </task>    
    </activity>
</worksheet>
    <p>
      <xref ref="eq_mv_deriv-directional-DD">Equation</xref> arose through consideration of the <xref ref="defn-DD" text="custom">definition for the directional derivative</xref> as a composition of functions and application of the chain rule. When considering multivariable functions that are locally linear, recall that we can evaluate the limit of such a function near a point by analyzing the linearization or tangent plane. On a small scale, there is virtually no difference between the locally linear function and the linearization as demonstrated by <xref ref="fig-mv_deriv-linearization-tangent_4"/>. 
    </p>
    <p>
      The equation of the plane tangent to the graph of <m>f</m> at the point <m>(x_0,y_0,f(x_0,y_0))</m> is
      <me>
        z = f(x_0,y_0) + f_x(x_0,y_0)(x-x_0) + f_y(x_0,y_0)(y-y_0)
      </me>.
      If <m>f</m> is a locally linear function, then the directional derivative <m>D_{\vu}f(x_0,y_0)</m> is the same as the rate of change along the tangent plane in the direction of <m>\vu</m>. This is convenient because on the tangent plane, the rate of change is the same regardless of step size, a fact that is <em>not</em> true on the original surface <m>z=f(x,y)</m>. We now consider the quotient
      <md>
        <mrow>\amp\frac{z(x_0+u_1,y_0+u_2)-z(x_0,y_0)}{\sqrt{u_1^2+u_2^2}}</mrow>
        <mrow>\amp=\frac{\left(f(x_0,y_0) + f_x(x_0,y_0)(x_0+u_1-x_0) + f_y(x_0,y_0)(y_0+u_2-y_0)\right)-f(x_0,y_0)}{1}</mrow>
        <mrow>\amp= f_x(x_0,y_0) (u_1) + f_y(x_0,y_0)(u_2)</mrow>
      </md>,
      which is exactly the result in <xref ref="eq_mv_deriv-directional-DD">equation</xref>. 
    </p>
  </subsection>
  <subsection xml:id="gradient_ss">
    <title>The Gradient</title>
    <p>
      We have used the chain rule and linearization to see see that the instantaneous rate of change a function <m>f = f(x,y)</m> in the direction of a unit vector <m>\vu = \langle u_1, u_2 \rangle</m> is given by
      <men xml:id="E_DDrevisited">
        D_{\vu}f(x_0,y_0) = f_x(x_0,y_0)u_1 + f_y(x_0,y_0)u_2
      </men>.
      You may recognize the form of <xref ref="E_DDrevisited"/> as being similar to a dot product. We can also view this equation as stating that the rate of change along the linearization in a given direction can be expressed as a linear combination of the rates of change in the coordinate directions by using partial derivatives with the weight of each partial derivative specified by the components of the unit vector <m>\vu</m>. 
    </p>
    <p>
      We can think about <nbsp/><xref ref="E_DDrevisited">equation</xref> in a way that will have geometric meaning related to the dot product. The directional derivative <m>D_{\vu}f(x_0,y_0)</m> is the dot product of <m>\left\langle f_x(x_0,y_0), f_y(x_0,y_0) \right\rangle</m> and <m>\vu=\langle u_1,u_2\rangle</m>. Notice that the vector <m>\left\langle f_x(x_0,y_0), f_y(x_0,y_0) \right\rangle</m> comes from simple calculations that tell us how the function <m>f</m> is changing near the input <m>(x_0,y_0)</m>.
    </p>
    <definition xml:id="def-gradient">
      <statement>
        <p>
          The <term>gradient</term> of <m>f</m> is vector formed by partial derivatives of <m>f</m>. The gradient of <m>f</m> is denoted 
          <me>
            \nabla f(x_0,y_0) = \left\langle f_x(x_0,y_0), f_y(x_0,y_0) \right\rangle
          </me>.
        </p>
      </statement>
    </definition>
    <p>
      We read <m>\nabla f</m> as <q>the gradient of <m>f</m>,</q> <q>grad <m>f</m></q> or <q>del <m>f</m></q>.<fn>The symbol <m>\nabla</m> is called <term>nabla</term>, which comes from a Greek word for a certain type of harp that has a similar shape.</fn>
      Notice that <m>\nabla f</m> varies from point to point, and also provides an alternate formulation of the directional derivative.
    </p>
    <proposition xml:id="Directional-derivative-gradient">
      <title>The Directional Derivative and the Gradient</title>
      <p>
        Given a differentiable function <m>f = f(x,y)</m> and a unit vector <m>\vu = \langle u_1, u_2 \rangle</m>, we may compute <m>D_{\vu}f(x,y)</m> by
        <men xml:id="eq_mv_deriv_DD_grad">
          D_{\vu}f(x,y) = \nabla f(x,y) \cdot \vu.
        </men>
      </p>
    </proposition>
    <p>
     In the following activity, we investigate some of what the gradient tells us about the behavior of a function <m>f</m>.
    </p>
    <worksheet>
  <activity workspace="1.5in" xml:id="A_10_6_10">
      <introduction>
        <p>
          Let <m>f(x,y) = \frac{1}{3}(x^2-y^2)</m>. Some contours for this function are shown in <xref ref="CCA-DD4">Figure</xref>.
        </p>
        <!-- <figure xml:id="F_10_6_activity_1">
          <caption>Contours of <m>f(x,y) = x^2 - y^2</m>.</caption>
          <image width="50%" source="images/fig_10_6_contours_1"/>
        </figure> -->
        <figure xml:id="CCA-DD4">
          <caption>A contour plot of <m>f(x,y)=\frac{1}{3}(x^2-y^2)</m></caption>
          <image width="60%">
            <shortdescription>A contour plot</shortdescription>
            <description>
              <p>A contour plot
              </p>
            </description>
            <sageplot label="img-DDcontour4">
              var('x,y,z,t,s')
              f(x,y)=1/3*(x^2-y^2)
              c=[i for i in range(-4,5)]
              plot5=contour_plot(f(x,y),(x,-4,4),(y,-4,4),fill=False,contours=c,labels=True,label_fmt="%1.0f",gridlines=True,label_inline=True,label_inline_spacing=5)
              plot5
            </sageplot>
          </image>
        </figure>
      </introduction>
      <task>
        <statement>
          <p>
            Find the gradient <m>\nabla f (x,y)</m>.
          </p>
        </statement>
        <answer>
          <p>
            <me>
              \nabla f (x,y) = \langle 2x, -2y \rangle
            </me>
          </p>
        </answer>
        <solution>
          <p>
            By definition,
            <me>
              \nabla f (x,y) = \langle f_x(x,y), f_y(x,y) \rangle = \langle 2x, -2y \rangle
            </me>
          </p>
        </solution>
      </task>
      <task>
        <statement>
          <p>
            For each of the following points <m>(x_0,y_0)</m>, evaluate the gradient <m>\nabla f(x_0,y_0)</m> and sketch the gradient vector with its tail at <m>(x_0,y_0)</m>.  Some of the vectors are too long to fit onto the plot. To draw them to scale, you should scale each vector by a factor of <m>1/2</m>.
              <ul cols="3">
                <li> <m>(x_0,y_0) = (2,0)</m> </li>
                <li> <m>(x_0,y_0) = (0,2)</m> </li>
                <li> <m>(x_0,y_0) = (2,2)</m> </li>
                <li> <m>(x_0,y_0) = (2,1)</m> </li>
                <li> <m>(x_0,y_0) = (-3,2)</m> </li>
                <li> <m>(x_0,y_0) = (-2,-4)</m> </li>
                <li> <m>(x_0,y_0) = (0,0)</m> </li>
              </ul>
          </p>
        </statement>
        <answer>
          <p>
            <md>
              <mrow>\nabla f(2,0) \amp = \langle 4,0 \rangle</mrow>
              <mrow>\nabla f(0,2) \amp = \langle 0,-4 \rangle</mrow>
              <mrow>\nabla f(2,2) \amp = \langle 4,-4 \rangle</mrow>
              <mrow>\nabla f(2,1) \amp = \langle 4,-2 \rangle</mrow>
              <mrow>\nabla f(-3,2) \amp = \langle -3,-4 \rangle</mrow>
              <mrow>\nabla f(-2,-4) \amp = \langle -4,8 \rangle</mrow>
              <mrow>\nabla f (0,0) \amp = \langle 0,0 \rangle</mrow>
            </md>
            A picture of the scaled gradients are shown here.
          </p>
          <image width="73%" source="images/fig_10_6_Act_10_contours"/>
        </answer>
        <solution>
          <p>
          <md>
              <mrow>\nabla f(2,0) \amp = \langle 4,0 \rangle</mrow>
              <mrow>\nabla f(0,2) \amp = \langle 0,-4 \rangle</mrow>
              <mrow>\nabla f(2,2) \amp = \langle 4,-4 \rangle</mrow>
              <mrow>\nabla f(2,1) \amp = \langle 4,-2 \rangle</mrow>
              <mrow>\nabla f(-3,2) \amp = \langle -3,-4 \rangle</mrow>
              <mrow>\nabla f(-2,-4) \amp = \langle -4,8 \rangle</mrow>
              <mrow>\nabla f (0,0) \amp = \langle 0,0 \rangle</mrow>
            </md>
            A picture of the scaled gradients are shown here.
          </p>
          <image width="73%" source="images/fig_10_6_Act_10_contours"/>
        </solution>
      </task>
      <task>
        <statement>
          <p>
            Write a few sentences about how the direction of the gradient at each of these points is related to the the contour passing through that point.
          </p>
        </statement>
        <answer>
          <p>
            It appears that each gradient is orthogonal to the contour containing its tail.
          </p>
        </answer>
        <solution>
          <p>
            It appears that each gradient is orthogonal to the contour containing its tail.
          </p>
        </solution>
      </task>  
      <task>
        <statement>
          <p>
            Does the output of <m>f</m> increase or decrease in the direction of <m>\nabla f(x_0,y_0)</m>? Use examples from the points above to write a couple of sentences that justify your answer. 
          </p>
        </statement>
        <hint>
          <p>
            You may wish to think about the contour plot as a topographical map and whether your elevation would increase or decrease if you took a step in the direction of the gradient.
          </p>
        </hint>
        <answer>
          <p>
            The gradient points in the direction of increase for <m>f</m>.
          </p>
        </answer>
        <solution>
          <p>
            In the first quadrant, as <m>x</m> increases so does <m>f(x,y)</m>. So these gradients all point in a direction of increase of <m>f</m>. In the second quadrant, as <m>x</m> decreases <m>f(x,y)</m> increases. So these gradients all point in a direction of increase of <m>f</m>. In the third quadrant, as <m>y</m> increases so does <m>f(x,y)</m>. So these gradients all point in a direction of increase of <m>f</m>. Finally, at the point <m>(0,2)</m>, <m>f</m> increases as <m>y</m> decreases. So every gradient points in a direction of increase of <m>f</m>.
          </p>
        </solution>
      </task>
    </activity>
</worksheet>
    <p>
      Because <m>\nabla f(x_0,y_0)</m> is a vector, we can consider its direction and length separately. The next subsection discusses the information conveyed by these geometetric aspects  about the behavior of <m>f</m> near <m>(x_0,y_0)</m>.
    </p>
  </subsection>
  <subsection xml:id="ss-vec-grad">
    <title>Vector Properties of the Gradient</title>
    <p>
      <xref ref="Directional-derivative-gradient"/> shows how we can separate the directional derivative of a function of two variables into two separate parts: the gradient vector evaluated at the point of interest and the unit vector in the direction we want to change the inputs of the function. Recall from <xref ref="eq-precalc-dot-angle">equation</xref> that the dot product of two vectors depends on the lengths of the vectors and the angle between the vectors. If <m>\theta</m> is the angle between <m>\nabla f(x_0,y_0)</m> and <m>\vu</m> (where <m>\vu</m> is a unit vector), then combining <xref ref="eq_mv_deriv_DD_grad"/> and <xref ref="eq-precalc-dot-angle"/> gives
      <md>
        <mrow>  D_{\vu}f(x_0,y_0) \amp= \nabla f(x_0,y_0)\cdot\vu </mrow>
        <mrow> \amp= \vecmag{\nabla f(x_0,y_0)} \vecmag{\vu} \cos(\theta) </mrow>
      </md>.
      Remember that <m>\vecmag{\vu}=1</m> because <m>\vu</m> is a unit vector. Hence, the directional derivative is the length of the gradient vector times the cosine of the angle between <m>\nabla f(x_0,y_0)</m> and <m>\vu</m>:
      <men xml:id="DD-vecprop">D_{\vu}f(x_0,y_0) =\vecmag{\nabla f(x_0,y_0)} \cos(\theta)</men>
      <xref ref="DD-vecprop">Equation</xref> will be <em>extremely</em> useful in interpreting the gradient geometrically.
    </p>
    <figure xml:id="fig-mv_deriv-directional-gradient_sign">
      <caption>The sign of <m>D_{\vu} f(x_0,y_0)</m> is determined by <m>\theta</m> </caption>
      <sidebyside widths="33% 33% 33%">
      <image source="images/fig_10_6_gradient_angle_1"/>
      <image source="images/fig_10_6_gradient_angle_2"/>
      <image source="images/fig_10_6_gradient_angle_3"/>
      </sidebyside>
    </figure>
    <p>
      Because the magnitude of a vector is always non-negative, the sign of a directional derivative depends on <m>\cos(\theta)</m>. <xref ref="fig-mv_deriv-directional-gradient_sign"/> graphically shows examples of the following statements (from left to right):
      <ul>
        <li>If the angle between the gradient and <m>\vu</m> is a right angle, then the directional derivative is zero. </li>
        <li>If the angle between the gradient and <m>\vu</m> is acute, then the directional derivative is positive. </li>
        <li>If the angle between the gradient and <m>\vu</m> is obtuse, then the directional derivative is negative. </li>
      </ul>
      The first statement explains why the gradient is perpendicular to the level curve through the point of interest. Because a level curve is the set of points for which the function has a particular output value, the output will not change along the level curve. Thus, the directional derivative in a direction tangent to the level curve must be zero. We can expand this explanation to the other statements as well. The output of <m>f</m> increases in any direction that makes an acute angle with the gradient vector and the output of <m>f</m> decreases in any direction that makes an obtuse angle with the gradient.
    </p>
    <worksheet>
      <activity>
        <introduction>
          <p>
            For this activity, we will look at the value of the directional derivative for temperature as a function of location. When looking at a plot of thermoclines (locations with the same temperature), you notice that your town is exactly on the thermocline labeled as 70 degrees, shown as the point <m>P</m> on <xref ref="thermocline"/>
          </p>
          <figure xml:id="thermocline">
            <caption>A plot of the thermocline corresponding to 70 degrees going through the point <m>P</m></caption>
            <image width="60%" xml:id="img-thermocline">
              <sageplot>
                var('t,x')
                plot50=point((1,1),color="black",size=50,axes=False) 
                plot50+=plot(x+0.25*sin(1-x)*cos(5*x+7),(0,1.8),color="black",thickness=2)
                d=0.1;a=.25;b=1.75;
                plot50+=arrow((a,b),(a+d,b),color="black",arrowsize=2)+arrow((a,b),(a-d,b),color="black",arrowsize=2)
                plot50+=arrow((a,b),(a,b+d),color="black",arrowsize=2)+arrow((a,b),(a,b-d),color="black",arrowsize=2)
                plot50+=text("N",(a,b+1.5*d),color="black")+text("S",(a,b-1.5*d),color="black")
                plot50+=text("E",(a+1.5*d,b),color="black")+text("W",(a-1.5*d,b),color="black")
                plot50+=text("70",(1.5,1.5),color="black",background_color="white")
                plot50+=text("70",(0.15,0.15),color="black",background_color="white")
                plot50+=text("60s",(0.5,1),color="black",background_color="white")
                plot50+=text("70s",(1.5,0.5),color="black",background_color="white")
                plot50+=text("60s",(1.5,1.8),color="black",background_color="white")
                plot50+=text("P",(1,1.1),color="black",fontsize=20)
                plot50+=arrow((1,1),(1.15,0.6),color="black",arrowsize=2)
                plot50                  
              </sageplot>
            </image>
          </figure>
        </introduction>
      <task>
        <statement>
          <p>
            Write a few sentences about why the gradient at <m>P</m> goes in the southeast direction and not the northwest (which is also perpendicular to the thermocline/ level curve at <m>P</m>).
          </p>
        </statement>
      </task>
      <task>
        <statement>
          <p>
            Draw a vector in each of the following directions starting at <m>P</m> and state whether the directional derivative will be positive/negative/0 in each of these directions. You should write a couple of sentences for each direction vector about how the sign of the directional derivative is related to the angle between the direction and the gradient vectors.
          </p>
          <p>
            <ol>
              <li>
                <p>
                  West
                </p>
              </li>
              <li>
                <p>
                  South
                </p>
              </li>
              <li>
                <p>
                  Northeast
                </p>
              </li>
            </ol>
          </p>
        </statement>
      </task>
      <task>
        <statement>
          <p>
            Write a few sentences about why any direction moving up and left will have negative rate of change for the temperature in the direction given.
          </p>
        </statement>
      </task>
      <task>
        <statement>
          <p>
            Explain what direction you would need to move in to have the greatest positive rate of change for the temperature. Write a couple of sentences to relate your answer to the gradient using <xref ref="DD-vecprop">Equation</xref>.
          </p>
        </statement>
      </task>
      </activity>
    </worksheet>

    <p>
      Here are some questions about how the directional derivative changes at a point that we will address:
      <ul>
        <li>What direction corresponds to the <em>largest</em> value for the directional derivative?</li>
        <li>What is the largest value possible for the directional derivative at <m>(x_0,y_0)</m>?</li>
        <li>What direction corresponds to the <em>smallest</em> (or most negative) value for the directional derivative?</li>
        <li>What is the smallest value possible for the directional derivative at <m>(x_0,y_0)</m>?</li>
      </ul>
      All of these questions can be answered by considering <xref ref="DD-vecprop">equation</xref>. Because the length of the gradient vector does not change when changing direction, the <m>\cos(\theta)</m> factor tells us when we have the maximum and minimum values. Because of how we define the angle between vectors, we only need to consider values of <m>\theta</m> between 0 and <m>\pi</m>. Therefore, the largest value of the directional derivative occurs when <m>\theta=0</m> and <m>\cos(\theta)</m> attains its maximum value of <m>1</m>. This means that when the direction vector <m>\vu</m> is in the same direction as the gradient, the directional derivative is maximized. Furthermore, the largest value of the directional derivative is the length of the gradient. In equation form, we can express that if <m>\vu</m> is in the same direction as <m>\nabla f(x_0,y_0)</m>, then 
      <me>D_{\vu}f(x_0,y_0) = \vecmag{\nabla f(x_0,y_0)} \cos(0) =\vecmag{\nabla f(x_0,y_0)}</me>.
    </p>
    <p>
      By a parallel argument, the smallest (or most negative) value the directional derivative can take is when <m>\theta=\pi</m>. In this case, the direction vector is in the <em>opposite</em> direction of the gradient vector. Thus if <m>\theta=\pi</m>, then <me>D_{\vu}f(x_0,y_0) = \vecmag{\nabla f(x_0,y_0)} \cos(\pi) = -\vecmag{\nabla f(x_0,y_0)}</me> because <m>\cos(\pi)=-1</m>.
    </p>  
    <p>
      We summarize our most recent work by stating important facts about the gradient.
    </p>
    <assemblage xml:id="Gradient">
      <title>The Meaning of the Gradient as a Vector</title>
      <p>
        Let <m>f</m> be a differentiable function and <m>(x_0,y_0)</m> a point for which <m>\nabla f(x_0,y_0) \ne \vzero</m>. 
      </p>
      <p>
        <ul>
          <li>The gradient points in a direction perpendicular to the level curve <m>z=k</m> where <m>k=f(x_0,y_0)</m>.</li>
          <li>The gradient <m>\nabla f(x_0,y_0)</m> points in the direction of greatest rate of increase for <m>f</m> at <m>(x_0,y_0)</m>, and the instantaneous rate of change of <m>f</m> in that direction is the length of the gradient vector.</li>
          <li>
            If <m>\vu = \frac{1}{\vecmag{\nabla f(x_0,y_0)}} \nabla f(x_0,y_0)</m>, then <m>\vu</m> is a unit vector in the direction of greatest increase of <m>f</m> at <m>(x_0,y_0)</m>, and <m>D_{\vu} f(x_0,y_0) = \vecmag{\nabla f(x_0,y_0)}</m>. </li>
          <li>The gradient <m>\nabla f(x_0,y_0)</m> points in the opposite direction of greatest rate of decrease for <m>f</m> at <m>(x_0,y_0)</m>, and the instantaneous rate of change of <m>f</m> in that direction is the length of the gradient vector times <m>-1</m>.</li>
          <li>If <m>\vu = -\frac{1}{\vecmag{\nabla f(x_0,y_0)}} \nabla f(x_0,y_0)</m>, then <m>\vu</m> is a unit vector in the direction of greatest decrease of <m>f</m> at <m>(x_0,y_0)</m>, and <m>D_{\vu} f(x_0,y_0) =  -\vecmag{\nabla f(x_0,y_0)}</m>. </li>
        </ul>
      </p>
    </assemblage>
    <activity>
      <introduction>
        <p>
          We will look algebraically calculating and explaining the vector properties of the gradient using the function <m>f(x,y)=xy-2y^2+\frac{x^2}{2}+2y-x</m> at the input <m>(1,1)</m>.
        </p>
      </introduction>
      <task>
        <statement>
          <p>
            Calculate the gradient of <m>f</m>
          </p>
        </statement>
      </task>
      <task>
        <statement>
          <p>
            Calculate <m>\nabla f (1,1)</m>.
          </p>
        </statement>
      </task>
      <task>
        <statement>
          <p>
            Calculate <m>D_\vec{u} f (1,1)</m> for each of the following vectors:
            <ol>
              <li><m>\vec{u}=\langle -1,0\rangle </m> </li>
              <li><m>\vec{u}=\langle \frac{3}{5},-\frac{4}{5} \rangle </m> </li>
              <li><m>\vec{u}=\langle -\frac{1}{\sqrt{2}},\frac{1}{\sqrt{2}} \rangle </m> </li>
            </ol>
          </p>
        </statement>
      </task>
      <task>
        <statement>
          <p>
            What direction will correspond to the greatest rate of increase for <m>f</m> at the input <m>(1,1)</m>? Find the value of the directional derivative in this direction. 
          </p>
        </statement>
      </task>
    </activity>
    <p>
      Note that the third and fifth bullets above are algebraic statements of the second and fourth bullets, respectively.
    </p>
    <!-- TODO Resume editing here -->
    <p>
      <xref first="ez-mv_deriv-directional_deriv-sign" last="ez-mv_deriv-directional_deriv-relationship" text="local">Exercises</xref> look at how the directional derivative changes as a function of the direction used or of the point where the directional derivative is being evaluated.
    </p>
  </subsection>


  <subsection>
    <title>Applications</title>
    <p>
      The gradient has many natural applications. For example, situations often arise where we are interested in knowing the direction in which a function is increasing or decreasing most rapidly. This type of question is natural when constructing a road through the mountains or planning the flow of water across a landscape. In the next activity, we examine how the gradient can help with navigation to the top of a mountain in foggy conditions.
    </p>
    <worksheet>
  <activity workspace="1.5in" xml:id="foggymtn1">
      <introduction>
        <p>
          This activity considers directional derivatives and gradients for a function that measures elevation. Suppose you are hiking in a foggy park and can only see a few feet in front of you. There is nothing blocking you from walking in any particular direction, but because of the fog you cannot see where the highest point on the mountain is. You want to try to find the top of the mountain, but you don't have a map, trail, or line of sight to other landmarks. You do have a compass, which works in the fog. This allows you to identify the cardinal directions.
        </p>
        <p>
          In order to use calculational tools from multivariable calculus, you overlay an <m>xy</m>-coordinate system on the park. The <m>x</m>-coordinate measures east/west location, with eastward movement associated with increasing <m>x</m>-values. The <m>y</m>-coordinate measures north/south location, with northward movement associated with increasing <m>y</m>-values. The elevation in meters above sea level of the park's terrain at the location <m>(x,y)</m> is given by a function <m>h(x,y)</m>.
        </p>
      </introduction>
      <task>
        <statement>
          <p>
            Let <m>P_1</m> be your current location in the foggy park. You use your compass to find the east and north directions. At <m>P_1</m>, you find that the ground rises 1 meter per 50 meters traveled to the east and the ground rises 2.5 meters per 50 meters traveled to the north. 
          </p>
          <p>
            Use this information to find <m>\nabla h (P_1)</m>.
          </p>
        </statement>
      </task>
      <task>
        <statement>
          <p>
            Use your answer to the previous part to say what direction is <q>uphill</q> at <m>P_1</m> and state the rate of elevation increase in this direction. 
          </p>
        </statement>
      </task>
      <task>
        <statement>
          <p>
            You decide to walk uphill from your location <m>P_1</m> in order to try to find the top of the mountain. After walking in the same direction for a while, you are at a point <m>P_2</m> and notice that you are no longer walking in the steepest direction. You again locate  east and north and measure the steepness of the mountain in these directions. You find that the ground rises 1.5 meters per 75 meters traveled to the east and the ground goes down 0.5 meters per 100 meters traveled to the north. 
          </p>
          <p>
            Use this new information to calculate <m>\nabla h (P_2)</m>, find the uphill direction, and find how steep the mountain is in the uphill direction at <m>P_2</m>.
          </p>
        </statement>
      </task>
      <task>
        <statement>
          <p>
            Suppose you continue this method of walking in the uphill direction for a while, finding the new uphill direction, and walking in the new uphill direction. Do you think you must eventually find the top of the mountain? How you will know that you have reached the top of the mountain? Remember that you can't see very far in front of you. Write a few sentences to explain your reasoning. 
          </p>
        </statement>
      </task>
    </activity>
</worksheet>
    <p>
      The technique described in the previous activity has many applications related to maximizing or minimizing functions. For example, consider a two-dimensional version of how a heat-seeking missile might work. (This application is borrowed from United States Air Force Academy Department of Mathematical Sciences.)
         <!-- Out of date url at
        <url href="http://www.nku.edu/longa/classes/mat320/mathematica/multcalc.htm"><c>http://www.nku.edu/longa/classes/mat320/mathematica/multcalc.htm</c></url>.)  -->
      Suppose that the temperature surrounding a fighter jet can be modeled by the function <m>T</m> defined by
      <me>
        T(x,y) = \frac{100}{1+(x-5)^2 + 4(y-2.5)^2},
      </me>
      where <m>(x,y)</m> is a point in the plane of the fighter jet and <m>T(x,y)</m> is measured in degrees Celsius. Some contours and gradients <m>\nabla T</m> are shown on
      the left in <xref ref="F_10_6_missile">Figure</xref>.
    </p>

    <figure xml:id="F_10_6_missile">
      <caption>Contours and gradient for <m>T(x,y)</m> and the missile's path.</caption>
      <sidebyside widths="50% 50%">
      <image source="images/fig_10_6_missile_grad"/>
      <image source="images/fig_10_6_missile_path"/>
      </sidebyside>
    </figure>

    <p>
      A heat-seeking missile will always travel in the direction in which the temperature increases most rapidly; that is, it will always travel in the direction of the gradient <m>\nabla T</m>. If a missile is fired from the point <m>(2,4)</m>, then its path will be that shown on the right in <xref ref="F_10_6_missile">Figure</xref>.
    </p>
    <p>
      This type strategy is sometimes called <term>gradient ascent</term>. The gradient decent method is used to find relative minimums for functions by taking steps in the direction opposite the gradient. Gradient decent methods are used extensively in economics and machine learning to find where the difference between predictions from a model and data are as small as possible (minimize error).
    </p>

  </subsection>


  <subsection>
    <title>Summary</title>
    <ul>
      <li>
        <p>
          The directional derivative of <m>f</m> at the point <m>(x,y)</m> in the direction of the unit vector <m>\vu = \langle u_1, u_2 \rangle</m> is
          <me>
            D_{\vu}f(x,y) = \lim_{h \to 0} \frac{f(x+u_1h, y+u_2h) - f(x,y)}{h}
          </me>
          for those values of <m>x</m> and <m>y</m> for which the limit exists.  In addition, <m>D_{\vu}f(x,y)</m> measures the slope of the graph of <m>f</m> when we move in the direction <m>\vu</m>. Alternatively, <m>D_{\vu} f(x_0,y_0)</m> measures the instantaneous rate of change of <m>f</m> in the direction <m>\vu</m> at <m>(x_0,y_0)</m>.
        </p>
      </li>

      <li>
        <p>
          The gradient of a function <m>f=f(x,y)</m> at a point <m>(x_0,y_0)</m> is the vector
          <me>
            \nabla f(x_0,y_0) = \left\langle f_x(x_0,y_0), f_y(x_0,y_0)\right\rangle
          </me>
        </p>
      </li>

      <li>
        <p>
          The directional derivative in the direction <m>\vu</m> may be computed by
          <me>
            D_{\vu}f(x_0,y_0) = \nabla f(x_0,y_0)\cdot \vu
          </me>
        </p>
      </li>

      <li>
        <p>
          At any point where the gradient is nonzero, the gradient is orthogonal to the contour through that point and points in the direction in which <m>f</m> increases most
          rapidly; moreover, the slope of <m>f</m> in this direction equals the length of the gradient <m>\vecmag{\nabla f(x_0,y_0)}</m>.  Similarly, the direction opposite of the gradient is the direction of greatest decrease, and that rate of decrease is the negative length of the gradient.
        </p>
      </li>
    </ul>

    </subsection>
    <xi:include href="./exercises/ez-S_mv_DirectionalDerivatives.ptx" />

    
</section>
