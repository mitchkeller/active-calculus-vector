<?xml version="1.0"?>
<!-- **********************************************************************-->
<!-- Copyright 2013-2025                                                   -->
<!-- Nicholas Long, Mitchel Keller, Steven Schlicker                       -->
<!--                                                                       -->
<!-- This file is part of Active Calculus Multivariable.                   -->
<!--                                                                       -->
<!-- Permission is granted to copy, distribute and/or modify this document -->
<!-- under the terms of the Creative Commons BY-NC-SA license.  The work   -->
<!-- may be used for free by any party so long as attribution is given to  -->
<!-- the author(s), the work and its derivatives are used in the spirit of -->
<!-- "share and share alike"; no party may sell this work or any of its    -->
<!-- derivatives for profit.  All trademarks are the registered marks of   -->
<!-- their respective owners.                                              -->
<!-- **********************************************************************-->
<section xml:id="S-10-6-Directional-Derivative" xmlns:xi="http://www.w3.org/2001/XInclude">
  <title>Directional Derivatives and the Gradient</title>
  
    <objectives>
        <ul>
          <li>
            <p>
              The partial derivatives of a function <m>f</m> tell us the rate of change of <m>f</m> in the direction of the coordinate axes. How can we measure the rate of change of <m>f</m> in other directions?
            </p>
          </li>
          <li>
            <p>
              What is the gradient of a multivariable function and what does it tell us about the rate of change the function in different directions?
            </p>
          </li>
        </ul>
    </objectives>

    <introduction>
    <p>
      The partial derivatives of a multivariable function tell us the instantaneous rate at which the function's output changes as we hold all but one independent variable constant (allowing the remaining independent variable to change). It is natural to wonder how we can measure the rate at which a function changes in a direction other than parallel to a coordinate axes. In this section, we investigate this question and will connect the rates of change in other directions to the rates of change given by the partial derivatives. In our preview activity, we will investigate these concepts in terms of a contour map representing elevation in terms of location.
    </p>
    <p>
      The preview activity uses cardinal directions to specify the direction of displacement vectors. These directions can be described by a compass rose. The compass rose given in <xref ref="comp_rose1" /> is an example of a sixteen point rose. Note that directions like ESE are read as <q>east-southeast</q> half way between east and southeast.
    </p>
    <figure xml:id="comp_rose1">
      <caption>An example of a sixteen point compass rose (from <url
      href="https://commons.wikimedia.org/w/index.php?curid=667281" visual="commons.wikimedia.org/w/index.php?curid=667281">By Brosen~commonswiki - Own work, CC BY 2.5</url>)</caption>
      <image width="50%" source="/Brosen_windrose.png">
        <description>A sixteen point compass rose</description>
      </image>
    </figure>
    <exploration xml:id="PA-DD">
      <introduction>
        <p>
          <xref ref="PA-DDcontour1"/> is a contour plot showing the elevations for a region of a nearby park. The elevations are given in meters above sea level and the horizontal and vertical grid lines are 1 km apart. Several locations are labeled on <xref ref="PA-DDcontour1"/> with capital letters. We will be refering to <m>h(x,y)</m> as the function of two variables that gives the elevation as a function of x-coordinates (location in East-West, horizontal direction) and y-coordinates (location North-South, vertical direction).
        </p>
        <figure xml:id="PA-DDcontour1">
          <caption>A contour plot representing the elevation of locations in a nearby park with three locations labeled</caption>
          <image width="60%" xml:id="img-PA-DDcontour1">
            <sageplot>
              from matplotlib import ticker
              var('x,y,z,s,t')
              f(x,y)=(x*y+(y-20)^2)/125+90*exp(-(((x-70)/90)^2+((y+10)/30)^2))+100+100*exp(-(((x+75)/30)^2+((y-50)/60)^2))
              n=30
              c=[70+i*5 for i in range(n)]
              plot2=contour_plot(f(x,y),(x,-100,100),(y,-100,100),fill=True,labels=True,linewidths=1,contours=c,label_fmt="%1.0f",gridlines=True,plot_points=100,tick_formatter=(ticker.NullFormatter(),
              ticker.NullFormatter()))
              plot2+=arrow((-90,-90),(-80,-90),color="black",arrowsize=2)+arrow((-90,-90),(-90,-80),color="black",arrowsize=2)
              plot2+=arrow((-90,-90),(-100,-90),color="black",arrowsize=2)+arrow((-90,-90),(-90,-100),color="black",arrowsize=2)
              plot2+=text("N",(-90,-75),color="black")+text("S",(-90,-105),color="black")
              plot2+=text("E",(-75,-90),color="black")+text("W",(-105,-90),color="black")
              plot2+=text("A",(0,10),color="black")
              plot2+=text("B",(50,-35),color="black")
              plot2+=text("C",(60,60),color="black")
              plot2
            </sageplot>
          </image>
        </figure>
      </introduction>
      <task>
        <statement>
          <p>
            Using <xref ref="PA-DDcontour1"/> and treating the elevation as a multivariable function <m>h(x,y)</m>, state whether each of the following is positive, negative, or zero. Write a sentence to justify your reasoning.
            <ol marker="i.">
              <li><m>h_x(A)</m></li>
              <li><m>h_y(A)</m></li>
              <li><m>h_x(B)</m></li>
              <li><m>h_y(B)</m></li>
              <li><m>h_x(C)</m></li>
              <li><m>h_y(C)</m></li>
            </ol>  
          </p>
        </statement>
      </task>
      <task>
        <statement>
          <p>
            Suppose we are at the point B. Would you expect the elevation to be increasing, decreasing, or constant if you took a step in the Northeast direction?
          </p>
        </statement>
      </task>
       <task>
        <statement>
          <p>
            Suppose we are at the point B. Would you expect the elevation to be increasing, decreasing, or constant if you took a step in the Southeast direction?
          </p>
        </statement>
      </task>
       <task>
        <statement>
          <p>
            Suppose we are at the point A. Would you expect the elevation to be increasing, decreasing, or constant if you took a step in the Southwest direction?
          </p>
        </statement>
      </task>
      <task>
        <statement>
          <p>
            Suppose we are at the point C. In what direction would you take a step to move in the steepest downhill direction?
          </p>
        </statement>
      </task>
      <task>
        <statement>
          <p>
            Suppose we are at the point A. In what direction would you take a step to move in the steepest uphill direction?
          </p>
        </statement>
      </task>
      <task>
        <statement>
          <p>
            Suppose we are at point B. Rank the following directions in order of steepness: Northeast, North, East, West, South
          </p>
        </statement>
      </task>
    </exploration>

    <!-- <exploration xml:id="PA-DD">
      <statement>
        <p>
          Let's consider the function <m>f</m> defined by
          <me>
            f(x,y) = 30 - x^2 - \frac 12 y^2,
          </me>
          and suppose that <m>f</m> measures the temperature, in degrees Celsius, at a given point in the plane, where <m>x</m> and <m>y</m> are measured in feet. Assume that the positive <m>x</m>-axis points due east, while the positive <m>y</m>-axis points due north. A contour plot of <m>f</m> is shown in <xref ref="F_10_6_preview_1">Figure</xref>
        </p>

        <figure xml:id="F_10_6_preview_1">
          <caption>A contour plot of <m>f(x,y) = 30-x^2-\frac12 y^2</m>.</caption>
          <image width="50%" source="images/fig_10_6_preview_1"/>
        </figure>

        <ol marker="a.">
          <li>
            <p>
              Suppose that a person is walking due east, and thus parallel to the <m>x</m>-axis.  At what instantaneous rate is the temperature changing with respect to <m>x</m> at the moment the walker passes the point <m>(2,1)</m>?  What are the units on this rate of change?
            </p>
          </li>

          <li>
            <p>
              Next, determine the instantaneous rate of change of temperature with respect to distance at the point <m>(2,1)</m> if the person is instead walking due north.  Again, include units on your result.
            </p>
          </li>

          <li>
            <p>
              Now, rather than walking due east or due north, let's suppose that the person is walking with velocity given by the vector <m>\vv = \langle 3, 4 \rangle</m>, where time is measured in seconds.  Note that the person's speed is thus <m>| \vv | = 5</m> feet per second.
    
                Find parametric equations for the person's path; that is, parameterize the line through <m>(2,1)</m> using the direction vector <m>\vv = \langle 3, 4 \rangle</m>.  Let <m>x(t)</m> denote the <m>x</m>-coordinate of the line, and <m>y(t)</m> its <m>y</m>-coordinate. Make sure your parameterization places the walker at the point <m>(2,1)</m> when <m>t=0</m>. 
            </p>
          </li>

          <li>
            <p>
              With the parameterization in (c), we can now view the temperature <m>f</m> as not only a function of <m>x</m> and <m>y</m>, but also of time, <m>t</m>.  Hence, use the chain rule to determine the value of <m>\frac{df}{dt}\restrict{t=0}</m>.  What are the units on your answer?  What is the practical meaning of this result?
            </p>
          </li>
        </ol>
      </statement>

      <answer>
        <ol marker="a.">
          <li>
            <p>
             <m>f_x(2,1) = -4 \ \frac{^{\circ}C}{\text{ foot } }</m>
            </p>
          </li>
          <li>
            <p>
              <m>f_y(2,1) = -24 \ \frac{^{\circ}C}{\text{ foot } }</m>
            </p>
          </li>
          <li>
            <p>
              <me>
                x(t) = 2 + 3t \ \text{ and }  \ y(t)=1+4t
              </me>
            </p>
          </li>
          <li>
            <p>
              With the parameterization in (c), we have
              <me>
                \frac{df}{dt} = \frac{\partial f}{\partial x} \frac{dx}{dt} + \frac{\partial f}{\partial y} \frac{dy}{dt} = (-2x)(3) - (24y)(4)
              </me>.
              So
              <me>
                \frac{df}{dt}\mid_{t=0} = (-2)(2)(3) - (24)(1)(4) = -108 \ \frac{^{\circ}C}{\text{ second } }
              </me>.
              So the temperature is decreasing by 108 degrees Celsius for every second she moves in the direction of <m>\vv</m> from the point <m>(2,1)</m>.
            </p>
          </li>
        </ol>
      </answer>  

      <solution>
        <ol marker="a.">
          <li>
            <p>
              The instantaneous rate of change in the temperature when a person is walking due east at the moment she passes the point <m>(2,1)</m> is given by <m>f_x(2,1)</m>.
              Since <m>f_x(x,y) = -2x</m>,
              we have <m>f_x(2,1) = -4 \ \frac{^{\circ}C}{\text{ foot } }</m>.
            </p>
          </li>
          <li>
            <p>
              The instantaneous rate of change in the temperature when a person is walking due north at the moment she passes the point <m>(2,1)</m> is given by <m>f_y(2,1)</m>.
              Since <m>f_y(x,y) = -24 y</m>,
              we have <m>f_y(2,1) = -24 \ \frac{^{\circ}C}{\text{ foot } }</m>.
            </p>
          </li>
          <li>
            <p>
              Parametric equations for the line through <m>(2,1)</m> in the direction of <m>\vv = \langle 3, 4 \rangle</m> are
              <me>
                x(t) = 2 + 3t \ \text{ and }  \ y(t)=1+4t
              </me>.
            </p>
          </li>
          <li>
            <p>
              With the parameterization in (c), we have
              <me>
                \frac{df}{dt} = \frac{\partial f}{\partial x} \frac{dx}{dt} + \frac{\partial f}{\partial y} \frac{dy}{dt} = (-2x)(3) - (24y)(4)
              </me>.
              So
              <me>
                \frac{df}{dt}\mid_{t=0} = (-2)(2)(3) - (24)(1)(4) = -108 \ \frac{^{\circ}C}{\text{ second } }
              </me>.
              So the temperature is decreasing by 108 degrees Celsius for every second she moves in the direction of <m>\vv</m> from the point <m>(2,1)</m>.
            </p>
          </li>
        </ol>
      </solution>
  
    </exploration> -->
    
  </introduction>

  <subsection>
    <title>Directional Derivatives</title>
    <p>
      The goal of this section is to measure the rate of change for a function of two variables in a direction that is not parallel to one of the coordinate directions. We will use the classic calculus approach to set up this measurement (approximate our measurement, quantify how the approximation changes on a smaller scale, then use a limit to find the actual value). In order to measure the rate of change in the output of our function, we will use a typical difference quotient 
      <me>
        \text{rate of change} = \frac{\text{change in output}}{\text{change in input}}
      </me>
    </p>
    <p>
      Let <m>f</m> be a function of two variables, <m>x</m> and <m>y</m>, where we wish to measure the rate of change in the <m>\langle a,b\rangle</m> direction for <m>f</m> at the base point <m>(x_0,y_0)</m>. So we can set up the difference quotient using the points <m>(x_0+a,y_0+b)</m> and <m>(x_0,y_0</m>).
      <me>\frac{f(x_0+a,y_0+b)-f(x_0,y_0)}{\sqrt{a^2+b^2}}</me>
      Note here that we use the distance formula to measure the change in the input as distance on the <m>xy</m>-plane. <xref ref="CCA-DD1" /> shows the plot of a surface given by <m>z=f(x,y)</m> with the points used in the difference quotient labeled.
    </p>
    <figure xml:id="CCA-DD1">
      <caption>A plot of <m>f(x,y)</m> with the measurements of change in input and output labeled for a change of inputs given by <m>\langle a,b\rangle</m></caption>
      <interactive title="interactive-CCA-DD1" platform="sage" width="100%" aspect="1:1">
        <slate surface="sage">
          from sage.plot.plot3d.plot3d import axes
          var('x,y,z,t,s')
          scale=2; a=1/2;b=1/3 ;x0=1;y0=1;
          f(x,y)=2*exp(-(x-1/2)^2/2-y^2/4)
          plot3=axes(scale,1,color="black",frame=False,aspect_ratio=1)+text3d("x",(scale+0.5,0,0),fontsize=30)+text3d("y",(0,scale+0.5,0),fontsize=30)+text3d("z",(0,0,scale+0.5),fontsize=30)
          param(s,t)=(s,t,f(s,t))
          #set up grid      n is number of steps in s    m is number of steps in t  
          #a1 is min s    a2 is max s   b1 is min t    b2 is max t
          n=6;m=6;a1=0;a2=2;b1=0;b2=2; 
          #c1 is surface color     o1 is surface opacity
          #c2 and o2 are for constant t value traces
          #c3 and o3 are for constant s value traces
          c1="gray"; c2="black"; c3="black"; o1=0.2; o2=0.2; o3=0.2;
          plot99=parametric_plot3d(param,(s,a1,a2),(t,b1,b2),color=c1,opacity=o1)
          for i in range(n+1):
            sv=a1+i/n*(a2-a1)
            plot99+=parametric_plot3d(param(sv,t),(t,b1,b2),color=c2,opacity=o2)
          for i in range(m+1):
            tv=b1+i/m*(b2-b1)
            plot99+=parametric_plot3d(param(s,tv),(s,a1,a2),color=c3,opacity=o3)
          plot3+=plot99
          #plot3+=plot3d(f(x,y),(x,0,2),(y,0,2),color="gray",plot_points=13,opacity=0.3)
          plot3+=parametric_plot3d((x0+a*t,y0+b*t,f(x0+a*t,y0+b*t)),(t,-2,2),color="black",opacity=0.5,thickness=2)
          #plot3+=parametric_plot3d((x0+a*t,y0+b*t,s),(t,-1,1.5),(s,0,2),color="gray",opacity=0.4,mesh=True,plot_points=3)
          plot3+=point((x0,y0,f(x0,y0)),color="red",size=20)+point((x0+a,y0+b,f(x0+a,y0+b)),color="red",size=20)
          plot3+=arrow3d((x0,y0,0),(x0+a,y0+b,0),color="blue")+text3d("\u27E8a,b\u27E9",(a+0.25+x0,b+0.25+y0,0),color="blue",fontsize=20)
          plot3+=line([(x0-b/2,y0+a/2,0),(x0,y0,0),(x0+a,y0+b,0),(x0+a-b/2,y0+b+a/2,0)],color="blue",thickness=2)
          plot3+=text3d("change",(x0+a/2-b/2,y0+b/2+a/2,-0.1),color="blue",fontsize=20)+text3d("in input",(x0+a/2-b/2,y0+b/2+a/2,-0.3),color="blue",fontsize=20)
          plot3+=line([(x0,y0,f(x0,y0)),(0,0,f(x0,y0))],color="red",thickness=2)
          plot3+=line([(x0+a,y0+b,f(x0+a,y0+b)),(0,0,f(x0+a,y0+b))],color="red",thickness=2)+text3d("change in output",(-1.25,0,(f(x0,y0)+f(x0+a,y0+b))/2),color="red",fontsize=20)
          plot3+=arrow((0,0,(f(x0,y0)+f(x0+a,y0+b))/2),(0,0,f(x0+a,y0+b)),color="red")
          plot3+=arrow((0,0,(f(x0,y0)+f(x0+a,y0+b))/2),(0,0,f(x0,y0)),color="red")
          show(plot3,viewpoint=[[-0.0327,-0.6937,-0.7196],176.12],camera_position=[1.1319,6.5856,1.2975])
        </slate>
      </interactive>
    </figure>
    <p>
      The difference quotient given above is a good start to approximating the rate of change for the output of <m>f</m> in the direction <m>\langle a,b\rangle</m> (the first step in our classic calculus approach), but it is not clear how this approximation will change when we look at smaller scales. Specifically, we will need to look at what happens to this approximation as we shrink the step size, <m>\sqrt{a^2+b^2}\to 0</m>. We can separate the length of the vector <m>\langle a,b \rangle </m> from its direction by finding the unit vector in the direction of <m>\langle a,b\rangle</m>.
    </p>
    <p>
      Let <m>\vu=\langle u_1,u_2\rangle </m> be the unit vector in the same direction as <m>\langle a,b \rangle</m>. Thus, we can express <m>\langle a,b \rangle = t \langle u_1,u_2\rangle</m>, where <m>t</m> is the step size and <m>\vu=\langle u_1,u_2\rangle </m> is the unit vector in the direction we want to measure the rate of change of <m>f</m>. Our difference quotient becomes 
      <me>\frac{f(x_0+t (u_1),y_0+t(u_2))-f(x_0,y_0)}{t}</me>
      and looking at smaller scales will be accomplished by looking at what happens as <m>t</m> goes to zero. This accomplishes the second step of our classic calculus approach in quantifying how our approximation will work on smaller scales. We can take the limit as <m>t \to 0</m> to get our definition for the directional derivative.
    </p>
    <definition xml:id="defn-DD">
      <statement>
        <p>
          Let <m>f = f(x,y)</m> be a function of two variables. The <term>derivative of <m>f</m> at the point <m>(x,y)</m> in the direction of the unit vector <m>\vu = \langle u_1, u_2 \rangle</m></term><idx><h>directional derivative</h></idx> is denoted <m>D_{\vu}f(x,y)</m> and is given by
          <men xml:id="E_DirDerDef">
            D_{\vu}f(x,y) = \lim_{t \to 0} \frac{f(x+u_1 t, y+u_2 t) - f(x,y)}{t}
          </men>
          for those values of <m>x</m> and <m>y</m> for which the limit exists. 
        </p>
      </statement>
    </definition>
    <p>
      The notation <m>D_{\vu}f(x,y)</m> can also be read as the directional derivative of <m>f</m> in the direction <m>\vu</m> at the point <m>(x,y)</m>. While this may seem like a handful, each piece of this statement is necessary for a directional derivative; We need to specify what function we are looking at the rate of change of, the location at which we are looking at the rate of change, AND the direction in which we will change the inputs. When we evaluate the directional derivative <m>D_{\vu} f(x,y)</m> at a point <m>(x_0, y_0)</m>, the result <m>D_{\vu} f(x_0,y_0)</m> tells us the instantaneous rate at which <m>f</m> changes at <m>(x_0, y_0)</m> per unit increase in the direction of the vector <m>\vu</m>.
    </p>
    <p>
      We will take a moment to discuss something you may have noticed which will connect to our method of understanding surfaces (and their defining functions) by looking at slices. We can think about the directional derivative as a single variable calculus problem if we cut our surface in the <m>\rangle u_1,u_2\langle </m> direction through our base point. 
    </p>
    <figure xml:id="CCA-DD2">
      <caption>A plot of <m>f(x,y)</m> with a trace shown from the point <m>(x_0,y_0)</m> in the direction <m>\langle u_1,u_2 \rangle</m></caption>
      <interactive title="interactive-CCA-DD2" platform="sage" width="100%" aspect="1:1">
        <slate surface="sage">
          from sage.plot.plot3d.plot3d import axes
          var('x,y,z,t,s')
          scale=2; a=1/2;b=1/3 ;x0=1;y0=1;
          f(x,y)=2*exp(-(x-1/2)^2/2-y^2/4)
          plot4=axes(scale,1,color="black",frame=False,aspect_ratio=1)+text3d("x",(scale+0.5,0,0),fontsize=30)+text3d("y",(0,scale+0.5,0),fontsize=30)+text3d("z",(0,0,scale+0.5),fontsize=30)
          param(s,t)=(s,t,f(s,t))
          #set up grid      n is number of steps in s    m is number of steps in t  
          #a1 is min s    a2 is max s   b1 is min t    b2 is max t
          n=6;m=6;a1=0;a2=2;b1=0;b2=2; 
          #c1 is surface color     o1 is surface opacity
          #c2 and o2 are for constant t value traces
          #c3 and o3 are for constant s value traces
          c1="gray"; c2="black"; c3="black"; o1=0.2; o2=0.2; o3=0.2;
          plot99=parametric_plot3d(param,(s,a1,a2),(t,b1,b2),color=c1,opacity=o1)
          for i in range(n+1):
            sv=a1+i/n*(a2-a1)
            plot99+=parametric_plot3d(param(sv,t),(t,b1,b2),color=c2,opacity=o2)
          for i in range(m+1):
            tv=b1+i/m*(b2-b1)
            plot99+=parametric_plot3d(param(s,tv),(s,a1,a2),color=c3,opacity=o3)
          plot4+=plot99
          #plot3+=plot3d(f(x,y),(x,0,2),(y,0,2),color="gray",plot_points=13,opacity=0.3)
          plot4+=parametric_plot3d((x0+a*t,y0+b*t,f(x0+a*t,y0+b*t)),(t,0,2),color="blue",opacity=0.5,thickness=3)
          plot4+=parametric_plot3d((x0+a*t,y0+b*t,0),(t,0,2),color="red",opacity=0.5,thickness=3)
          plot4+=parametric_plot3d((x0+a*t,y0+b*t,s),(t,0,2),(s,0,2),color="blue",opacity=0.1,mesh=True,plot_points=2)
          plot4+=arrow((x0,y0,0),(x0+a,y0+b,0),color="red",width=1)+text3d("\u27E8u\u2081,u\u2082\u27E9",(a+0.25+x0,b+0.25+y0,-0.2),color="red",fontsize=20)
          plot4+=point((x0,y0,f(x0,y0)),color="blue",size=30)+point((x0,y0,0),color="red",size=20)
          show(plot4,viewpoint=[[-0.6979,-0.4507,-0.5566],98.49],camera_position=[6.4729,-1.1441,2.3749])
        </slate>
      </interactive>
    </figure>
    <p>
      In particular, we can parameterize the trace along the surface by noticing our inputs correspond to the line in the xy-plane given by <m>\langle x_0+ u_1 t, y_0 + u_2 t\rangle</m> (shown in red on <xref ref="CCA-DD2"/>) and thus our trace along the surface will be given by <m>\vr(t)=\langle x_0+ u_1 t, y_0 + u_2 t , f(x_0+ u_1 t, y_0 + u_2 t) \rangle</m> (shown in blue on <xref ref="CCA-DD2"/>). We can visualize the directional derivative as the slope of a tangent line along this trace as drawn in black on <xref ref="CCA-DD3"/>. The quantity <m>D_{\vu} f(x_0,y_0)</m> tells us the slope of the line tangent to the surface in the direction of <m>\vu</m> at the point <m>(x_0,y_0,f(x_0,y_0))</m>. 
    </p>
    <figure xml:id="CCA-DD3">
      <caption>A plot of the trace of <m>f</m> along the direction <m>\langle u_1,u_2\rangle</m> with tangent line drawn at point corresponding to <m>(x_0,y_0)</m></caption>
      <image width="60%" xml:id="img-PA-DDcontour3">
        <sageplot>
          from matplotlib import ticker
          var('x,y,z,t,s')
          f(x,y)=2*exp(-(x-1/2)^2/2-y^2/4)
          a=1/2;b=1/3 ;x0=1;y0=1;
          fx=diff(f,x);fy=diff(f,y);
          fxv=fx(x=x0,y=y0);fyv=fy(x=x0,y=y0);
          plot4=plot(f(x0+a*t,y0+b*t),(t,0,2),color="blue",axes_labels=["$t$","$f(x_0+t u_1,y_0+t u_2)$"],thickness=2,gridlines=True,ymin=0,ymax=2,aspect_ratio=2,tick_formatter=(ticker.NullFormatter(),ticker.NullFormatter()))
          plot4+=parametric_plot((t,f(x0,y0)+a*fxv*t+b*fyv*t),(t,-1/2,1/2),color="black",thickness=2)
          plot4
        </sageplot>
      </image>
    </figure>



    <!-- <p>
      Given a function <m>z = f(x,y)</m>, the partial derivative <m>f_x(x_0,y_0)</m> measures the instantaneous rate of change of <m>f</m> as only the <m>x</m> variable changes; likewise, <m>f_y(x_0,y_0)</m> measures the rate of change of <m>f</m> at <m>(x_0,y_0)</m> as only <m>y</m> changes. Note particularly that <m>f_x(x_0,y_0)</m> is measured in <q>units of <m>f</m> per unit of change in <m>x</m>,</q> and that the units on <m>f_y(x_0,y_0)</m> are similar.
    </p>

    <p>
      In <xref ref="PA-DD">Preview Activity</xref>, we saw how we could measure the rate of change of <m>f</m> in a situation where both <m>x</m> and <m>y</m> were changing; in that activity, however, we found that this rate of change was measured in <q>units of <m>f</m> per unit of <em>time</em>.</q> In a given unit of time, we may move more than one unit of distance. In fact, in <xref ref="PA-DD">Preview Activity</xref>, in each unit increase in time we move a distance of <m>\vecmag{\vv}  = 5</m> feet. To generalize the notion of partial derivatives to any direction of our choice, we instead want to have a rate of change whose units are <q>units of <m>f</m> per unit of distance in the given direction.</q>
    </p>

    <p>
      In this light, in order to formally define the derivative in a particular direction of motion, we want to represent the change in <m>f</m> for a given <em>unit</em> change in the direction of motion. We can represent this unit change in direction with a unit vector, say <m>\vu = \langle u_1, u_2 \rangle</m>. If we move a distance <m>h</m> in the direction of <m>\vu</m> from a fixed point <m>(x_0,y_0)</m>, we then arrive at the new point <m>(x_0+u_1h, y_0+u_2h)</m>. It now follows that the slope of the secant line to the curve on the surface through <m>(x_0,y_0)</m> in the direction of <m>\vu</m> through the points <m>(x_0,y_0)</m> and <m>(x_0+u_1h, y_0+u_2h)</m> is
      <men xml:id="eq_10_6_diff_quot">
        m_{\mbox{sec} } = \frac{f(x_0+u_1h, y_0+u_2h) - f(x_0,y_0)}{h}.
      </men>
    </p>

    <p>
      To get the instantaneous rate of change of <m>f</m> in the direction <m>\vu = \langle u_1, u_2 \rangle</m>, we must take the limit of the quantity in Equation<nbsp/><xref ref="eq_10_6_diff_quot"/> as <m>h \to 0</m>. Doing so results in the formal definition of the directional derivative.
    </p>

    <definition>
      <statement>
        <p>
          Let <m>f = f(x,y)</m> be given. The <term>derivative of <m>f</m> at the point <m>(x,y)</m> in the direction of the unit vector <m>\vu = \langle u_1, u_2 \rangle</m></term><idx><h>directional derivative</h></idx> is denoted <m>D_{\vu}f(x,y)</m> and is given by
          <men xml:id="E_DirDerDef">
            D_{\vu}f(x,y) = \lim_{h \to 0} \frac{f(x+u_1h, y+u_2h) - f(x,y)}{h}
          </men>
          for those values of <m>x</m> and <m>y</m> for which the limit exists.
        </p>
      </statement>
    </definition> -->

   <!--  <p>
      The quantity <m>D_{\vu} f(x,y)</m> is called a <em>directional derivative</em>. When we evaluate the directional derivative <m>D_{\vu} f(x,y)</m> at a point <m>(x_0, y_0)</m>, the result <m>D_{\vu} f(x_0,y_0)</m> tells us the instantaneous rate at which <m>f</m> changes at <m>(x_0, y_0)</m> per unit increase in the direction of the vector <m>\vu</m>. In addition, the quantity <m>D_{\vu} f(x_0,y_0)</m> tells us the slope of the line tangent to the surface in the direction of <m>\vu</m> at the point <m>(x_0,y_0,f(x_0,y_0))</m>.
    </p> -->
  </subsection>


  <subsection>
    <title>Computing the Directional Derivative</title>
    <p>
      In a similar way to how we developed algebraic rules for calculating standard derivatives in single variable calculus and for partial derivatives in multivariable calculus, we can also find a way to evaluate directional derivatives without resorting to the limit definition found in Equation <xref ref="E_DirDerDef"/>. We will look at these algebraic shortcuts from two perspectives; first, we will look at <xref ref="E_DirDerDef"/> as a composition of functions and use the chain rule from <xref ref="S-10-5-Chain-Rule"/>. Second, we will look at how the directional derivative can be found from our linearization when we have <q>nice</q> functions.
    </p>

    <p>
      We are interested in the instantaneous rate of change of <m>f</m> at a point <m>(x_0,y_0)</m> in the direction <m>\vu = \langle u_1, u_2 \rangle</m>, where <m>\vu</m> is a unit vector. Our trace along the surface will be given by <m>\vr(t)=\langle x_0+ u_1 t, y_0 + u_2 t , f(x_0+ u_1 t, y_0 + u_2 t) \rangle</m>. In particular, the input variables <m>x</m> and <m>y</m> are therefore changing according to
      <me>
        x = x_0 + u_1t \ \ \ \ \ \text{ and }  \ \ \ \ \  y = y_0 + u_2t
      </me>
    </p>
    <p>
      Observe that <m>\frac{dx}{dt} = u_1</m> and <m>\frac{dy}{dt} = u_2</m> for all values of <m>t</m>. Since <m>\vu</m> is a unit vector, it follows that a point along the line of inputs along the xy-plane; that is, each single unit of time corresponds to movement of a single unit of distance in that direction. This observation allows us to use the Chain Rule to calculate the directional derivative, which measures the instantaneous rate of change of <m>f</m> with respect to change in the direction <m>\vu</m>.
    </p>
    <p>
      We can express the output of our function along the given direction as a composition of functions, <m>f(t)=f(x(t), y(t))</m>, which means we can apply the chain rule to get
      <md>
        <mrow>D_{\vu}f(x_0,y_0) \amp = f_x(x_0,y_0)\frac{dx}{dt} + f_y(x_0,y_0)\frac{dy}{dt} </mrow>
        <mrow> \amp = f_x(x_0,y_0)u_1 + f_y(x_0,y_0)u_2. </mrow>
      </md>
    </p>

    <p>
      This now allows us to compute the directional derivative at an arbitrary point according to the following formula.
    </p>

    <theorem xml:id="Directional-derivative">
      <title>Calculating a directional derivative</title>
      <p>
        Given a differentiable function <m>f = f(x,y)</m> and a unit vector <m>\vu = \langle u_1, u_2 \rangle</m>, <m>D_{\vu}f(x,y)</m> can be computed by
        <men xml:id="eq_10_6_DD">
          D_{\vu}f(x,y) = f_x(x,y) u_1 + f_y(x,y) u_2
        </men>
      </p>
    </theorem>
    <p>
      To use Equation <xref ref="eq_10_6_DD"/>, we must have a <em>unit</em> vector <m>\vu = \langle u_1, u_2 \rangle</m> in the direction of motion. In the event that we have a direction prescribed by a non-unit vector, we must first scale the vector to have length 1.
    </p>
    
    <activity xml:id="A_10_6_2">
      <introduction>
        <p>
          In this activity, we will practice using Equation <xref ref="eq_10_6_DD"/> to calculate some directional derivatives and make sense of these results for a few cases. For all parts of this activity, let <m>f(x,y) = 3xy-x^2y^3</m>.
        </p>
      </introduction>
      <task>
        <statement>
          <p>
            Calculate <m>f_x(x,y)</m> and <m>f_y(x,y)</m>.
          </p>
        </statement>
        <answer>
          <p>
            <me>
              \frac{\partial f}{\partial x} = 3y-2xy^3 \ \ \text{ and }  \ \ \frac{\partial f}{\partial y} = 3x - 3x^2y^2
            </me>
          </p>
        </answer>
        <solution>
          <p>
            <me>
              \frac{\partial f}{\partial x} = 3y-2xy^3 \ \ \text{ and }  \ \ \frac{\partial f}{\partial y} = 3x - 3x^2y^2
            </me>
          </p>
        </solution>
      </task>
      <task>
        <statement>
          <p>
            Use Equation<nbsp/><xref ref="eq_10_6_DD"/> to determine <m>D_{\vi} f(x,y)</m> and <m>D_{\vj} f(x,y)</m>. Write a couple of sentences to describe what familiar functions <m>D_{\vi} f</m> and <m>D_{\vj} f</m> are. Remember that <m>\vi</m> is the unit vector in the positive <m>x</m>-direction and <m>\vj</m> is the unit vector in the positive <m>y</m>-direction.
          </p>
        </statement>
        <answer>
          <p>
            <me>
                D_{\vi}f(x,y) = f_x(x,y)
              </me>,
              <me>
                D_{\vj}f(x,y) = f_y(x,y)
              </me>
          </p>
        </answer>
        <solution>
          <p>
            Since <m>\vi = \langle 1, 0 \rangle</m>, we have
            <me>
              D_{\vi}f(x,y) = f_x(x,y)(1) + f_y(x,y)(0) = f_x(x,y)
            </me>.
            So the derivative of <m>f</m> in the direction of the vector <m>\vi</m> is just the partial derivative of <m>f</m> with respect to <m>x</m>. Similarly,
            <me>
              D_{\vj}f(x,y) = f_x(x,y)(0) + f_y(x,y)(1) = f_y(x,y)
            </me>.
            So the derivative of <m>f</m> in the direction of the vector <m>\vj</m> is just the partial derivative of <m>f</m> with respect to <m>y</m>.
          </p>
        </solution>
      </task>
      <task>
        <statement>
          <p>
            Use Equation<nbsp/><xref ref="eq_10_6_DD"/> to find the derivative of <m>f</m> in the direction of the vector <m>\vv = \langle 2, 3 \rangle</m> at the point <m>(1,-1)</m>.  Remember that a unit direction vector is needed.
          </p>
        </statement>
        <answer>
          <p>
            <me>
                D_{\vv}f(1,-1) = -\frac{2}{\sqrt{13}}
              </me>
          </p>
        </answer>
        <solution>
          <p>
            At the point <m>(1,-1)</m> we have
              <me>
                f_x(1,-1) = -1 \ \ \text{ and }  \ \ f_y(1,-1) = 0
              </me>.
              So the derivative of <m>f</m> in the direction of the unit vector
              <m>\frac{1}{|\vv|} \vv = \frac{1}{\sqrt{13}}\langle 2, 3 \rangle</m> at the point <m>(1,-1)</m> is
              <me>
                D_{\vv}f(1,-1) = f_x(1,-1) \left(\frac{2}{\sqrt{13}}\right) + f_y(1,-1) \left(\frac{3}{\sqrt{13}}\right) = -\frac{2}{\sqrt{13}}
              </me>
          </p>
        </solution>
      </task>
      <task>
        <statement>
          <p>
            Use Equation<nbsp/><xref ref="eq_10_6_DD"/> to find the derivative of <m>f</m> in the direction of the vector <m>\vv = \langle 4, 6 \rangle</m> at the point <m>(1,-1)</m>.           
          </p>
        </statement>
         <answer>
          <p>
            <me>
                D_{\vv}f(1,-1) = -\frac{2}{\sqrt{13}}
              </me>
          </p>
        </answer>
        <solution>
          <p>
            At the point <m>(1,-1)</m> we have
            <me>
              f_x(1,-1) = -1 \ \ \text{ and }  \ \ f_y(1,-1) = 0
            </me>.
            So the derivative of <m>f</m> in the direction of the unit vector
            <m>\frac{1}{|\vv|} \vv = \frac{1}{2\sqrt{13}}\langle 4,63 \rangle</m> at the point <m>(1,-1)</m> is
            <me>
              D_{\vv}f(1,-1) = f_x(1,-1) \left(\frac{2}{2\sqrt{13}}\right) + f_y(1,-1) \left(\frac{3}{2\sqrt{13}}\right) = -\frac{2}{2\sqrt{13}}
            </me>
            The result is the same as the previous task because the unit vector in the given direction is the same.
          </p>
        </solution>
      </task>
      <task>
        <statement>
          <p>
            Use Equation<nbsp/><xref ref="eq_10_6_DD"/> to find the derivative of <m>f</m> in the direction of the vector <m>\vv = \langle -2, -3 \rangle</m> at the point <m>(1,-1)</m>. Write a couple of sentences to explain how this result is different than your answer to the previous two tasks, even though the direction vectors are parallel.
          </p>
        </statement>
         <answer>
          <p>
            <me>
                D_{\vv}f(1,-1) = \frac{2}{\sqrt{13}}
              </me>
          </p>
        </answer>
        <solution>
          <p>
            At the point <m>(1,-1)</m> we have
            <me>
              f_x(1,-1) = -1 \ \ \text{ and }  \ \ f_y(1,-1) = 0
            </me>.
            So the derivative of <m>f</m> in the direction of the unit vector
            <m>\frac{1}{|\vv|} \vv = \frac{1}{\sqrt{13}}\langle -2, -3 \rangle</m> at the point <m>(1,-1)</m> is
            <me>
              D_{\vv}f(1,-1) = f_x(1,-1) \left(\frac{-2}{\sqrt{13}}\right) + f_y(1,-1) \left(\frac{-3}{\sqrt{13}}\right) = \frac{2}{\sqrt{13}}
            </me>
            Because our direction vector is in the opposite direction, we ended up with a directional derivative having the same magnitude but a positive value. This should make sense because if we were going down the surface in the direction <m>\langle 2, 3 \rangle</m>, then the surface is going up in exactly the same way in the direction <m>\langle -2, -3 \rangle</m>. 
          </p>
        </solution>
      </task>    
    </activity>
    <p>
      We found Equation<xref ref="eq_10_6_DD"/> by considering our <xref ref="defn-DD">definition for the directional derivative</xref> as a composition of functions and utilizing our chain rule. A very useful idea when we have multivariable functions that are locally linear is that evaluating a limit for how the function is changing near a point will give the same result as asking what the corresponding change would be on the linearization or tangent plane. Remember that on very small scales there is virtually no difference between the (locally linear) function and the linearization as demonstrated by <xref ref="F_10_4_tangent_2"/>. 
    </p>
    <p>
      The equation of the plane tangent to the graph of <m>f</m> at the point <m>(x_0,y_0,f(x_0,y_0))</m> is
      <men>
        z = f(x_0,y_0) + f_x(x_0,y_0)(x-x_0) + f_y(x_0,y_0)(y-y_0)
      </men>
      If <m>f</m> is a locally linear function, then the directional derivative <m>D_{\vu}f(x_0,y_0)</m> will be the same as the rate of change along the tangent plane in the direction of <m>\vu</m>. Remember that the rate of change will be the same regardless of step size on the tangent plane (this is NOT true on the surface <m>z=f(x,y)</m>). So we will look at the quotient
      <md>
        <mrow>\frac{z(x_0+u_1,y_0+u_2)-z(x_0,y_0)}{\sqrt{u_1^2+u_2^2}}</mrow>
        <mrow> \quad \quad =\frac{\left(f(x_0,y_0) + f_x(x_0,y_0)(x_0+u_1-x_0) + f_y(x_0,y_0)(y_0+u_2-y_0)\right)-f(x_0,y_0)}{1}</mrow>
        <mrow> \quad \quad = f_x(x_0,y_0) (u_1) + f_y(x_0,y_0)(u_2)</mrow>
      </md>
      which is exactly the result <xref ref="eq_10_6_DD"/>. 
    </p>
  </subsection>



  <subsection xml:id="gradient_ss">
    <title>The Gradient</title>
    <p>
      Via the Chain Rule and the linearization, we have seen that for a given function <m>f = f(x,y)</m>, its instantaneous rate of change in the direction of a unit vector <m>\vu = \langle u_1, u_2 \rangle</m> is given by
      <men xml:id="E_DDrevisited">
        D_{\vu}f(x_0,y_0) = f_x(x_0,y_0)u_1 + f_y(x_0,y_0)u_2
      </men>
      In particular, we saw how the rate of change along the linearization in a given direction is given by a linear combination of the rates of change in the coordinate directions (partial derivatives) where the weight of each partial derivative comes from the components of our unit vector. You may recognize the form of <xref ref="E_DDrevisited"/> as being similar to a dot product.
    </p>
    <p>
      Recall the dot product of two vectors <m>\vv = \langle v_1, v_2 \rangle</m> and <m>\vu = \langle u_1, u_2 \rangle</m> is computed by
      <me>
        \vv \cdot \vu = v_1 u_1 + v_2 u_2
      </me>
      Thus we may recast Equation<nbsp/><xref ref="E_DDrevisited"/> in a way that has geometric meaning related to the dot product. In particular, we see that <m>D_{\vu}f(x_0,y_0)</m> is the dot product of the vector <m>\left\langle f_x(x_0,y_0), f_y(x_0,y_0) \right\rangle</m> and the vector <m>\vu</m>. This is particularly useful because the vector <m>\left\langle f_x(x_0,y_0), f_y(x_0,y_0) \right\rangle</m> comes from simple calculations that tell us how the function <m>f</m> is changing near the input <m>(x_0,y_0)</m>. We give this vector a special name and will spend most of the rest of this section talking about the importance of this vector.
    </p>
    <definition xml:id="def-gradient">
      <statement>
        <p>
          The vector formed by partial derivatives of <m>f</m> is called the <em>gradient</em> of <m>f</m> and denote it
          <me>
            \nabla f(x_0,y_0) = \left\langle f_x(x_0,y_0), f_y(x_0,y_0) \right\rangle.
          </me>
        </p>
      </statement>
    </definition>
    <p>
      We read <m>\nabla f</m> as <q>the gradient of <m>f</m>,</q> <q>grad <m>f</m></q> or <q>del <m>f</m></q>.
      <fn>The symbol <m>\nabla</m> is called <em>nabla</em>, which comes from a Greek word for a certain type of harp that has a similar shape.</fn>
      Notice that <m>\nabla f</m> varies from point to point, and also provides an alternate formulation of the directional derivative.
    </p>
    <assemblage xml:id="Directional-derivative-gradient">
      <title>The directional derivative and the gradient</title>
      <p>
        Given a differentiable function <m>f = f(x,y)</m> and a unit vector <m>\vu = \langle u_1, u_2 \rangle</m>, we may compute <m>D_{\vu}f(x,y)</m> by
        <men xml:id="eq_10_6_DD_grad">
          D_{\vu}f(x,y) = \nabla f(x,y) \cdot \vu.
        </men>
      </p>
    </assemblage>
    <p>
     In the following activity, we investigate some of what the gradient tells us about the behavior of a function <m>f</m>.
    </p>
    <activity xml:id="A_10_6_10">
      <introduction>
        <p>
          Let's consider the function <m>f</m> defined by <m>f(x,y) = \frac{1}{3}(x^2-y^2)</m>. Some contours for this function are shown in <xref ref="CCA-DD4">Figure</xref>.
        </p>
        <!-- <figure xml:id="F_10_6_activity_1">
          <caption>Contours of <m>f(x,y) = x^2 - y^2</m>.</caption>
          <image width="50%" source="images/fig_10_6_contours_1"/>
        </figure> -->
        <figure xml:id="CCA-DD4">
          <caption>A contour plot of <m>f(x,y)=\frac{1}{3}(x^2-y^2)</m></caption>
          <image width="60%" xml:id="img-DDcontour4">
            <sageplot>
              var('x,y,z,t,s')
              f(x,y)=1/3*(x^2-y^2)
              c=[i for i in range(-4,5)]
              plot5=contour_plot(f(x,y),(x,-4,4),(y,-4,4),fill=False,contours=c,labels=True,label_fmt="%1.0f",gridlines=True,label_inline=True,label_inline_spacing=5)
              plot5
            </sageplot>
          </image>
        </figure>
      </introduction>
      <task>
        <statement>
          <p>
            Find the gradient <m>\nabla f (x,y)</m>.
          </p>
        </statement>
        <answer>
          <p>
            <me>
              \nabla f (x,y) = \langle 2x, -2y \rangle
            </me>
          </p>
        </answer>
        <solution>
          <p>
            By definition,
            <me>
              \nabla f (x,y) = \langle f_x(x,y), f_y(x,y) \rangle = \langle 2x, -2y \rangle
            </me>
          </p>
        </solution>
      </task>
      <task>
        <statement>
          <p>
            For each of the following points <m>(x_0,y_0)</m>, evaluate the gradient <m>\nabla f(x_0,y_0)</m> and sketch the gradient vector with its tail at <m>(x_0,y_0)</m>.  Some of the vectors are too long to fit onto the plot, but we'd like to draw them to scale; to do so, scale each vector by a factor of 1/2.
              <ul>
                <li> <m>(x_0,y_0) = (2,0)</m> </li>
                <li> <m>(x_0,y_0) = (0,2)</m> </li>
                <li> <m>(x_0,y_0) = (2,2)</m> </li>
                <li> <m>(x_0,y_0) = (2,1)</m> </li>
                <li> <m>(x_0,y_0) = (-3,2)</m> </li>
                <li> <m>(x_0,y_0) = (-2,-4)</m> </li>
                <li> <m>(x_0,y_0) = (0,0)</m> </li>
              </ul>
          </p>
        </statement>
        <answer>
          <p>
            <md>
              <mrow>\nabla f(2,0) \amp = \langle 4,0 \rangle</mrow>
              <mrow>\nabla f(0,2) \amp = \langle 0,-4 \rangle</mrow>
              <mrow>\nabla f(2,2) \amp = \langle 4,-4 \rangle</mrow>
              <mrow>\nabla f(2,1) \amp = \langle 4,-2 \rangle</mrow>
              <mrow>\nabla f(-3,2) \amp = \langle -3,-4 \rangle</mrow>
              <mrow>\nabla f(-2,-4) \amp = \langle -4,8 \rangle</mrow>
              <mrow>\nabla f (0,0) \amp = \langle 0,0 \rangle</mrow>
            </md>
            A picture of the scaled gradients are shown here.
          </p>
          <image width="73%" source="images/fig_10_6_Act_10_contours"/>
        </answer>
        <solution>
          <p>
          <md>
              <mrow>\nabla f(2,0) \amp = \langle 4,0 \rangle</mrow>
              <mrow>\nabla f(0,2) \amp = \langle 0,-4 \rangle</mrow>
              <mrow>\nabla f(2,2) \amp = \langle 4,-4 \rangle</mrow>
              <mrow>\nabla f(2,1) \amp = \langle 4,-2 \rangle</mrow>
              <mrow>\nabla f(-3,2) \amp = \langle -3,-4 \rangle</mrow>
              <mrow>\nabla f(-2,-4) \amp = \langle -4,8 \rangle</mrow>
              <mrow>\nabla f (0,0) \amp = \langle 0,0 \rangle</mrow>
            </md>
            A picture of the scaled gradients are shown here.
          </p>
          <image width="73%" source="images/fig_10_6_Act_10_contours"/>
        </solution>
      </task>
      <task>
        <statement>
          <p>
            Write a few sentences about how the direction of the gradient at each of these points is related to the the contour passing through that point.
          </p>
        </statement>
        <answer>
          <p>
            It appears that each gradient is orthogonal to the contour containing its tail.
          </p>
        </answer>
        <solution>
          <p>
            It appears that each gradient is orthogonal to the contour containing its tail.
          </p>
        </solution>
      </task>  
      <task>
        <statement>
          <p>
            Does the output of <m>f</m> increase or decrease in the direction of <m>\nabla f(x_0,y_0)</m>?  Write a few sentences and use examples from the points above to justify your answer. 
          </p>
        </statement>
        <answer>
          <p>
            The gradient points in the direction of increase for <m>f</m>.
          </p>
        </answer>
        <solution>
          <p>
            In the first quadrant, as <m>x</m> increases so does <m>f(x,y)</m>. So these gradients all point in a direction of increase of <m>f</m>. In the second quadrant, as <m>x</m> decreases <m>f(x,y)</m> increases. So these gradients all point in a direction of increase of <m>f</m>. In the third quadrant, as <m>y</m> increases so does <m>f(x,y)</m>. So these gradients all point in a direction of increase of <m>f</m>. Finally, at the point <m>(0,2)</m>, <m>f</m> increases as <m>y</m> decreases. So every gradient points in a direction of increase of <m>f</m>.
          </p>
        </solution>
      </task>
    </activity>

    <p>
      As a vector, <m>\nabla f(x_0,y_0)</m> defines a direction and a length. As we will soon see, both of these convey important information about the behavior of <m>f</m> near
      <m>(x_0,y_0)</m>.
    </p>
  </subsection>


  <subsection>
    <title>The Direction of the Gradient</title>
    <p>
      Remember that the dot product also conveys information about the angle
      between the two vectors. If <m>\theta</m> is the angle between <m>\nabla
      f(x_0,y_0)</m> and <m>\vu</m> (where <m>\vu</m> is a unit vector),
      then we also have that
      <me>
        D_{\vu}f(x_0,y_0) = \nabla f(x_0,y_0)\cdot\vu = |\nabla f(x_0,y_0)||\vu|
        \cos(\theta).
      </me>
    </p>

    <p>
      In particular, when <m>\theta</m> is a right angle, as shown on the left of
      <xref ref="F_10_6_gradient_sign">Figure</xref>, then <m>D_{\vu}f(x_0,y_0) = 0</m>, because <m>\cos(\theta) = 0</m>. Since the value of the directional derivative is 0, this means that <m>f</m> is unchanging in this direction, and hence <m>\vu</m> must be tangent to the contour of <m>f</m> that passes through <m>(x_0,y_0)</m>. In other words, <m>\nabla f(x_0,y_0)</m> is orthogonal to the
      contour through <m>(x_0,y_0)</m>. This shows that the gradient vector at a given point is always perpendicular to the contour passing through the point, confirming that what we saw in part (c) of <xref ref="A_10_6_10">Activity</xref> holds in general.
    </p>

    <figure xml:id="F_10_6_gradient_sign">
      <caption>The sign of <m>D_{\vu} f(x_0,y_0)</m> is determined by <m>\theta</m>.</caption>
      <sidebyside widths="33% 33% 33%">
      <image source="images/fig_10_6_gradient_angle_1"/>
      <image source="images/fig_10_6_gradient_angle_2"/>
      <image source="images/fig_10_6_gradient_angle_3"/>
      </sidebyside>
    </figure>

    <p>
      Moreover, when <m>\theta</m> is an acute angle, it follows that <m>\cos(\theta) &gt; 0</m> so since
      <me>
        D_{\vu}f(x_0,y_0) = |\nabla f(x_0,y_0)||\vu|
        \cos(\theta),
      </me>
      and therefore <m>D_{\vu}f(x_0,y_0) &gt; 0</m>, as shown in the middle image in <xref ref="F_10_6_gradient_sign">Figure</xref>. This means that <m>f</m> is increasing in any direction where
      <m>\theta</m> is acute. In a similar way, when <m>\theta</m> is an obtuse angle, then <m>\cos(\theta) \lt  0</m> so <m>D_{\vu}f(x_0,y_0) \lt  0</m>, as seen on the right in <xref ref="F_10_6_gradient_sign">Figure</xref>. This
      means that <m>f</m> is decreasing in any direction for which <m>\theta</m> is obtuse.
    </p>

    <p>
      Finally, as we can see in the following activity, we may also use the gradient to determine the directions in which the function is increasing and decreasing most rapidly.
    </p>

    <activity xml:id="A_10_6_3">
      <statement>
        <p>
          In this activity we investigate how the gradient is related to the directions of greatest increase and decrease of a function. Let <m>f</m> be a differentiable function and <m>\vu</m> a unit vector.
          <ol marker="a.">
            <li>
              <p>
                Let <m>\theta</m> be the angle between <m>\nabla f(x_0,y_0)</m> and <m>\vu</m>.  Use the relationship between the dot product and the angle between two vectors to explain why
                <men xml:id="eq_10_6_DD_grad2">
                  D_{\vu} f(x_0,y_0) = |\langle f_x(x_0,y_0), f_y(x_0,y_0) \rangle | \cos(\theta).
                </men>
              </p>
            </li>

            <li>
              <p>
                At the point <m>(x_0,y_0)</m>, the only quantity in Equation<nbsp/><xref ref="eq_10_6_DD_grad2"/> that can change is <m>\theta</m> (which determines the direction <m>\vu</m> of travel). Explain why <m>\theta = 0</m> makes the quantity
                <me>
                  |\langle f_x(x_0,y_0), f_y(x_0,y_0) \rangle| \cos(\theta)
                </me>
                as large as possible.
              </p>
            </li>

            <li>
              <p>
                When <m>\theta = 0</m>, in what direction does the unit vector <m>\vu</m> point relative to <m>\nabla f(x_0,y_0)</m>? Why? What does this tell us about the direction of greatest increase of <m>f</m> at the point <m>(x_0,y_0)</m>?
              </p>
            </li>

            <li>
              <p>
                In what direction, relative to <m>\nabla f(x_0,y_0)</m>, does <m>f</m> decrease most rapidly at the point <m>(x_0,y_0)</m>?
              </p>
            </li>

            <li>
              <p>
                State the unit vectors <m>\vu</m> and <m>\vv</m> (in terms of <m>\nabla f(x_0,y_0)</m>) that provide the directions of greatest increase and decrease for the function <m>f</m> at the point <m>(x_0,y_0)</m>.  What important assumption must we make regarding <m>\nabla f(x_0,y_0)</m> in order for these vectors to exist?
              </p>
            </li>
          </ol>
        </p>
      </statement>
      
      <answer>
        <ol marker="a.">
          <li>
            <p>
              Using the dot product we can see that
              <me>
                D_{\vu} f(x_0,y_0) = \langle f_x(x_0,y_0), f_y(x_0,y_0) \rangle \cdot \vu = |\langle f_x(x_0,y_0), f_y(x_0,y_0) \rangle| \cos(\theta)
              </me>,
              where <m>\theta</m> is the angle between <m>\langle f_x(x_0,y_0),
              f_y(x_0,y_0) \rangle</m> and <m>\vu</m>.
            </p>
          </li>
          <li>
            <p>
              The maximum value of <m>D_{\vu} f(x_0,y_0)</m> will occur when
              <m>\cos(\theta)</m> is as large as possible.
              This happens when <m>\cos(\theta) = 1</m> or <m>\theta = 0</m>.
            </p>
          </li>
          <li>
            <p>
              When <m>\theta = 0</m>,
              the angle between the vector <m>\vu</m> and the vector
              <m>\langle f_x(x_0,y_0),
              f_y(x_0,y_0) \rangle</m> is 0, so the vector <m>\vu</m> must have the same direction as <m>\langle f_x(x_0,y_0), f_y(x_0,y_0) \rangle</m>.
              In other words,
              the direction of greatest increase of <m>f</m> at the point
              <m>(x_0,y_0)</m> is the direction of the vector <m>\langle f_x(x_0,y_0), f_y(x_0,y_0) \rangle</m>.
            </p>
          </li>
          <li>
            <p>
              <m>-\langle f_x(x_0,y_0), f_y(x_0,y_0) \rangle</m>
            </p>
          </li>
          <li>
            <p>
              The unit vector that provides the direction of greatest increase in <m>f</m> at the point <m>(x_0,y_0)</m> is
              <m>\vu=\frac{1}{|\nabla f(x_0,y_0)|} \nabla f(x_0,y_0)</m> and the unit vector that provides the direction of greatest decrease in <m>f</m> at the point
              <m>(x_0,y_0)</m> is <m>\vv = -\vu</m>.
              For either vector to exist,
              it must be the case that <m>\nabla f(x_0,y_0) \neq \langle 0,0 \rangle</m>.
            </p>
          </li>
        </ol>
      </answer>


      <solution>
        <ol marker="a.">
          <li>
            <p>
              Using the dot product we can see that
              <me>
                D_{\vu} f(x_0,y_0) = \langle f_x(x_0,y_0), f_y(x_0,y_0) \rangle \cdot \vu = |\langle f_x(x_0,y_0), f_y(x_0,y_0) \rangle| \cos(\theta)
              </me>,
              where <m>\theta</m> is the angle between <m>\langle f_x(x_0,y_0),
              f_y(x_0,y_0) \rangle</m> and <m>\vu</m>.
            </p>
          </li>
          <li>
            <p>
              The maximum value of <m>D_{\vu} f(x_0,y_0)</m> will occur when
              <m>\cos(\theta)</m> is as large as possible.
              This happens when <m>\cos(\theta) = 1</m> or <m>\theta = 0</m>.
            </p>
          </li>
          <li>
            <p>
              When <m>\theta = 0</m>,
              the angle between the vector <m>\vu</m> and the vector
              <m>\langle f_x(x_0,y_0),
              f_y(x_0,y_0) \rangle</m> is 0, so the vector <m>\vu</m> must have the same direction as <m>\langle f_x(x_0,y_0), f_y(x_0,y_0) \rangle</m>.
              In other words,
              the direction of greatest increase of <m>f</m> at the point
              <m>(x_0,y_0)</m> is the direction of the vector <m>\langle f_x(x_0,y_0), f_y(x_0,y_0) \rangle</m>.
            </p>
          </li>
          <li>
            <p>
              If <m>f</m> increases most rapidly in the direction of
              <m>\langle f_x(x_0,y_0),
              f_y(x_0,y_0) \rangle</m> at the point <m>(x_0,y_0)</m>,
              then <m>f</m> must decrease most rapidly in the opposite direction,
              or in the direction of <m>-\langle f_x(x_0,y_0), f_y(x_0,y_0) \rangle</m>.
            </p>
          </li>
          <li>
            <p>
              The unit vector that provides the direction of greatest increase in <m>f</m> at the point <m>(x_0,y_0)</m> is
              <m>\vu=\frac{1}{|\nabla f(x_0,y_0)|} \nabla f(x_0,y_0)</m> and the unit vector that provides the direction of greatest decrease in <m>f</m> at the point
              <m>(x_0,y_0)</m> is <m>\vv = -\vu</m>.
              For either vector to exist,
              it must be the case that <m>\nabla f(x_0,y_0) \neq \langle 0,0 \rangle</m>.
            </p>
          </li>
        </ol>
      </solution>

      
    </activity>
  </subsection>



  <subsection>
    <title>The Length of the Gradient</title>
    <p>
      Having established in <xref ref="A_10_6_3">Activity</xref> that the direction in which a function increases most rapidly at a point <m>(x_0,y_0)</m> is the unit vector <m>\vu</m> in the direction of the gradient, (that is, <m>\vu = \frac{1}{|\nabla f(x_0,y_0)|} \nabla f(x_0,y_0)</m>, provided that <m>\nabla f(x_0,y_0) \ne \vzero</m>), it is also natural to ask, <q>in the direction of greatest increase for <m>f</m> at <m>(x_0,y_0)</m>, what is the <em>value</em> of the rate of increase?</q> In this situation, we are asking for the value of <m>D_{\vu} f(x_0,y_0)</m> where <m>\vu = \frac{1}{|\nabla f(x_0,y_0)|} \nabla f(x_0,y_0)</m>.
    </p>

    <p>
      Using the now familiar way to compute the directional derivative, we see that
      <me>
        D_{\vu} f(x_0,y_0) = \nabla f(x_0,y_0) \cdot \left(\frac{1}{|\nabla f(x_0,y_0)|} \nabla f(x_0,y_0) \right).
      </me>
    </p>

    <p>
      Next, we recall two important facts about the dot product: (i) <m>\vw\cdot (c \vv) = c (\vw \cdot \vv)</m> for any scalar <m>c</m>, and (ii) <m>\vw \cdot \vw = |\vw|^2</m>. Applying these properties to the most recent equation involving the directional derivative, we find that
      <me>
        D_{\vu} f(x_0,y_0) = \frac{1}{|\nabla f(x_0,y_0)|}  (\nabla f(x_0,y_0) \cdot \nabla f(x_0,y_0)) = \frac{1}{|\nabla f(x_0,y_0)|} |\nabla f(x_0,y_0)|^2.
      </me>
    </p>

    <p>
      Finally, since <m>\nabla f(x_0,y_0)</m> is a nonzero vector, its length <m>|\nabla f(x_0,y_0)|</m> is a nonzero scalar, and thus we can simplify the preceding equation to establish that
      <me>
        D_{\vu} f(x_0,y_0) = |\nabla f(x_0,y_0)|.
      </me>
    </p>

    <p>
      We summarize our most recent work by stating two important facts about the gradient.
    </p>

    <assemblage xml:id="Gradient">
      <title>Important facts about the gradient</title>
     <p>
      Let <m>f</m> be a differentiable function and <m>(x_0,y_0)</m> a point for which <m>\nabla f(x_0,y_0) \ne \vzero</m>. Then <m>\nabla f(x_0,y_0)</m> points in the direction of greatest increase of <m>f</m> at <m>(x_0,y_0)</m>, and the instantaneous rate of change of <m>f</m> in that direction is the length of the gradient vector. That is, if <m>\vu = \frac{1}{|\nabla f(x_0,y_0)|} \nabla f(x_0,y_0)</m>, then <m>\vu</m> is a unit vector in the direction of greatest increase of <m>f</m> at <m>(x_0,y_0)</m>, and <m>D_{\vu} f(x_0,y_0) = |\nabla f(x_0,y_0)|</m>.
    </p>
    </assemblage>
   

    <activity xml:id="A_10_6_11">
      <statement>
        <p>
          Consider the function <m>f</m> defined by <m>f(x,y) = -x + 2xy - y</m>.
          <ol marker="a.">
            <li>
              <p>
                Find the gradient <m>\nabla f(1,2)</m> and sketch it on <xref ref="F_10_6_activity_empty">Figure</xref>.

                <figure xml:id="F_10_6_activity_empty">
                  <caption>A plot for the gradient <m>\nabla f(1,2)</m>.</caption>
                  <image width="50%" source="images/fig_10_6_activity_empty"/>
                </figure>

              </p>
            </li>

            <li>
              <p>
                Sketch the unit vector <m>\vz = \left\langle-\frac1{\sqrt{2}},
                    -\frac1{\sqrt{2}}\right\rangle</m> on <xref ref="F_10_6_activity_empty">Figure</xref> with its tail at <m>(1,2)</m>.
                  Now find the directional derivative <m>D_{\vz}f(1,2)</m>.
              </p>
            </li>

            <li>
              <p>
                What is the slope of the graph of <m>f</m> in the direction <m>\vz</m>?  
                  What does the sign of the directional derivative tell you?
              </p>
            </li>

            <li>
              <p>
                Consider the vector <m>\vv = \langle 2,-1\rangle</m> and sketch <m>\vv</m>
                  on <xref ref="F_10_6_activity_empty">Figure</xref> with its tail at <m>(1,2)</m>.
                  Find a unit vector <m>\vw</m> pointing in the same direction of <m>\vv</m>.
                  Without computing <m>D_{\vw}f(1,2)</m>, what do you know about the sign
                  of this directional derivative?  Now verify your observation by
                  computing <m>D_{\vw}f(1,2)</m>.
              </p>
            </li>

            <li>
              <p>
                In which direction (that is, for what unit vector <m>\vu</m>) is <m>D_{\vu}f(1,2)</m>
                  the greatest?  What is the slope of the graph in this direction?
              </p>
            </li>

            <li>
              <p>
                Corresponding, in which direction is <m>D_{\vu}f(1,2)</m> least?  What is the slope of the graph in this direction?
              </p>
            </li>

            <li>
              <p>
                Sketch two unit vectors <m>\vu</m> for which <m>D_{\vu}f(1,2) = 0</m> and
                  then find component representations of these vectors.
              </p>
            </li>

            <li>
              <p>
                Suppose you are standing at the point <m>(3,3)</m>.  In which
                  direction should you move to cause <m>f</m> to increase as rapidly as
                  possible?  At what rate does <m>f</m> increase in this direction?
              </p>
            </li>
          </ol>
        </p>
      </statement>

      <answer>
        <ol marker="a.">
          <li>
            <p>
              <me>
                \nabla f(1,2) = \langle f_x(1,2), f_y(1,2) \rangle = \langle 2,1\rangle
              </me>
              A plot of  <m>\nabla f(1,2)</m> is shown below.
            </p>
          </li>
          <li>
            <p>
              A plot of <m>\vz</m> is shown below.
              <m>D_{\vz}f(1,2) = -\frac{4}{\sqrt{2}} </m>
            </p>
          </li>
          <li>
            <p>
              The directional derivative
              <m>D_{\vz}f(1,2)</m> tells us the slope of <m>f</m> in the direction of <m>\vz</m> at the point <m>(1,2)</m>,
              so this slope is <m>-\frac{4}{\sqrt{2}}</m>.
              The fact that <m>D_{\vz}f(1,2)</m> is negative tells us that the graph of <m>f</m> is decreasing in the direction of <m>\vz</m> from the point <m>(1,2)</m>.
            </p>
          </li>
          <li>
            <p>
              The angle between the vector <m>\vv</m> or the vector <m>\vw = \frac{1}{|\vv|} \vv = \frac{1}{\sqrt{5}}\langle 2, -1 \rangle</m>
              (shown below)
              and <m>\nabla f(1,2)</m> is acute,
              so we expect <m>f</m> to be increasing in this direction.
              <m> D_{\vw}f(1,2) = \frac{5}{\sqrt{5}} </m>
              <image width="73%" source="images/fig_10_6_Act_11_gradient"/>
            </p>
          </li>
          <li>
            <p>
              We know that <m>f</m> increases most rapidly in the direction of the gradient.
              So <m>D_{\vu}f(1,2)</m> is greatest when
              <me>
                \vu = \frac{1}{|\nabla f(1,2)|} \nabla f(1,2) =  \frac{1}{\sqrt{10}}\langle 3,1 \rangle
              </me>.
              The slope of the graph of <m>f</m> in the direction of
              <m>\nabla f(1,2)</m> at the point <m>(1,2)</m> is
              <me>
                D_{\vu}f(1,2) = \sqrt{10}
              </me>.
            </p>
          </li>
          <li>
            <p>
              The function <m>f</m> decreases most rapidly in the direction opposite of the gradient.
              So <m>D_{\vu}f(1,2)</m> is least when
              <me>
                \vu = -\frac{1}{|\nabla f(1,2)|} \nabla f(1,2) =  -\frac{1}{\sqrt{10}}\langle 3,1 \rangle
              </me>.
              The slope of the graph of <m>f</m> in the direction of
              <m>-\nabla f(1,2)</m> at the point <m>(1,2)</m> is
              <me>
                D_{\vu}f(1,2) =  -\sqrt{10}
              </me>.
            </p>
          </li>
          <li>
            <p>
              Recall that <m>D_{\vu}f(1,2) = \nabla f(1,2) \cdot \vu</m>,
              so <m>D_{\vu}f(1,2) = 0</m> when <m>\vu</m> is perpendicular to <m>\nabla f(1,2)</m>.
              By inspection, two such vectors are
              <m>\frac{1}{\sqrt{10}}\langle 1, -3 \rangle</m> and <m>\frac{1}{\sqrt{10}}\langle -1,3 \rangle</m>.
            </p>
          </li>
          <li>
            <p>
              The direction in which <m>f</m> increases most rapidly at the point <m>(3,3)</m> is in the direction of the gradient vector at <m>(3,3)</m>, so in the direction of 
              <me>
                \nabla f(3,3) = \langle 5, 5 \rangle
              </me>
              or the unit vector
              <me>
                \vu=\frac{1}{|\nabla f(3,3)|}\nabla f(3,3) = \frac{1}{\sqrt{50}}\langle 5, 5 \rangle
              </me>.
              The rate of increase of <m>f</m> in this direction is
              <me>
                D_{\vu} f (3,3) =\sqrt{50}
              </me>.
            </p>
          </li>
        </ol>
      </answer>
      
      <solution>
        <ol marker="a.">
          <li>
            <p>
              The gradient of <m>f</m> at <m>(x,y)</m> is
              <me>
                \nabla f(x,y) = \langle f_x(x,y), f_y(x,y) \rangle = \langle -1 + 2y, 2x - 1\rangle
              </me>,
            so the gradient of <m>f</m> at <m>(1,2)</m> is
              <me>
                \nabla f(1,2) = \langle f_x(1,2), f_y(1,2) \rangle = \langle 2,1\rangle
              </me>.
              A plot of  <m>\nabla f(1,2)</m> is shown below.
            </p>
          </li>
          <li>
            <p>
              A plot of <m>\vz</m> is shown below.
              The directional derivative <m>D_{\vz}f(1,2)</m> is
              <md>
                <mrow> D_{\vz}f(1,2) \amp = \nabla f(1, 2) \cdot {\vz}  = \langle 2, 1 \rangle \dot \langle -\frac{1}{\sqrt{2}}, -\frac{1}{\sqrt{2}}\rangle </mrow>
                <mrow> \amp = -\frac{3}{\sqrt{2}} + -\frac{3}{\sqrt{2}} = -\frac{4}{\sqrt{2}} </mrow>
              </md>.
            </p>
          </li>
          <li>
            <p>
              The directional derivative
              <m>D_{\vz}f(1,2)</m> tells us the slope of <m>f</m> in the direction of <m>\vz</m> at the point <m>(1,2)</m>,
              so this slope is <m>-\frac{4}{\sqrt{2}}</m>.
              The fact that <m>D_{\vz}f(1,2)</m> is negative tells us that the graph of <m>f</m> is decreasing in the direction of <m>\vz</m> from the point <m>(1,2)</m>.
            </p>
          </li>
          <li>
            <p>
              The angle between the vector <m>\vv</m> or the vector <m>\vw = \frac{1}{|\vv|} \vv = \frac{1}{\sqrt{5}}\langle 2, -1 \rangle</m>
              (shown below)
              and <m>\nabla f(1,2)</m> is acute,
              so we expect <m>f</m> to be increasing in this direction.
              Note that
              <me>
                D_{\vw}f(1,2) = \nabla f(1, 2) \dot {\vw} = \langle 3, 1 \rangle \cdot \langle \frac{2}{\sqrt{5}},\frac{-1}{\sqrt{5}} \rangle = \frac{5}{\sqrt{5}}
              </me>.
              <image width="73%" source="images/fig_10_6_Act_11_gradient"/>
            </p>
          </li>
          <li>
            <p>
              We know that <m>f</m> increases most rapidly in the direction of the gradient.
              So <m>D_{\vu}f(1,2)</m> is greatest when
              <me>
                \vu = \frac{1}{|\nabla f(1,2)|} \nabla f(1,2) =  \frac{1}{\sqrt{10}}\langle 3,1 \rangle
              </me>.
              The slope of the graph of <m>f</m> in the direction of
              <m>\nabla f(1,2)</m> at the point <m>(1,2)</m> is
              <me>
                D_{\vu}f(1,2) = \nabla f (1, 2) \cdot {\vu} = |\nabla f(1,2)| = \sqrt{10}
              </me>.
            </p>
          </li>
          <li>
            <p>
              The function <m>f</m> decreases most rapidly in the direction opposite of the gradient.
              So <m>D_{\vu}f(1,2)</m> is least when
              <me>
                \vu = -\frac{1}{|\nabla f(1,2)|} \nabla f(1,2) =  -\frac{1}{\sqrt{10}}\langle 3,1 \rangle
              </me>.
              The slope of the graph of <m>f</m> in the direction of
              <m>-\nabla f(1,2)</m> at the point <m>(1,2)</m> is
              <me>
                D_{\vu}f(1,2) = - |\nabla f(1,2)| = -\sqrt{10}
              </me>.
            </p>
          </li>
          <li>
            <p>
              Recall that <m>D_{\vu}f(1,2) = \nabla f(1,2) \cdot \vu</m>,
              so <m>D_{\vu}f(1,2) = 0</m> when <m>\vu</m> is perpendicular to <m>\nabla f(1,2)</m>.
              By inspection, two such vectors are
              <m>\frac{1}{\sqrt{10}}\langle 1, -3 \rangle</m> and <m>\frac{1}{\sqrt{10}}\langle -1,3 \rangle</m>.
            </p>
          </li>
          <li>
            <p>
              The direction in which <m>f</m> increases most rapidly at the point <m>(3,3)</m> is in the direction of the gradient vector at <m>(3,3)</m>, so in the direction of 
              <me>
                \nabla f(3,3) = \langle 5, 5 \rangle
              </me>
              or the unit vector
              <me>
                \vu=\frac{1}{|\nabla f(3,3)|}\nabla f(3,3) = \frac{1}{\sqrt{50}}\langle 5, 5 \rangle
              </me>.
              The rate of increase of <m>f</m> in this direction is
              <me>
                D_{\vu} f (3,3) = |\nabla f(3,3)| = \sqrt{50} = 5 \sqrt{2}
              </me>.
            </p>
          </li>
        </ol>
      </solution>


    </activity>
  </subsection>


  <subsection>
    <title>Applications</title>
    <p>
      The gradient finds many natural applications. For example, situations often arise <mdash/> for instance, constructing a road through the mountains or planning the flow of water across a landscape <mdash/> where we are
      interested in knowing the direction in which a function is increasing
      or decreasing most rapidly.
    </p>

    <p>
      For example, consider a two-dimensional version of how a heat-seeking
      missile might work.(This application is borrowed from United
        States Air Force Academy Department of Mathematical Sciences.)
        <!-- Out of date url at
        <url href="http://www.nku.edu/longa/classes/mat320/mathematica/multcalc.htm"><c>http://www.nku.edu/longa/classes/mat320/mathematica/multcalc.htm</c></url>.) -->
      Suppose that the temperature surrounding a fighter jet can be
      modeled by the function <m>T</m> defined by
      <me>
        T(x,y) = \frac{100}{1+(x-5)^2 + 4(y-2.5)^2},
      </me>
      where <m>(x,y)</m> is a
      point in the plane of the fighter jet and <m>T(x,y)</m> is measured in
      degrees
      Celsius. Some contours and gradients <m>\nabla T</m> are shown on
      the left in <xref ref="F_10_6_missile">Figure</xref>.
    </p>

    <figure xml:id="F_10_6_missile">
      <caption>Contours and gradient for <m>T(x,y)</m> and the missile's path.</caption>
      <sidebyside widths="50% 50%">
      <image source="images/fig_10_6_missile_grad"/>
      <image source="images/fig_10_6_missile_path"/>
      </sidebyside>
    </figure>

    <p>
      A heat-seeking missile will always travel in the direction in which
      the temperature increases most rapidly; that is, it will always
      travel in the direction of the gradient <m>\nabla T</m>. If a missile is
      fired from the point <m>(2,4)</m>, then its path will be that shown on the
      right in <xref ref="F_10_6_missile">Figure</xref>.
    </p>

    <p>
      In the final activity of this section, we consider several questions related to this context of a heat-seeking missile, and foreshadow some upcoming work in <xref ref="S-10-7-Optimization">Section</xref>.
    </p>

    <activity xml:id="A_10_6_13">
      <statement>
        <ol marker="a.">
          <li>
            <p>
              The temperature <m>T(x,y)</m> has its maximum value at the fighter
                jet's location.  State the fighter jet's location and explain
                how <xref ref="F_10_6_missile">Figure</xref> tells you this.
            </p>
          </li>

          <li>
            <p>
              Determine <m>\nabla T</m> at the fighter jet's location and give a
                justification for your response.
            </p>
          </li>

          <li>
            <p>
              Suppose that a different function <m>f</m> has a local maximum value at
                <m>(x_0,y_0)</m>.  Sketch the behavior of some possible contours near this point. 
                What is <m>\nabla f(x_0,y_0)</m>? (Hint: What is the direction of greatest increase in <m>f</m> at the local maximum?)
            </p>
          </li>

          <li>
            <p>
              Suppose that a function <m>g</m> has a local minimum value at
                <m>(x_0,y_0)</m>.  Sketch the behavior of some possible contours near this point.
                What is <m>\nabla g(x_0,y_0)</m>?
            </p>
          </li>

          <li>
            <p>
              If a function <m>g</m> has a local minimum at  <m>(x_0,y_0)</m>, what is the direction of greatest increase of <m>g</m> at <m>(x_0,y_0)</m>?
            </p>
          </li>
        </ol>
      </statement>
      
      <answer>
        <ol marker="a.">
          <li>
            <p>
              The gradient points toward the direction of greatest in <m>T</m>,
              and the gradient vectors are all directed toward the point <m>(5,2.5)</m>.
              So the fighter jet's location is <m>(5,2.5)</m>.
            </p>
          </li>
          <li>
            <p>
              At the fighter jet's location,
              the temperature doesn't increase,
              so we should expect <m>\nabla T</m> to be the zero vector there.
              Note that <m>T_x(x,y) = -\frac{200(x-5)}{[1+(x-5)^2+4(y-2.5)^2]^2}</m> and <m>T_y(x,y) = -\frac{800(y-2.5)}{[1+(x-5)^2+4(y-2.5)^2]^2}</m>,
              and so <m>\nabla T(5,2.5) = \langle 0, 0 \rangle</m>.
            </p>
          </li>
          <li>
            <p>
              Contours of <m>f</m> might look like the contours of <m>T</m> near the point <m>(x_0,y_0)</m>.
              At the relative maximum point we would have <m>\nabla f(x_0,y_0) = \langle 0,0\rangle</m>,
              provided <m>\nabla f(x_0,y_0)</m> exists.
            </p>
          </li>
          <li>
            <p>
              Contours of <m>g</m> might look like the contours of <m>T</m> near the point
              <m>(x_0,y_0)</m> only with the gradients pointing outward instead of inward.
              At the relative maximum point we would have <m>\nabla g(x_0,y_0) = \langle 0,0\rangle</m>,
              provided <m>\nabla g(x_0,y_0)</m> exists.
            </p>
          </li>
          <li>
            <p>
              If <m>g</m> has a local minimum at
              <m>(x_0,y_0)</m> and <m>\nabla g(x_0,y_0) = \langle 0,0 \rangle</m>,
              then any direction will provide the greatest increase in <m>g</m> at the point <m>(x_0,y_0)</m>.
            </p>
          </li>
        </ol>
      </answer>


      <solution>
        <ol marker="a.">
          <li>
            <p>
              The gradient points toward the direction of greatest in <m>T</m>,
              and the gradient vectors are all directed toward the point <m>(5,2.5)</m>.
              So the fighter jet's location is <m>(5,2.5)</m>.
            </p>
          </li>
          <li>
            <p>
              At the fighter jet's location,
              the temperature doesn't increase,
              so we should expect <m>\nabla T</m> to be the zero vector there.
              Note that <m>T_x(x,y) = -\frac{200(x-5)}{[1+(x-5)^2+4(y-2.5)^2]^2}</m> and <m>T_y(x,y) = -\frac{800(y-2.5)}{[1+(x-5)^2+4(y-2.5)^2]^2}</m>,
              and so <m>\nabla T(5,2.5) = \langle 0, 0 \rangle</m>.
            </p>
          </li>
          <li>
            <p>
              Contours of <m>f</m> might look like the contours of <m>T</m> near the point <m>(x_0,y_0)</m>.
              At the relative maximum point we would have <m>\nabla f(x_0,y_0) = \langle 0,0\rangle</m>,
              provided <m>\nabla f(x_0,y_0)</m> exists.
            </p>
          </li>
          <li>
            <p>
              Contours of <m>g</m> might look like the contours of <m>T</m> near the point
              <m>(x_0,y_0)</m> only with the gradients pointing outward instead of inward.
              At the relative maximum point we would have <m>\nabla g(x_0,y_0) = \langle 0,0\rangle</m>,
              provided <m>\nabla g(x_0,y_0)</m> exists.
            </p>
          </li>
          <li>
            <p>
              If <m>g</m> has a local minimum at
              <m>(x_0,y_0)</m> and <m>\nabla g(x_0,y_0) = \langle 0,0 \rangle</m>,
              then any direction will provide the greatest increase in <m>g</m> at the point <m>(x_0,y_0)</m>.
            </p>
          </li>
        </ol>
      </solution>

    </activity>
  </subsection>


  <subsection>
    <title>Summary</title>
    <ul>
      <li>
        <p>
          The directional derivative of <m>f</m> at the point <m>(x,y)</m> in the direction of the unit vector <m>\vu = \langle u_1, u_2 \rangle</m> is
          <me>
            D_{\vu}f(x,y) = \lim_{h \to 0} \frac{f(x+u_1h, y+u_2h) - f(x,y)}{h}
          </me>
          for those values of <m>x</m> and <m>y</m> for which the limit exists.  In addition, <m>D_{\vu}f(x,y)</m> measures the slope of the graph of <m>f</m> when we move in the direction
            <m>\vu</m>.   Alternatively, <m>D_{\vu} f(x_0,y_0)</m> measures the instantaneous rate of change of <m>f</m> in the direction <m>\vu</m> at <m>(x_0,y_0)</m>.
        </p>
      </li>

      <li>
        <p>
          The gradient of a function <m>f=f(x,y)</m> at a point <m>(x_0,y_0)</m> is
            the vector
          <me>
            \nabla f(x_0,y_0) = \left\langle f_x(x_0,y_0),
                f_y(x_0,y_0)\right\rangle.
          </me>
        </p>
      </li>

      <li>
        <p>
          The directional derivative in the direction <m>\vu</m> may be computed by
          <me>
            D_{\vu}f(x_0,y_0) = \nabla f(x_0,y_0)\cdot \vu.
          </me>
        </p>
      </li>

      <li>
        <p>
          At any point where the gradient is nonzero,  gradient is orthogonal to the contour through
            that point and points in the direction in which <m>f</m> increases most
            rapidly; moreover, the slope of <m>f</m> in this direction equals the length of the
            gradient <m>|\nabla f(x_0,y_0)|</m>.  Similarly, the opposite of the gradient points in the direction of greatest decrease, and that rate of decrease is the opposite of the length of the gradient.
        </p>
      </li>
    </ul>

    </subsection>


    <exercises>
      <exercise label="Library__272__setStewart14_6__problem_4.pg" xml:id="ex-10-6-WW-DD-gradiant">
      <!--<title>Calculating a directional derivative and gradient</title>-->
         <webwork source="Library/272/setStewart14_6/problem_4.pg"/>
      </exercise>

      <exercise label="Library__maCalcDB__setVmultivariable6Gradient__ur_vc_6_11.pg" xml:id="ex-10-6-WW-DD-calculation-1">
      <!--<title>Calculating a directional derivative at a point</title>-->
         <webwork source="Library/maCalcDB/setVmultivariable6Gradient/ur_vc_6_11.pg"/>
      </exercise>

      <exercise label="Library__FortLewis__Calc3__14-5-Gradients-in-space__HGM4-14-5-16-Gradients-etc.pg" xml:id="ex-10-6-WW-DD-max">
      <!--<title>Derivative in the direction of maximum rate of change</title>-->
         <webwork source="Library/FortLewis/Calc3/14-5-Gradients-in-space/HGM4-14-5-16-Gradients-etc.pg"/>
      </exercise>

      <exercise label="Library__FortLewis__Calc3__14-4-Gradients-in-plane__HGM4-14-4-66-Gradients-etc.pg" xml:id="ex-10-6-WW-DD-temperature">
      <!--<title>Gradient and temperature</title>-->
         <webwork source="Library/FortLewis/Calc3/14-4-Gradients-in-plane/HGM4-14-4-66-Gradients-etc.pg"/>
      </exercise>

      <exercise label="Library__Dartmouth__setStewartCh15S6__problem_10.pg" xml:id="ex-10-6-WW-DD-Grad-temperature">
      <!--<title>Directional derivative, gradient, and temperature</title>-->
         <webwork source="Library/Dartmouth/setStewartCh15S6/problem_10.pg"/>
      </exercise>

      <exercise label="Library__FortLewis__Calc3__14-5-Gradients-in-space__HGM4-14-5-09-Gradients-etc.pg" xml:id="ex-10-6-WW-DD-Grad-calculation">
      <!--<title>Gradient calculation</title>-->
         <webwork source="Library/FortLewis/Calc3/14-5-Gradients-in-space/HGM4-14-5-09-Gradients-etc.pg"/>
      </exercise>

      <exercise label="Library__Michigan__Chap14Sec5__Q53.pg" xml:id="ex-10-6-WW-DD-3-variable">
      <!--<title>A three-variable example</title>-->
         <webwork source="Library/Michigan/Chap14Sec5/Q53.pg"/>
      </exercise>

      <exercise label="Library__FortLewis__Calc3__14-4-Gradients-in-plane__HGM4-14-4-67-Gradients-etc.pg" xml:id="ex-10-6-WW-DD-DD-Grad-calculation">
      <!--<title>A directional derivative given a gradient</title>-->
         <webwork source="Library/FortLewis/Calc3/14-4-Gradients-in-plane/HGM4-14-4-67-Gradients-etc.pg"/>
      </exercise>

      <exercise label="Library__Dartmouth__setStewartCh15S6__problem_11.pg" xml:id="ex-10-6-WW-DD-hill">
      <!--<title>Climbing a hill</title>-->
         <webwork source="Library/Dartmouth/setStewartCh15S6/problem_11.pg"/>
      </exercise>
      
      <exercise label="Library__FortLewis__Calc3__14-5-Gradients-in-space__HGM4-14-CYU-01-Gradients-etc.pg" xml:id="ex-10-6-WW-DD-TF">
      <!--<title>Directional derivative true/false</title>-->
         <webwork source="Library/FortLewis/Calc3/14-5-Gradients-in-space/HGM4-14-CYU-01-Gradients-etc.pg"/>
      </exercise>

      <!-- MBX exception
      <exercise xml:id="ex-10-6-WW-DD-contours">
      <title>Directional derivatives from contours</title>
         <webwork source="Library/FortLewis/Calc3/14-4-Gradients-in-plane/HGM4-14-4-40-Gradients-etc/HGM4-14-4-40-Gradients-etc.pg" />
      </exercise> 

      <exercise xml:id="ex-10-6-WW-DD-surface">
      <title>Directional derivatives from a surface</title>
         <webwork source="Library/FortLewis/Calc3/14-4-Gradients-in-plane/HGM4-14-4-48-Gradients-etc/HGM4-14-4-48-Gradients-etc.pg" />
      </exercise> 

      <exercise xml:id="ex-10-6-WW-DD-TF-2">
      <title>Another directional derivative true/false</title>
         <webwork source="Library/FortLewis/Calc3/14-4-Gradients-in-plane/HGM4-14-Review-46-Gradients-etc/HGM4-14-Review-46-Gradients-etc.pg" />
      </exercise> -->

      <!--PTX issue
      <exercise xml:id="ex-10-6-WW-DD-3-variable">
      <title>A three-variable example</title>
         <webwork source="Library/Union/setMVderivatives/an14_6_5.pg" />
      </exercise>
      -->


      <exercise>
        <statement>
          <p>
            Let <m>E(x,y) = \frac{100}{1+(x-5)^2 + 4(y-2.5)^2}</m> represent the elevation on a land mass at location <m>(x,y)</m>. Suppose that <m>E</m>, <m>x</m>, and <m>y</m> are all measured in meters.
            <ol marker="a.">
              <li>
                <p>
                  Find <m>E_x(x,y)</m> and <m>E_y(x,y)</m>.
                </p>
              </li>

              <li>
                <p>
                  Let <m>\vu</m> be a unit vector in the direction of <m>\langle -4,3 \rangle</m>.  Determine <m>D_{\vu} E(3,4)</m>.  What is the practical meaning of <m>D_{\vu} E(3,4)</m> and what are its units?
                </p>
              </li>

              <li>
                <p>
                  Find the direction of greatest increase in <m>E</m> at the point <m>(3,4)</m>.
                </p>
              </li>

              <li>
                <p>
                  Find the instantaneous rate of change of <m>E</m> in the direction of greatest decrease at the point <m>(3,4)</m>.  Include units on your answer.
                </p>
              </li>

              <li>
                <p>
                  At the point <m>(3,4)</m>, find a direction <m>\vw</m> in which the instantaneous rate of change of <m>E</m> is 0.
                </p>
              </li>
            </ol>
          </p>
        </statement>

        <answer>
          <ol marker="a.">
            <li>
              <p>
                <me>
                  E_x(x,y) = -\frac{200(x-5)}{(1+(x-5)^2 + 4(y-2.5)^2)^2} \ \ \text{ and }  \ \ E_y(x,y) = -\frac{800(y-2.5)}{(1+(x-5)^2 + 4(y-2.5)^2)^2}
                </me>
              </p>
            </li>
            <li>
              <p>
                <me>
                  D_{\vu} E(3,4) = -\frac{260}{49} \approx -5.306 \ \frac{\text{ meters } }{\text{ meter } }
                </me>
                For every one meter change in the direction of <m>\vu</m> from the point <m>(3,4)</m>,
                the elevation decreases by <m>\frac{260}{49}</m> meters.
              </p>
            </li>
            <li>
              <p>
                <me>
                  \nabla E (3,4) = \frac{100}{49} \langle 1, -3 \rangle \approx \langle 2.04, -6.12 \rangle
                </me>
              </p>
            </li>
            <li>
              <p>
                <me>
                  -|\nabla E(3,4)| = -\frac{100}{49}\sqrt{10} \approx -6.454 \ \frac{\text{ meters } }{\text{ meter } }
                </me>
              </p>
            </li>
            <li>
              <p>
                one possible answer: <m>\langle 3, 1 \rangle</m> 
              </p>
            </li>
          </ol>
        </answer>

        <solution>
          <ol marker="a.">
            <li>
              <p>
                For this function <m>E</m> we have
                <me>
                  E_x(x,y) = -\frac{200(x-5)}{(1+(x-5)^2 + 4(y-2.5)^2)^2} \ \ \text{ and }  \ \ E_y(x,y) = -\frac{800(y-2.5)}{(1+(x-5)^2 + 4(y-2.5)^2)^2}
                </me>.
              </p>
            </li>
            <li>
              <p>
                A unit vector in the direction of
                <m>\langle -4,3 \rangle</m> is <m>\vu = \frac{1}{5} \langle -4, 3 \rangle</m>.
                Since
                <me>
                  E_x(3,4) = \frac{100}{49} \ \ \text{ and }  \ \ E_y(3,4) = -\frac{300}{49}
                </me>,
                we have
                <me>
                  D_{\vu} E(3,4) = \nabla E(3,4) \cdot \vu = \left\langle \frac{100}{49}, -\frac{300}{49} \right\rangle \cdot \frac{1}{5} \langle -4,3 \rangle = \frac{20}{49} (-4 - 9) = -\frac{260}{49} \approx -5.306 \ \frac{\text{ meters } }{\text{ meter } }
                </me>.
                For every one meter change in the direction of <m>\vu</m> from the point <m>(3,4)</m>,
                the elevation decreases by <m>\frac{260}{49}</m> meters.
              </p>
            </li>
            <li>
              <p>
                The direction of greatest increase of <m>E</m> at the point <m>(3,4)</m> is
                <me>
                  \nabla E (3,4) = \langle E_x(3,4), E_y(3,4) \rangle = \frac{100}{49} \langle 1, -3 \rangle \approx \langle 2.04, -6.12 \rangle
                </me>.
              </p>
            </li>
            <li>
              <p>
                The direction of greatest decrease of <m>E</m> at <m>(3,4)</m> is <m>-\nabla E(3,4)</m>.
                The instantaneous rate of change of <m>E</m> in the direction of greatest decrease at the point <m>(3,4)</m> is
                <me>
                  -|\nabla E(3,4)| = -\frac{100}{49}\sqrt{1+9} = -\frac{100}{49}\sqrt{10} \approx -6.454 \ \frac{\text{ meters } }{\text{ meter } }
                </me>.
              </p>
            </li>
            <li>
              <p>
                We want a direction vector <m>\vw = \langle w_1, w_2 \rangle</m> so that
                <me>
                  0 = D_{\vw} E(3,4) = \nabla E(3,4) \cdot \vw = \left\langle \frac{100}{49}, -\frac{300}{49} \right\rangle \cdot \langle w_1, w_2 \rangle = \frac{100}{49}(w_1-3w_2)
                </me>.
                So the vector <m>\langle 3, 1 \rangle</m> is a direction in which <m>E</m> does not change at the point <m>(3,4)</m>.
              </p>
            </li>
          </ol>
        </solution>


      </exercise>

      <exercise>
        <statement>
          <p>
            Find all directions in which the directional derivative of <m>f(x,y) = ye^{-xy}</m> is 1 at the point <m>(0,2)</m>. 
          </p>
        </statement>

        <answer>
          <p>
           Any positive scalar multiple of <m>\langle 0, 1 \rangle</m> or <m>\langle  -\frac{8}{17},  -\frac{15}{17}\rangle </m> will give a direction in which the directional derivative is 1.
          </p>
        </answer>

        <solution>
          <p>
            We have  
            <me>
              f_x(x, y) = -y^2 e^{-xy}
            </me>
            and 
            <me>
              f_y(x, y) = y(-x e^{-xy}) + e^{-xy}
            </me>,
            so  
            <me>
              f_x(0, 2) = -(2)^2 e^{-(0)(2)} = -4e^0 = -4
            </me>
            and 
            <me>
              f_y(0, 2) = 2(-0 \cdot e^{-(0)(2)}) + e^{-(0)(2)} = 0 + e^0 = 1
            </me>.
            For a unit vector <m>\vu = \langle a, b \rangle</m>, 
              <me>
                D_{\vu} f(0, 2) = \nabla f(0,2) \cdot \vu = \left\langle f_x(0, 2), f_y(0, 2)\right\rangle \cdot \langle a, b \rangle = -4a + (1) b
              </me>.
            We want <m>D_{\vu} f(0, 2) = 1</m>, so we want a unit direction vector <m>\langle a, b \rangle</m> with <m>-4a + b = 1</m>. Note that since <m>\langle a, b \rangle</m> is a unit vector we have <m>1 = \sqrt{a^2 + b^2}</m>. Solving these equations simultaneously yields <m>a=0, b = 1</m> or <m>a = -\frac{8}{17}, b = -\frac{15}{17}</m>. Thus any positive scalar multiple of <m>\langle 0, 1 \rangle</m> or <m>\langle  -\frac{8}{17},  -\frac{15}{17} \rangle</m> will give a direction in which the directional derivative is 1.
          </p>
        </solution>

      </exercise>

      <exercise>
        <statement>
          <p>
            Find, if possible, a function <m>f</m> such that 
            <me> 
              \nabla f = \left\langle \sin(yz), xz\cos(yz)+2y, xy\cos(yz)+\frac{5}{z} \right\rangle
            </me>. 
            If not possible, explain why. 
          </p>
        </statement>

        <answer>
          <p>
            <me>
              f(x, y, z) = x \sin(yz) + y^2 + 5 \ln |z| + c
            </me>,
            where <m>c</m> is a constant (and <m>x \neq 0</m>)
          </p>
        </answer>


        <solution>
          <p>
            Recall 
            <me>
              \nabla f(x, y, z) = \langle f_x(x, y, z), f_y(x, y, z), f_z(x, y, z) \rangle
            </me>.
            If <m>f_x (x, y, z) = \sin(yz)</m>, we must have
             <me>
              f(x, y, z) = x \sin(yz) + k_1(y, z)
             </me>,
            where <m>k_1(y, z)</m> is a function of <m>y</m> and <m>z</m> only. If <m>f_y(x, y, z) = \sin(yz) + 2y</m>, we must have
             <me>
              f(x, y, z) = x \sin(yz) + y^2 + k_2(x, z)
             </me>,
              where <m>k_2(x, z)</m> is a function of <m>x</m> and <m>z</m> only. Finally, if <m>f_z (x, y, z) = xy \cos(yz) + \frac{5}{z}</m>, we must have
               <me>
                f(x, y, z) = x \sin(yz) + 5 \ln |z| + k_3(x, y)
               </me>,
               where <m>k_3(x, y)</m> is a function of <m>x</m> and <m>y</m> only. A function that satisfies all three of these possibilities is  
            <me>
              f(x, y, z) = x \sin(yz) + y^2 + 5 \ln |z| + c
            </me>,
            where <m>c</m> is a constant (and <m>x \neq 0</m>).
          </p>
        </solution>



      </exercise>

      <exercise>
        <statement>
          <p>
            Let <m>f(x,y) = x^2+3y^2</m>.
            <ol marker="a.">
              <li>
                <p>
                  Find <m>\nabla f(x,y)</m> and <m>\nabla f(1,2)</m>.
                </p>
              </li>

              <li>
                <p>
                  Find the direction of greatest increase in <m>f</m> at the point <m>(1,2)</m>. Explain. A graph of the surface defined by <m>f</m> is shown at left in <xref ref="F_10_6_Grad_ex_1">Figure</xref>. Illustrate this direction on the surface.
                </p>
              </li>

              <li>
                <p>
                  A contour diagram of <m>f</m> is shown at right in <xref ref="F_10_6_Grad_ex_1">Figure</xref>. Illustrate your calculation from (b) on this contour diagram.

                  <figure xml:id="F_10_6_Grad_ex_1">
                    <caption>Left: Graph of <m>f(x,y) = x^2+3y^2</m>. Right: Contours.</caption>
                    <sidebyside widths="50% 50%">
                      <image source="images/fig_10_6_exercise_graph"/>
                      <image source="images/fig_10_6_exercise_contour"/>
                      </sidebyside>
                  </figure>
                  

                </p>
              </li>

              <li>
                <p>
                  Find a direction <m>\vw</m> for which the derivative of <m>f</m> in the direction of <m>\vw</m> is zero.
                </p>
              </li>
            </ol>
          </p>
        </statement>

        <answer>
          <ol marker="a.">
            <li>
              <p>
                <me>
                  \nabla f (x, y) = \langle 2x, 6y \rangle
                </me>,
                <me>
                  \nabla f(1,2) = \langle 2, 12 \rangle
                </me>.
              </p>
            </li>
            <li>
              <p>
                The gradient shows the direction of greatest increase of <m>f</m> at a point.
                An illustration of this direction at the point
                <m>(1,2,f(1,2))</m> is shown in the figure below,
                with the gradient vector scaled appropriately to make it easier to plot.
                <image width="73%" source="images/fig_10_6_Ex_surface_gradient"/>
              </p>
            </li>
            <li>
              <p>
                The gradient shows the direction of greatest increase of <m>f</m> at a point.
                The gradient is perpendicular to the level curves,
                and a picture of the unit vector in the direction of the gradient at <m>(1,2)</m> is shown in the figure below,
                with the gradient vector scaled appropriately to make it easier to plot.
                <image width="73%" source="images/fig_10_6_Ex_contour_gradient"/>
              </p>
            </li>
            <li>
              <p> 
                one possible answer: <m>\langle -3,1 \rangle</m>
              </p>
            </li>
          </ol>
        </answer>


        <solution>
          <ol marker="a.">
            <li>
              <p>
                In this case we have
                <me>
                  \nabla f = \langle f_x, f_y \rangle = \langle 2x, 6y \rangle
                </me>.
                Evaluating <m>\nabla f</m> at <m>(1,2)</m> gives us
                <me>
                  \nabla f(1,2) = \langle 2, 12 \rangle
                </me>.
              </p>
            </li>
            <li>
              <p>
                The gradient shows the direction of greatest increase of <m>f</m> at a point.
                An illustration of this direction at the point
                <m>(1,2,f(1,2))</m> is shown in the figure below,
                with the gradient vector scaled appropriately to make it easier to plot.
                <image width="73%" source="images/fig_10_6_Ex_surface_gradient"/>
              </p>
            </li>
            <li>
              <p>
                The gradient shows the direction of greatest increase of <m>f</m> at a point.
                The gradient is perpendicular to the level curves,
                and a picture of the unit vector in the direction of the gradient at <m>(1,2)</m> is shown in the figure below,
                with the gradient vector scaled appropriately to make it easier to plot.
                <image width="73%" source="images/fig_10_6_Ex_contour_gradient"/>
              </p>
            </li>
            <li>
              <p>
                We need to find a direction
                <m>\vw = \langle w_1, w_2 \rangle</m> so that <m>D_{\vw} f(1,2) = \nabla f(1,2) \cdot \vw = 0</m>.
                Since <m>\nabla f (1,2)= \langle 2, 6 \rangle</m>,
                we need <m>w_1</m> and <m>w_2</m> to satisfy <m>2w_1+6w_2=0</m>.
                So <m>w_1=-3w_2</m> and a direction for which the slope of the tangent line to the surface generated by <m>f</m> at the point <m>(1,2)</m> is zero in the direction <m>\vw</m> is <m>\langle -3,1 \rangle</m>.
              </p>
            </li>
          </ol>
        </solution>


      </exercise>


      <exercise>
        <statement>
          <p>
            The properties of the gradient that we have observed for functions of two variables also hold for functions of more variables. In this problem, we consider a situation where there are three independent variables. Suppose that the temperature in a region of space is described by
            <me>
              T(x,y,z) = 100e^{-x^2-y^2-z^2}
            </me>
            and that you are standing at the point <m>(1,2,-1)</m>.
            <ol marker="a.">
              <li>
                <p>
                  Find the instantaneous rate of change of the temperature in the direction of
                    <m>\vv=\langle 0, 1, 2\rangle</m> at the point <m>(1,2,-1)</m>.  Remember that you should first find a
                    <em>unit</em> vector in the direction of <m>\vv</m>.
                </p>
              </li>

              <li>
                <p>
                  In what direction from the point <m>(1,2,-1)</m> would you move to cause the temperature to
                    decrease as quickly as possible?
                </p>
              </li>

              <li>
                <p>
                  How fast does the temperature decrease in this direction?
                </p>
              </li>

              <li>
                <p>
                  Find a direction in which the temperature does
                    not change at <m>(1,2,-1)</m>.
                </p>
              </li>
            </ol>
          </p>
        </statement>

        <answer>
          <ol marker="a.">
            <nbsp/>
            <li>
              <p>
                <m>0</m>
              </p>
            </li>
            <li>
              <p>
                <me>
                  -\nabla T(1,2,-1) = \left\langle 200e^{-6}, 400e^{-6}, -200e^{-6} \right\rangle \approx \langle 0.5, 1, -0.5 \rangle
                </me>
              </p>
            </li>
            <li>
              <p>
                The rate of change of the temperature in this direction is
                <me>
                  -\left|\nabla T(1,2,-1) \right| = -200 \sqrt{6}e^{-6} \approx -1.21
                </me>
                So the temperature decreases at approximately 1.21 units of temperature per one unit of distance in this direction.
              </p>
            </li>
            <li>
              <p>
               possible answers: <m>\langle -1,1,1 \rangle</m> or in the direction of
                <m>\langle 0,1,2\rangle</m> as shown in part (a)
              </p>
            </li>
          </ol>
        </answer>

        <solution>
          <ol marker="a.">
            <li>
              <p>
                A unit vector in the direction of <m>\vv</m> is <m>\vu = \frac{1}{\sqrt{5}} \vv</m>.
                Since
                <me>
                  T_x(x,y,z) = -200xe^{-x^2-y^2-z^2} \ , T_y(x,y,z) = -200ye^{-x^2-y^2-z^2},  \ \text{ and }  \ T_z(x,y,z) = -200ze^{-x^2-y^2-z^2}
                </me>,
                the instantaneous rate of change of the temperature in the direction of <m>\vv=\langle 0, 1, 2\rangle</m> is then
                <md>
                  <mrow>D_{\vu}T(1,2,1) \amp = \nabla T(1,2,-1) \cdot \vu</mrow>
                  <mrow>\amp =  \langle T_x(1,2,-1), T_y(1,2,-1), T_z(1,2,-1) \rangle \cdot \vu</mrow>
                  <mrow>\amp =\left\langle -200e^{-6}, -400e^{-6}, 200e^{-6} \right\rangle \cdot \frac{1}{\sqrt{5}} \langle 0,1,2\rangle</mrow>
                  <mrow>\amp =-\frac{200}{\sqrt{5}}e^{-6}(0+4-4)</mrow>
                  <mrow>\amp = 0</mrow>
                </md>.
              </p>
            </li>
            <li>
              <p>
                To cause the temperature to decrease as quickly as possible we move in the direction of
                <me>
                  -\nabla T(1,2,-1) = \left\langle 200e^{-6}, 400e^{-6}, -200e^{-6} \right\rangle \approx \langle 0.5, 1, -0.5 \rangle
                </me>.
              </p>
            </li>
            <li>
              <p>
                The rate of change of the temperature in this direction is
                <me>
                  -\left|\nabla T(1,2,-1) \right| =  -\sqrt{\left(200e^{-6}\right)^2 + \left(400e^{-6}\right)^2 + \left(-200e^{-6}\right)^2} = -200 \sqrt{6}e^{-6} \approx -1.21
                </me>.
                So the temperature decreases at approximately 1.21 in this direction.
              </p>
            </li>
            <li>
              <p>
                Let <m>\vu = \langle u_1, u_2, u_3 \rangle</m> be a vector in a direction in which the temperature does not change.
                Then
                <md>
                  <mrow>0 \amp = \nabla T(1,2,-1) \cdot \vu</mrow>
                  <mrow>\amp = \left\langle -200e^{-6}, -400e^{-6}, 200e^{-6} \right\rangle \cdot \langle u_1, u_2, u_3 \rangle</mrow>
                  <mrow>\amp = -200e^{-6}(u_1+2u_2-u_3)</mrow>
                </md>.
                So a direction in which the temperature does not change is the direction of the vector
                <m>\langle -1,1,1 \rangle</m> (or in the direction of
                <m>\langle 0,1,2\rangle</m> as shown in part (a)).
              </p>
            </li>
          </ol>
        </solution>

 
      </exercise>
      <exercise>
        <statement>
          <p>
            <xref ref="F_10_6_gradient_field">Figure</xref> shows a plot of the gradient
            <m>\nabla f</m> at several points for some function <m>f=f(x,y)</m>.
          </p>

          <figure xml:id="F_10_6_gradient_field">
            <caption>The gradient <m>\nabla f</m>.</caption>
            <image width="50%" source="images/fig_10_6_gradient_field"/>
          </figure>

          <ol marker="a.">
            <li>
              <p>
                Consider each of the three indicated points, and draw, as best
                  as you can, the contour through that point.
              </p>
            </li>

            <li>
              <p>
                Beginning at each point, draw a curve on which <m>f</m> is continually
                  decreasing.
              </p>
            </li>
          </ol>
        </statement>

        <answer>
          <ol marker="a.">
            <li>
              <p>
                Since the gradient at a point is orthogonal to the contour at that point,
                the contours through the indicated points are drawn orthogonal to the gradients.
                This is illustrated in the figures below.
                <image width="73%" source="images/fig_10_6_Ex_4_a_1"/> <image width="73%" source="images/fig_10_6_Ex_4_b_1"/> <image width="73%" source="images/fig_10_6_Ex_4_c_1"/>
              </p>
            </li>
            <li>
              <p>
                The gradient points in the direction of the greatest increase of the function,
                so a curve that moves in the direction opposite the gradient is a curve on which <m>f</m> is decreasing.
                This is illustrated in the figures below.
                <image width="73%" source="images/fig_10_6_Ex_4_a_2"/> <image width="73%" source="images/fig_10_6_Ex_4_b_2"/> <image width="73%" source="images/fig_10_6_Ex_4_c_2"/>
              </p>
            </li>
          </ol>
        </answer>

        <solution>
          <ol marker="a.">
            <li>
              <p>
                Since the gradient at a point is orthogonal to the contour at that point,
                the contours through the indicated points are drawn orthogonal to the gradients.
                This is illustrated in the figures below.
                <image width="73%" source="images/fig_10_6_Ex_4_a_1"/> <image width="73%" source="images/fig_10_6_Ex_4_b_1"/> <image width="73%" source="images/fig_10_6_Ex_4_c_1"/>
              </p>
            </li>
            <li>
              <p>
                The gradient points in the direction of the greatest increase of the function,
                so a curve that moves in the direction opposite the gradient is a curve on which <m>f</m> is decreasing.
                This is illustrated in the figures below.
                <image width="73%" source="images/fig_10_6_Ex_4_a_2"/> <image width="73%" source="images/fig_10_6_Ex_4_b_2"/> <image width="73%" source="images/fig_10_6_Ex_4_c_2"/>
              </p>
            </li>
          </ol>
        </solution>

 
      </exercise>
    </exercises>

</section>
