<!-- **********************************************************************-->
<!-- Copyright 2013-2025                                                   -->
<!-- Nicholas Long, Mitchel Keller                                         -->
<!--                                                                       -->
<!-- This file is part of Active Calculus Multivariable.                   -->
<!--                                                                       -->
<!-- Permission is granted to copy, distribute and/or modify this document -->
<!-- under the terms of the Creative Commons BY-NC-SA license.  The work   -->
<!-- may be used for free by any party so long as attribution is given to  -->
<!-- the author(s), the work and its derivatives are used in the spirit of -->
<!-- "share and share alike"; no party may sell this work or any of its    -->
<!-- derivatives for profit.  All trademarks are the registered marks of   -->
<!-- their respective owners.                                              -->
<!-- **********************************************************************-->
<section xmlns:xi="http://www.w3.org/2001/XInclude" xml:id="S-Precalc-OtherCoordSystems">
  <title>Polar, Cylindrical, and Spherical Coordinates</title>
  <objectives>
    <ul>
      <li>
        <p>
          What are the polar coordinates of a point, and how are they related to rectangular coordinates?
        </p>
      </li>
      <li>
        <p>
          What are the cylindrical coordinates of a point, and how are they related to rectangular coordinates?
        </p>
      </li>
      <li>
        <p>
          What are the spherical coordinates of a point, and how are they related to rectangular coordinates?
        </p>
      </li>
      <li>
        <p>
          How can we convert coordinates of points or equations between coordinate systems?
        </p>
      </li>
    </ul>
  </objectives>
  <introduction component="instructor">
    <title>Notes to Instructors and Dependencies</title>
    <p>
      We have included a comprehensive treatment of polar coordinates here because many students will not have a lot of experience with polar coordinates and because these ideas of angular coordinate measurements are fundamental to cylindrical and spherical coordinates in three dimensions. The preview activity is designed to help student use right triangle angle and side relationships outside of the rigid settings used in Trigonometry. We do not anticipate that instructors will use every example or activity in this section, but we have offered a broad selection of ideas covered to allow instructors to tailor this material to the experience and needs of their students.
    </p>
    <p>
      Other traditional texts often wait to introduce cylindrical and spherical coordinates until multiple integration. We have opted into include this material here to further develop students thinking about paths, surfaces, and regions having angular symmetry about an axis (cylindrical) or a point (spherical). This thinking is not strictly required but the authors have found this useful when parameterizing paths in 3D (in <xref ref="S-VVF-Plotting"/>), translating geometric features to algebraic forms (throughout the rest of this text), and with evaluating limits of multivariable functions (<xref ref="S-mv_deriv-Limits"/>), as well as many other places where rotational/angular symmetry or descriptions occur.
    </p>
  </introduction>
<subsection>
  <title>Introduction</title>
  <p>
    In this preview activity, we will investigate some measurements that will be useful when defining new ways to specify locations. Many of these measurements involve measuring the length of specific line segments and angles between line segments in three dimensions. 
  </p>
  <worksheet>
  <exploration workspace="1.5in">
    <introduction>
      <p>
        An angle in the <m>xy</m>-plane is in standard position if the initial side of the angle is on the positive <m>x</m>-axis and is measured with the positive direction going counterclockwise.
      </p>
    </introduction>
    <task>
      <statement>
        <p>
          If an angle <m>\theta</m> is in standard position, for which quadrants will <m>\sin(\theta)</m> be positive? For which quadrants will <m>\sin(\theta)</m> be negative? Which angles correspond to <m>\sin(\theta)=0</m>?
        </p>
      </statement>
    </task>
    <task>
      <statement>
        <p>
          If an angle <m>\theta</m> is in standard position, for which quadrants will <m>\cos(\theta)</m> be positive? For which quadrants will <m>\cos(\theta)</m> be negative? Which angles correspond to <m>\cos(\theta)=0</m>?
        </p>
      </statement>
    </task>
    <task>
      <statement>
        <p>
          If an angle <m>\theta</m> is in standard position, for which quadrants will <m>\tan(\theta)</m> be positive? For which quadrants will <m>\tan(\theta)</m> be negative? Which angles correspond to <m>\tan(\theta)=0</m>? Which angles correspond to <m>\tan(\theta)</m> being undefined?
        </p>
      </statement>
    </task>
    <task>
      <introduction>
        <p>
          Consider the plot of point <m>P</m> in <xref ref="PA-OtherCoord-task4-plot"/>.
        </p>
        <figure xml:id="PA-OtherCoord-task4-plot">
          <caption>A plot of point <m>P</m> with <m>y</m>, <m>z</m>, and <m>r</m> labeled</caption>
          <interactive label="interactive-othercoord1" platform="sage" width="91%" aspect="1:1">
            <description><p>A plot of point <m>P</m> with <m>y</m>, <m>z</m>, and <m>r</m> labeled</p>
          </description><slate surface="sage">
              from sage.plot.plot3d.plot3d import axes
              var('t,s')
              scale=5
              plot1=axes(scale,2,color="black",frame=False)+text3d("x",(scale+0.5,0,0),fontsize=30)+text3d("y",(0,scale+0.5,0),fontsize=30)+text3d("z",(0,0,scale+0.5),fontsize=30)
              plot1+=line3d([(4,0,0),(4,3,0)],color="red",thickness=3)+text3d("3",(4.5,1.5,-.25),color="red",fontsize=30)
              plot1+=line3d([(0,0,0),(4,3,0)],color="blue",thickness=3)+text3d("5",(2.5,1.25,0),color="blue",fontsize=30)
              plot1+=line3d([(3.5,0,0),(3.5,0.5,0),(4,0.5,0)],color="black",thickness=2)
              plot1+=line3d([(4,3,0),(4,3,2)],color="green",thickness=3)+text3d("2",(4,3.2,1.5),color="green",fontsize=30)
              plot1+=sphere((4,3,2),color="black",size=0.1)+text3d("P",(4,3.3,2.2),color="black",fontsize=30)
              show(plot1,aspect_ratio=1,viewpoint=[[-0.4585,-0.5912,-0.6635],125.54],camera_position=[15.0205,5.8566,4.0979])
            </slate>
          </interactive>
        </figure>
        <p>
          Use trigonometry and the distance formula to find the following:
        </p>
      </introduction>
      <task>
        <statement>
          <p>
            The <m>x</m>-coordinate of <m>P</m>.
          </p>
        </statement>
      </task>
      <task>
        <statement>
          <p>
            The angle in the <m>xy</m>-plane between the <m>x</m>-axis and the line segment (in blue) labeled <m>5</m> that is from the origin to a point directly below <m>P</m>.
          </p>
        </statement>
      </task>
      <task>
        <statement>
          <p>
            The distance between the origin and <m>P</m>. 
          </p>
        </statement>
      </task>
    </task>
    <task>
      <introduction>
        <p>
          Consider the plot of point <m>P</m> in <xref ref="PA-OtherCoord-task5-plot"/>. 
        </p>
        <figure xml:id="PA-OtherCoord-task5-plot">
          <caption>A plot of point <m>P</m> with <m>y</m>, <m>z</m>, and <m>r</m> labeled</caption>
          <interactive label="interactive-othercoord2" platform="sage" width="91%" aspect="1:1">
            <description><p>A plot of point <m>P</m> with <m>y</m>, <m>z</m>, and <m>r</m> labeled</p>
          </description><slate surface="sage">
              from sage.plot.plot3d.plot3d import axes
              var('t,s')
              scale=3
              th=arcsin(2/3)+pi
              ps=arccos(-1/sqrt(10))
              plot2=axes(scale,2,color="black",frame=False)+text3d("x",(scale+0.5,0,0),fontsize=30)
              plot2+=text3d("y",(0,scale+1,0),fontsize=30)+text3d("z",(0,0,scale+0.5),fontsize=30)
              plot2+=line3d([(0,0,0),(-3,0,0)],color="gray",linestyle='--')+line3d([(0,0,0),(0,-3,0)],color="gray",linestyle='--')
              plot2+=line3d([(-sqrt(5),0,0),(-sqrt(5),-2,0)],color="red",linestyle="--",thickness=3)+text3d("2",(-3,-1,0),color="red",fontsize=30)
              plot2+=line3d([(0,0,0),(-sqrt(5),-2,0)],color="blue",linestyle="--",thickness=3)+text3d("3",(-1.5,-1,0.25),color="blue",fontsize=30)
              plot2+=line3d([(-sqrt(5),-2,0),(-sqrt(5),-2,-1)],color="green",thickness=3)+text3d("1",(-3,-2,-0.5),color="green",fontsize=30)
              plot2+=sphere((-sqrt(5),-2,-1),color="black",size=0.1)+text3d("P",(-3.3,-2,-1.5),color="black",fontsize=30)
              plot2+=line3d([(0,0,0,),(-sqrt(5),-2,-1)],color="pink",thickness=3)
              plot2+=parametric_plot3d((cos(th)*sin(t),sin(th)*sin(t),cos(t)),(t,0,ps),color="orange",thickness=3)
              show(plot2,aspect_ratio=1,viewpoint=[[-0.9662,-0.1375,-0.2179],66.3],camera_position=[2.6194,-8.1725,5.3059])
            </slate>
          </interactive>
        </figure>
        <p>
          Use trigonometry and the distance formula to find the following:
        </p>
      </introduction>
      <task>
        <statement>
          <p>
            The <m>x</m>-coordinate of <m>P</m>.
          </p>
        </statement>
      </task>
      <task>
        <statement>
          <p>
            The angle between the <m>z</m>-axis and the pink line segment from the origin to <m>P</m>.
          </p>
        </statement>
      </task>
      <task>
        <statement>
          <p>
            The distance between the origin and <m>P</m>.
          </p>
        </statement>
      </task>
    </task>
  </exploration>
</worksheet>
  <p>
    In this section we will define and work with new ways to specify the location of a point. These new measurements will be useful as coordinate systems and as a way of thinking about how to describe different shapes relative to rotational or other symmetries.
  </p>
</subsection>
<subsection xml:id="subsec-polar">
  <title>Polar Coordinates</title>
  <p>
    We previously defined the rectangular coordinates of a point to be signed distances from the point to the axes as shown below. Remember that the sign on the coordinate tells you whether to go above or below the other axis. 
  </p>
  <figure xml:id="coord2d-measurement2">
    <caption>A plot with the 2D coordinate measurements labeled</caption>
    <image width="65%" xml:id="img-coord2d-measurement2">
      <description><p> A plot with the 2D coordinate measurements labeled for a point in the first quadrant and a point in the fourth quadrant</p> </description>
      <sageplot>
        var('t')
        plot11=point((3,1),color="black",size=40,axes=True,zorder=5,axes_labels=["$x$","$y$"],ticks=[[],[]],fontsize=15)
        plot11+=line([(0,1),(3,1)],color="red",thickness=3)+line([(3,0),(3,1)],color="blue",thickness=3)
        plot11+=text("$a$",(1.5,1.3),color="red",fontsize=20)+text("$b$",(3.3,0.5),color="blue",fontsize=20)
        plot11+=text("$P=(a,b)$",(3.3,1.3),color="black",fontsize=20)+text("$Q=(c,d)$",(2.3,-2.3),color="black",fontsize=20)
        plot11+=point((2,-2),color="black",size=40,zorder=5)
        plot11+=line([(0,-2),(2,-2)],color="red",thickness=3)+line([(2,0),(2,-2)],color="blue",thickness=3)
        plot11+=text("$c$",(1,-1.7),color="red",fontsize=20)+text("$d$",(2.3,-1),color="blue",fontsize=20,xmin=-2,xmax=4,ymin=-2,ymax=2,aspect_ratio=1)
        plot11.axes_width(3)
        plot11
        </sageplot>
    </image>
  </figure>
  <p>
    We define the <term>polar coordinates</term> of a point <m>P</m> in two dimensions to be <m>(r,\theta)</m>, where <m>r</m> is the signed distance from the origin to <m>P</m> and <m>\theta</m> is the counterclockwise angle from the positive horizontal axis to the line segment connecting the origin and <m>P</m>. We use the sign on the <m>r</m> to indicate if the point is locked ahead or behind when facing the <m>\theta</m> direction at the origin.
  </p>
  <figure xml:id="coord2d-2">
    <caption>A plot with polar coordinate measurements labeled</caption>
    <image width="70%" label="img-coord2d-2">
      <description><p>A plot with polar coordinate measurements labeled for a point in the first quadrant </p></description>
      <sageplot>
        var('t')
        plot4=point((2,4),color="black",size=40,zorder=8,axes=True,axes_labels=["$x$","$y$"],ticks=[[],[]])
        plot4+=line([(2,4),(0,0)],color="red",thickness=3)+text("$r$",(1,2.5),color="red",fontsize=25)
        a=arctan(2)
        plot4+=parametric_plot((cos(t),sin(t)),(t,0,a),color="blue",thickness=3)+text("$\\theta$",(1.5,1),color="blue",fontsize=25)
        plot4+=text("$P=(r,\\theta)$",(2.5,4.3),color="black",fontsize=25)
        plot4+=arrow((cos(a-.1),sin(a-.1)),(cos(a),sin(a)),color="blue",xmin=-1,xmax=3,ymin=-1,ymax=5)
        plot4+=line([(2,0),(2,4)],color="gray",zorder=0,linestyle="--",thickness=2)
        plot4+=line([(0,4),(2,4)],color="gray",zorder=0,linestyle="--",thickness=2)
        plot4+=text("$x$",(1,4.25),color="gray",fontsize=20)
        plot4+=text("$y$",(2.25,2),color="gray",fontsize=20)
        plot4
      </sageplot>
    </image>
  </figure>
  <p>
    A helpful way to visualize a location based on polar coordinates is to stand at the origin, facing the positive horizontal axis; turn an angle of <m>\theta</m> counterclockwise; and move <m>r</m> in the direction you are facing.
  </p>
  <example>
    <p>
      Our first example will look at the location given by <m>P:(r,\theta)=(2,\frac{\pi}{2})</m>. To understand where this point is, we do the following steps:  from the origin, face the positive <m>x</m>-axis; turn <m>\frac{\pi}{2}</m> radians counterclockwise (to the positive <m>y</m> axis); and move two units in the direction you are now facing.
    </p>
    <sidebyside>
      <figure xml:id="polarex1">
        <caption>Starting orientation of polar coordinates</caption>
        <image label="img-plarex1">
          <description><p>Starting orientation of polar coordinates</p>
        </description><sageplot>
            plot5=arrow((0,0),(1,0),color="black",axes=True,axes_labels=["$x$","$y$"],ticks=[[],[]])
            plot5+=text("Face this way",(1,0.25),fontsize=20,color="black",xmin=-0.5,xmax=1.5,ymin=-0.5,ymax=1.5,aspect_ratio=1)
            plot5
          </sageplot>
        </image>
      </figure>
      <figure xml:id="polarex2">
        <caption>Rotate by <m>\frac{\pi}{2}</m> counterclockwise</caption>
        <image label="img-polarex2">
          <description><p>Rotate by <m>\frac{\pi}{2}</m> counterclockwise</p>
        </description><sageplot>
            var('t')
            plot6=arrow((0,0),(0,1),color="black",axes=True,axes_labels=["$x$","$y$"],ticks=[[],[]])
            plot6+=text("Face this way",(0.15,1.1),fontsize=20,color="black")
            plot6+=parametric_plot((0.5*cos(t),0.5*sin(t)),(t,0,pi/2),color="blue")+arrow((0.5*cos(pi/2-.1),0.5*sin(pi/2-.1)),(0,0.5),color="blue",xmin=-0.5,xmax=1.5,ymin=-0.5,ymax=1.5,aspect_ratio=1)
            plot6
          </sageplot>
        </image>
      </figure>
      <figure xml:id="polarex3">
        <caption> Move two units in this direction</caption>
        <image label="img-polarex3">
          <description><p> Move two units in this direction</p>
        </description><sageplot>
            var('t')
            plot7=line([(0,0),(0,1.25)],color="red",thickness=3,axes=True,axes_labels=["$x$","$y$"],ticks=[[],[]])+text("2",(-0.2,1),color="red",fontsize=15)
            plot7+=parametric_plot((0.5*cos(t),0.5*sin(t)),(t,0,pi/2),color="blue")+arrow((0.5*cos(pi/2-.1),0.5*sin(pi/2-.1)),(0,0.5),color="blue")
            plot7+=text("$\\theta$",(0.6,0.6),color="blue",fontsize=25)
            plot7+=point((0,1.25),color="black",size=40)+text("$P:(r,\\theta)=(2,\\pi/2)$",(0.65,1.3),fontsize=22,color="black",xmin=-0.5,xmax=1.5,ymin=-0.5,ymax=1.5,aspect_ratio=1)
            plot7
          </sageplot>
        </image>
      </figure>
    </sidebyside>
    <p>
      Geometrically, we can see that this location would have rectangular coordinates of <m>(x,y)=(0,2)</m>. While geometry is useful for understanding meaning, it is rarely wise to compute things like coordinates using only a graph. Later in this section, we will talk about algebraic tools that will allow us to convert between rectangular and polar coordinates.
    </p>
    <p>
      If we considered the point with polar coordinates <m>Q:(r,\theta)=(-2,-\frac{\pi}{2})</m>, we would do the following geometric instructions:
    </p>
    <sidebyside>
      <figure xml:id="polarex4">
        <caption>Starting orientation of polar coordinates</caption>
        <image label="img-plarex4">
          <description><p>Starting orientation of polar coordinates</p>
        </description><sageplot>
            plot5=arrow((0,0),(1,0),color="black",axes=True,axes_labels=["$x$","$y$"],ticks=[[],[]])
            plot5+=text("Face this way",(1,0.25),fontsize=20,color="black",xmin=-0.5,xmax=1.5,ymin=-0.5,ymax=1.5,aspect_ratio=1)
            plot5
          </sageplot>
        </image>
      </figure>
      <figure xml:id="polarex5">
        <caption>Rotate by <m>\frac{\pi}{2}</m> clockwise</caption>
        <image label="img-polarex5">
          <description><p>Rotate by <m>\frac{\pi}{2}</m> clockwise</p>
        </description><sageplot>
            var('t')
            plot6=arrow((0,0),(0,-1),color="black",axes=True,axes_labels=["$x$","$y$"],ticks=[[],[]])
            plot6+=text("Face this way",(0.25,-1.1),fontsize=20,color="black")
            plot6+=parametric_plot((0.5*cos(t),-0.5*sin(t)),(t,0,pi/2),color="blue")
            plot6+=arrow((0.5*cos(pi/2-.1),-0.5*sin(pi/2-.1)),(0,-0.5),color="blue",xmin=-0.5,xmax=1,ymin=-1.25,ymax=0.5,aspect_ratio=1)
            plot6
          </sageplot>
        </image>
      </figure>
      <figure xml:id="polarex6">
        <caption> Move two units backwards while facing this direction</caption>
        <image label="img-polarex6">
          <description><p> Move two units backwards while facing this direction</p>
        </description><sageplot>
            var('t')
            plot7=line([(0,0),(0,1.5)],color="red",thickness=3,axes=True,axes_labels=["$x$","$y$"],ticks=[[],[]],linestyle="--")
            plot7+=text("-2",(-0.2,1),color="red",fontsize=15)
            plot7+=parametric_plot((0.5*cos(t),-0.5*sin(t)),(t,0,pi/2),color="blue")
            plot7+=arrow((0.5*cos(pi/2-.1),-0.5*sin(pi/2-.1)),(0,-0.5),color="blue")
            plot7+=text("$\\theta=-\\frac{\\pi}{2}$",(0.7,-0.6),color="blue",fontsize=20)
            plot7+=point((0,1.5),color="black",size=40,zorder=5)
            plot7+=arrow((0,0),(0,-1),color="gray",thickness=2)
            plot7+=text("$Q:(r,\\theta)=(-2,-\\pi/2)$",(0.85,1.5),fontsize=22,color="black",xmin=-0.5,xmax=1.5,ymin=-0.5,ymax=1.5,aspect_ratio=1)
            plot7
          </sageplot>
        </image>
      </figure>
    </sidebyside>
    <p> 
      Notice that both <m>P:(r,\theta)=(2,\frac{\pi}{2})</m> and <m>Q:(r,\theta)=(-2,-\frac{\pi}{2})</m> correspond to the location with rectangular coordinates <m>(0,2)</m>. This example highlights how polar coordinates are measured and how there is <alert>not</alert> a unique set of polar coordinates for a location.
    </p>
  </example>
  <p>
    If you look at <xref ref="coord2d-2"/>, you can see a right triangle in the first quadrant with base <m>x</m> and height <m>y</m>. The angle the hypotenuse makes with the base is <m>\theta</m>. From this, you can deduce the four relationships shown below, which are used to convert between rectangular and polar coordinates. It may be insightful to draw triangles of this type in each of the quadrants to confirm for yourself that these conversion formulas are valid in all four cases.
  </p>
  <assemblage xml:id="rect-polar">
    <title>Converting between rectangular and polar coordinates</title>
    <p>
      <dl>
        <li>
          <title>From polar to rectangular</title>
          <p>
            Given polar coordinates <m>(r,\theta)</m> of a point <m>P</m>, the rectangular coordinates <m>(x,y)</m> of <m>P</m> satisfy
            <md>
              <mrow>x \amp = r \cos(\theta) \amp  y \amp= r \sin(\theta)</mrow>
            </md>.
          </p>
        </li>
        <li>
          <title>From rectangular to polar</title>
          <p>
            Given rectangular coordinates <m>(x,y)</m> of a point <m>P</m>, the polar coordinates <m>(r,\theta)</m> of <m>P</m> satisfy
            <md>
              <mrow>r^2  \amp = x^2  + y^2 \amp \tan(\theta) \amp= \frac{y}{x} </mrow>
            </md>,
            assuming <m> x \neq 0</m>.
          </p>
        </li>
      </dl>
    </p>
  </assemblage>
  <p>
    It is important to notice that the equations used in the conversion from polar to rectangular work to convert coordinates of a point for <em>any</em> values of <m>r</m> and <m>\theta</m>, including negative <m>r</m>-values and values of <m>\theta</m> outside the interval <m>[0,2\pi]</m>. The conversion equations to go from rectangular to polar require you to interpret the results of your calculation by choosing from multiple suitable values for <m>r</m> and <m>\theta</m>. This is because we are not able to solve uniquely for <m>r</m> and <m>\theta</m> in terms of <m>x</m> and <m>y</m>. This is because there is not a unique set of polar coordinates for a location. A point can have many different polar coordinates that refer to the same location.
  </p>
  <p>
    For example, the point with rectangular coordinates <m>(-1,-1)</m> can be given the polar coordinates <m>(r,\theta)=(\sqrt{2},\frac{5\pi}{4})</m> or <m>(r,\theta)=(-\sqrt{2},\frac{-\pi}{4})</m> or <m>(r,\theta)=(\sqrt{2},\frac{13\pi}{4})</m> or <m>(r,\theta)=(\sqrt{2},-\frac{3\pi}{4})</m> or <m>(r,\theta)=(-\sqrt{2},-\frac{7\pi}{4})</m> (amongst many others). The good news is that when you need to choose appropriate <m>r</m> and <m>\theta</m>, you can make proper choices based on your experience with quadrants and where the point is (in terms of <m>x</m> and <m>y</m>). 
  </p>

<example xml:id="polar-interpret">
  <p>
    In this example, we will look at how to convert the points with rectangular coordinates <m>P=(-2,3)</m> and <m>Q=(-3,-2)</m> into polar coordinates. Note here that <m>P</m> is in the second quadrant and <m>Q</m> is in the third quadrant. 
  </p>
  <p>
    Using the conversion equations for <m>P=(-2,3)</m>, we see that
    <me>
      r^2  = (-2)^2  + (3)^2 \ \ \ \ \ \tan(\theta) = -\frac{3}{2} 
      </me>
    which means we need to pick <m>r</m> to be <m>\sqrt{13}</m> or <m>-\sqrt{13}</m>. We will need to pick an appropriate angle for these possible <m>r</m>-values that satisfy <m>\tan(\theta) = -\frac{3}{2}</m>. There are angles in the fourth and second quadrants that will satisfy <m>\tan(\theta) = -\frac{3}{2}</m>, namely <m>\arctan(-\frac{3}{2})</m> and <m> \pi +\arctan(-\frac{3}{2})</m>. You could also choose any angle coterminal to either of these angles. This is not a situation where we can arbitrarily combine one of the choices of <m>r</m> will work with any choice of <m>\theta</m>. We must interpret these choices <em>together</em> to get a description for the correct location. 
    </p>
    <p>
      If we choose <m>r=\sqrt{13}</m>, then we need to select the angle that corresponds to the second quadrant, <m>\pi + \arctan(-\frac{3}{2})</m>, to get polar coordinates <m>P=(r,\theta)=(\sqrt{13},\pi+\arctan(-\frac{3}{2}))</m>. If we want to not have to use the complementary angle to <m>\arctan(-\frac{3}{2})</m>, then we need to use the negative value of <m>r</m> to get <m>P=(r,\theta)=(-\sqrt{13},\arctan(-\frac{3}{2}))</m>. <xref ref="rectpolarex"/> illustrates these two different polar coordinates that identify the point <m>P</m>
  </p>
  <figure xml:id="rectpolarex">
  <sidebyside valign="bottom">
    <figure xml:id="rectpolarex1">
      <caption>A visualization of <m>P</m> with polar coordinates <m>(\sqrt{13},\arctan(-\frac{3}{2}))</m></caption>
      <image label="img-rectpolarex1">
        <description><p>A 2D plot of the point with polar coordinates <m>(\sqrt{13},\arctan(-\frac{3}{2}))</m></p></description>
        <sageplot>
          var('t') 
          plot9=point((-2,3),color="black",size=30)+text("$P$",(-1.5,3),color="black",fontsize=20)
          plot9+=line([(0,0),(-2,3)],color="red",thickness=2,axes=True,axes_labels=["$x$","$y$"])+text("$-\\sqrt{13}$",(-2,1),color="red",fontsize=15)
          plot9+=parametric_plot((1.5*cos(t),1.5*sin(t)),(t,arctan(-1.5),0),color="blue")
          plot9+=arrow((1.5*cos(arctan(-1.5)+.01),1.5*sin(arctan(-1.5)+.01)),(1.5*cos(arctan(-1.5)),1.5*sin(arctan(-1.5))),color="blue")
          plot9+=line([(0,0),(4,-6)],color="blue",linestyle="--")+text("$\\arctan\\left(-\\frac{3}{2}\\right)$",(2.5,-1),color="blue",fontsize=15,xmin=-4,xmax=4,ymin=-4,ymax=4,aspect_ratio=1)
          plot9
        </sageplot>
      </image>
    </figure>
    <figure xml:id="rectpolarex2">
      <caption>A visualization of <m>P</m> with polar coordinates <m>(-\sqrt{13},\pi+\arctan(-\frac{3}{2}))</m></caption>
      <image label="img-rectpolarex2">
        <description><p>A 2D plot of the point with polar coordinates <m>(-\sqrt{13},\pi+\arctan(-\frac{3}{2}))</m></p></description>
        <sageplot>
          var('t') 
          plot8=line([(0,0),(-2,3)],color="red",thickness=2,axes=True,axes_labels=["$x$","$y$"])+text("$\\sqrt{13}$",(-2,1),color="red",fontsize=15)
          plot8+=parametric_plot((cos(t),sin(t)),(t,0,pi+arctan(-1.5)),color="blue")
          plot8+=arrow((cos(pi+arctan(-1.5)-.01),sin(pi+arctan(-1.5)-.01)),(cos(pi+arctan(-1.5)),sin(pi+arctan(-1.5))),color="blue")
          plot8+=parametric_plot((1.5*cos(t),1.5*sin(t)),(t,arctan(-1.5),0),color="green")
          plot8+=arrow((1.5*cos(arctan(-1.5)+.01),1.5*sin(arctan(-1.5)+.01)),(1.5*cos(arctan(-1.5)),1.5*sin(arctan(-1.5))),color="green")
          plot8+=point((-2,3),color="black",size=30)+text("$P$",(-1.6,3.1),color="black",fontsize=20)
          plot8+=line([(0,0),(4,-6)],color="green",linestyle="--")+text("$\\arctan\\left(-\\frac{3}{2}\\right)$",(2.5,-1),color="green",fontsize=15)
          plot8+=text("$\\pi+\\arctan\\left(-\\frac{3}{2}\\right)$",(2,1.25),color="blue",fontsize=15,xmin=-4,xmax=4,ymin=-4,ymax=4,aspect_ratio=1)
          plot8
        </sageplot>
      </image>
    </figure>
  </sidebyside>
  </figure>
  <p>
    Now we will look at how to convert <m>Q=(-3,-2)</m> into polar coordinates. Similar to our arguments above, we find that <m>Q=(-3,-2)</m> implies that <m>r^2=9+4=13</m> and <m>\tan(\theta)=\frac{-2}{-3}</m>. If we want to consider a positive value for <m>r</m> and a value of <m>\theta</m> between <m>0</m> and <m>2\pi</m>, then we get <m>r=\sqrt{13}</m> and <m>\theta=\arctan(\frac{2}{3})+\pi </m>. We could also consider a negative value for <m>r</m> and a value of <m>\theta</m> between <m>0</m> and <m>2\pi</m>, which would yield <m>r=-\sqrt{13}</m> and <m>\theta=\arctan(\frac{2}{3}) </m>. <xref ref="rectpolarex-Q"/> illustrates these two perspectives on finding polar coordinates for <m>Q</m>
  </p>
  <figure xml:id="rectpolarex-Q">
  <sidebyside>
    <figure xml:id="rectpolarex3">
      <caption>A visualization of <m>Q</m> with polar coordinates <m>(\sqrt{13},\pi+\arctan(\frac{2}{3}))</m></caption>
      <image label="img-rectpolarex4">
        <description><p>A 2D plot of the point with polar coordinates <m>(\sqrt{13},\pi+\arctan(\frac{2}{3}))</m></p></description>
        <sageplot>
          var('t')
          plot38=line([(0,0),(-3,-2)],color="red",thickness=2,axes=True,axes_labels=["$x$","$y$"])
          plot38+=text("$\\sqrt{13}$",(-2.5,-1),color="red",fontsize=15)
          plot38+=parametric_plot((cos(t),sin(t)),(t,0,pi+arctan(2/3)),color="blue")
          plot38+=arrow((cos(pi+arctan(2/3)-.01),sin(pi+arctan(2/3)-.01)),(cos(pi+arctan(2/3)),sin(pi+arctan(2/3))),color="blue")
          plot38+=parametric_plot((1.5*cos(t),1.5*sin(t)),(t,0,arctan(2/3)),color="green")
          plot38+=arrow((1.5*cos(arctan(2/3)-.01),1.5*sin(arctan(2/3)-.01)),(1.5*cos(arctan(2/3)),1.5*sin(arctan(2/3))),color="green")
          plot38+=point((-3,-2),color="black",size=30,zorder=5)+text("$Q$",(-3.25,-2.25),color="black",fontsize=20)
          plot38+=line([(0,0),(6,4)],color="green",linestyle="--")+text("$\\arctan\\left(\\frac{2}{3}\\right)$",(2.5,0.5),color="green",fontsize=15)
          plot38+=text("$\\pi+\\arctan\\left(\\frac{2}{3}\\right)$",(-2,1.25),color="blue",fontsize=15,xmin=-4,xmax=4,ymin=-4,ymax=4,aspect_ratio=1)
          plot38
        </sageplot>
      </image>
    </figure>
    <figure xml:id="rectpolarex4">
      <caption>A visualization of <m>Q</m> with polar coordinates <m>(-\sqrt{13},\arctan(\frac{2}{3}))</m></caption>
      <image label="img-rectpolarex3">
        <description><p>A 2D plot of the point with polar coordinates <m>(-\sqrt{13},\arctan(\frac{2}{3}))</m></p></description>
        <sageplot>
          var('t')
          plot39=point((-3,-2),color="black",size=30,zorder=5)+text("$Q$",(-3.25,-2.25),color="black",fontsize=20)
          plot39+=line([(0,0),(-3,-2)],color="red",thickness=2,axes=True,axes_labels=["$x$","$y$"],zorder=0)
          plot39+=text("$-\\sqrt{13}$",(-2.5,-1),color="red",fontsize=15)
          plot39+=parametric_plot((1.5*cos(t),1.5*sin(t)),(t,0,arctan(2/3)),color="blue")
          plot39+=arrow((1.5*cos(arctan(2/3)-.01),1.5*sin(arctan(2/3)-.01)),(1.5*cos(arctan(2/3)),1.5*sin(arctan(2/3))),color="blue")
          plot39+=line([(0,0),(6,4)],color="blue",linestyle="--")+text("$\\arctan\\left(\\frac{2}{3}\\right)$",(2.5,0.75),color="blue",fontsize=15,xmin=-4,xmax=4,ymin=-4,ymax=4,aspect_ratio=1)
          plot39
        </sageplot>
      </image>
    </figure>
  </sidebyside>
  </figure>
  <p>
    Remember that inverse trig functions have limited domains and ranges, the <m>r</m>-coordinate can be positive or negative, and polar coordinates do not have unique values for a given point.
  </p> 
</example>
<p>
  The following activity gives you an opportunity to practice converting between rectangular and polar coordinates.
</p>
<worksheet>
  <activity workspace="1.5in">
  <task>
    <introduction>
      <p>
        For each of the points listed below, you should:
        <ul>
          <li>
            Graph the point on a set of axes and label how each of the rectangular coordinates is measured.
          </li>
          <li>
            Draw and label how the polar coordinates are measured for each point.
          </li>
          <li>
            Compute the exact value of <m>r</m> and <m>\theta</m> for each point. Exact values include things like <m>\sqrt{3}</m>, <m>\arcsin(3/4)</m>, etc. Simplify trigonometric function values of any common angles you encounter, like <m>\sin\left(\frac{\pi}{3}\right)=\frac{\sqrt{3}}{2}</m>.
          </li>
        </ul>
      </p>
    </introduction>
    <task>
      <statement>
        <p>
          <m>(x,y)=(-3,-7)</m>
        </p>
      </statement>
    </task>
    <task>
      <statement>
        <p>
          <m>(x,y)=(7,-3)</m>
        </p>
      </statement>
    </task>
    <task>
      <statement>
        <p>
          <m>(x,y)=(\sqrt{5},-2)</m>
        </p>
      </statement>
    </task>
    <task xml:id="translatedcircpt1">
      <statement>
        <p>
          <m>(x,y)=\left(\frac{3}{2},-\frac{3}{2}\right)</m>
        </p>
      </statement>
    </task>
    <task xml:id="translatedcircpt2">
      <statement>
        <p>
          <m>(x,y)=\left(\frac{3}{2},\frac{3}{2}\right)</m>
        </p>
      </statement>
    </task>
  </task>
  <task>
    <introduction>
      <p>
        For each of the points listed below, you should:
        <ul>
          <li>
            Graph the point on a set of axes and label how each of the polar coordinates is measured.
          </li>
          <li>
            Draw and label how the rectangular coordinates are measured for each point.
          </li>
          <li>
            Compute the exact value of <m>x</m> and <m>y</m> for each point. Exact values include things like <m>\sqrt{3}</m>, <m>\arcsin(3/4)</m>, etc. Simplify trigonometric function values of any common angles you encounter, like <m>\sin\left(\frac{\pi}{3}\right)=\frac{\sqrt{3}}{2}</m>.
          </li>
        </ul>
      </p>
    </introduction>
    <task>
      <statement>
        <p>
          <m>(r,\theta)=\left(1,-\frac{\pi}{6}\right)</m>
        </p>
      </statement>
    </task>
    <task xml:id="translatedcircpt3">
      <statement>
        <p>
          <m>(r,\theta)=\left(\sqrt{3},\arctan\left(\frac{\sqrt{2}}{2}\right)\right)</m>
        </p>
      </statement>
    </task>
    <task>
      <statement>
        <p>
          <m>(r,\theta)=\left(-\sqrt{5},0\right)</m>
        </p>
      </statement>
    </task>
    <task>
      <statement>
        <p>
          <m>(r,\theta)=\left(7,\frac{3\pi}{4}\right)</m>
        </p>
      </statement>
    </task>
    <task>
      <statement>
        <p>
          <m>(r,\theta)=\left(3,\pi-\frac{\pi}{6}\right)</m>
        </p>
      </statement>
    </task>
  </task>
</activity>
</worksheet>
<p>
  We now want to look at converting an equation between rectangular and polar coordinates. Remember that the graph of an equation is the set of all points that satisfy the equation. When we say that we want to convert an equation such as <m>x=y^2</m> to polar coordinates, we mean that we want to find an equation in <m>r</m> and <m>\theta</m> whose graph will be exactly the same set of points as <m>x=y^2</m>. This will be fairly easy because we have conversion equations that are solved explicitly and uniquely for <m>x</m> and <m>y </m>: <m>x=r\cos(\theta)</m> and <m>y=r\sin(\theta)</m>.
</p>  
<example>
  <p>
    We can convert the equation <m>x=y^2</m> to polar coordinates by substituting <m>x=r\cos(\theta)</m> and <m>y=r\sin(\theta)</m> to get
    <md>
      <mrow>x \amp= y^2 </mrow>
      <mrow>r \cos(\theta) \amp= (r \sin(\theta)^2) </mrow>
      <mrow>r \cos(\theta) \amp= r^2 \sin(\theta)^2 </mrow>
      <mrow> \frac{\cos(\theta)}{\sin(\theta)^2} \amp= r</mrow>
      <mrow> r \amp= \cot(\theta) \csc(\theta)</mrow>
    </md>
    This tells us that the <m>(r,\theta)</m> points satisfying <m>r = \cot(\theta) \csc(\theta)</m> are the same locations as the <m>(x,y)</m> points that satisfy <m>x=y^2</m>. <alert>Except</alert>, we divided by <m>\sin(\theta)</m>, which will not give an equivalent equation if <m>\sin(\theta)=0</m>.  Notice that if <m>\theta=0</m> (or any integer multiple of <m>\pi</m>), then <m> \cot(\theta) \csc(\theta)</m> does not exist. In a technical sense, we would either need to stop our algebra at <m> cos(\theta)=r \sin(\theta)^2</m> or use a piecewise defined expression such as
    <me>
      r= \begin{cases}
          0  \amp \theta=0 \\
          \cot(\theta) \csc(\theta) \amp \theta\neq 0\text{.}
        \end{cases} 
    </me>
    This example highlights the tricky part of converting equations: without careful algebraic steps, you can miss points that need to be included in the graphs/equations or possibly get nonsensical statements. Often we will use geometric intuition and information to help convert equations between coordinate systems and make sense of the resulting expressions.
  </p>
</example>
<p>
  The previous example showed that converting an equation from rectangular coordinates to polar coordinates is mostly straightforward, although we must pay attention to issues where expressions may become undefined. Our next example focuses on the converstion from polar to rectangular coordinates, which has additional subtleties.
</p>
<example xml:id="eqnconversion2">
  <p>
    In this example, we will convert the equation <m>r=3\cos(\theta)</m> into rectangular coordinates, identify the shape of its graph, and plot its graph. Remember that we do not have conversion equations for <m>r</m> and <m>\theta</m>, but we do have some equations relating the variables, such as <m>r^2=x^2+y^2</m>. This will allow us to convert to an expression in <m>x</m> and <m>y</m> that does not require intepretation. We start by squaring both sides of our polar equation, since this will give us an expression on the left-hand side of the equation that will be easy to convert to rectangular coordinates. This yields
    <me> r =3\cos(\theta) \Rightarrow r^2=9 (\cos(\theta))^2 \Rightarrow x^2+y^2 = 9  (\cos(\theta))^2 </me>
    Our last equation is a mix of rectangular and polar coordinates so we are not done with our coversion to rectangular coordinates. Unfortunately the easiest way to convert <m>(\cos(\theta))^2</m> to rectangular is to use 
    <me> x=r \cos(\theta) \Rightarrow (\cos(\theta))^2=\frac{x^2}{r^2} \Rightarrow (\cos(\theta))^2=\frac{x^2}{x^2+y^2} </me>
    which will give us a rational expression for our conversion. This would require some extra algebra and interpretation, so let's try a slightly different approach. 
  </p>
  <p>
    Instead of squaring both sides of our polar equation, we can start by multiplying both sides by <m>r</m>. You may have seen this as a better approach from the start or gained this insight after our work above. 
    <!-- Remember, there are multiple paths to insight and being able to incorporate new ideas and information to form new strategies is a vital skill to solving interesting and realistic problems.  -->
  </p>
  <p> 
    After we multiply both sides of our original equation by <m>r</m>,  we have
    <me>  r =3\cos(\theta) \Rightarrow r^2=3 r \cos(\theta) </me>
    This equation is great because <em>both</em> the left and right hand sides have explicit conversions to rectangular coordinates that do not require separate interpretation of quadrants. Thus, we see that the <m>(r,\theta)</m> points that satisfy <m> r = 3 \cos(\theta)</m> are the same locations as the <m>(x,y)</m> points that satisfy <m>x^2+y^2=3x</m>. 
  </p>
  <p>
    We have now converted our polar equation to a rectangular equation. What shape will the graph of <m>x^2+y^2=3x</m> (or <m> r = 3 \cos(\theta)</m>) be? We can use the algebraic technique of completing the square to transform our equation into the the standard form of a circle: <m> (x-h)^2+(y-k)^2 = R^2</m>. 
    <md>
      <mrow>x^2 \phantom{-3x+\frac{9}{4}}+y^2 \amp = 3x</mrow>
      <mrow>x^2 -3x \phantom{+\frac{9}{4}} +y^2 \amp= 0  </mrow>
      <mrow>x^2 -3x +\frac{9}{4}  +y^2 \amp= 0+\frac{9}{4}</mrow>
      <mrow> \left(x -\frac{3}{2}\right)^2  +(y-0)^2 \amp= \left(\frac{3}{2}\right)^2</mrow>
    </md>
    We can see now that this circle will have center <m>(\frac{3}{2},0)</m> and radius <m>\frac{3}{2}</m>. The graph of <m>r =3\cos(\theta)</m> is the same as <m>x+y^2=3x</m> or <m>(x -\frac{3}{2})^2  +(y-0)^2 =\left(\frac{3}{2}\right)^2</m>, which is plotted below.
  </p>
  <figure xml:id="converteqnex2">
    <caption>A plot of <m>r=3\cos(\theta)</m></caption>
    <image width="55%" label="img-converteqn2">
      <description><p>A plot of a circle with center <m>(\frac{3}{2},0)</m> and radius <m>\frac{3}{2}</m> </p></description>
      <sageplot>
        var('t')
        plot10=parametric_plot((1.5*cos(t)+1.5,1.5*sin(t)),(t,0,2*pi),thickness=3,color="black",axes=True,axes_labels=["$x$","$y$"],gridlines=True,xmin=-1,xmax=4,ymin=-2,ymax=2,aspect_ratio=1)
        plot10
      </sageplot>
    </image>
  </figure>
  <p>
    While many people will find the rectangular equation more comfortable to graph and work with, this conversion from polar to rectangular is not always needed. You can find many resources on plotting points of a polar equation without converting to rectangular coordinates, especially when one coordinate (typically <m>r</m>) is solved explicitly in terms of the other coordinate.
  </p>
</example>


<p>
  You can see that both of the rectangular and polar coordinates of the points in <xref ref="translatedcircpt1" text="phrase-hybrid"/>, <xref ref="translatedcircpt2" text="phrase-local"/>, and <xref ref="translatedcircpt3" text="phrase-local"/> will satisfy the equations of <xref ref="eqnconversion2"/>. The plot below shows how you can visualize <xref ref="translatedcircpt3" text="phrase-local"/>.
</p>
<figure xml:id="converteqnex3">
  <caption>A plot of <m>r=3\cos(\theta)</m> with the polar coordinate measurements of <xref ref="translatedcircpt3"/></caption>
  <image width="75%" xml:id="img-converteqn3">
    <description><p>A plot of <m>r=3\cos(\theta)</m> with the polar coordinate measurements of <xref ref="translatedcircpt3"/></p>
  </description><sageplot>
      var('t')
      plot11=parametric_plot((1.5*cos(t)+1.5,1.5*sin(t)),(t,0,2*pi),thickness=2,color="black",axes=True,axes_labels=["$x$","$y$"],gridlines=True)
      plot11+=line([(0,0),(1.5,-1.5)],color="blue",thickness=2)+text("$P=(r,\\theta) \\ =(\\sqrt{3},-\\arctan(\\frac{\\sqrt{2}}{2}))$",(1.5,-1.75),fontsize=15,color="blue")
      plot11+=point((1.5,-1.5),size=35,color="blue")+text("$-\\arctan(\\frac{\\sqrt{2}}{2})$",(1.3,-0.3),color="blue",fontsize=15)
      plot11+=parametric_plot((.7*cos(t),.7*sin(t)),(t,-pi/4,0),color="blue")
      plot11+=arrow((.7*cos(0.1-pi/4),.7*sin(0.1-pi/4)),(.7*cos(-pi/4),.7*sin(-pi/4)),color="blue",xmin=-1,xmax=4,ymin=-2,ymax=2,aspect_ratio=1)
      plot11
    </sageplot>
  </image>
</figure>
<worksheet>
  <activity workspace="1.5in">
  <introduction>
    <p>
      This activity gives you an opportunity to graph some equations in polar coordinates where <m>r</m> is expressed as a function of <m>\theta</m>. 
    </p>
  </introduction>
  <task>
    <introduction>
      <p>
        The following activity will take you through how to create a graph of an equation in <m>r</m> and <m>\theta</m>.
      </p>
    </introduction>
    <task>
      <p>
        Draw a graph of <m> y=\cos(x)</m> for at least <m> 0 \leq x \leq 2 \pi</m>.
      </p>
    </task>
    <task>
      <p>
        Consider the polar equation <m> r=\cos(\theta)</m>. Complete the table below by computing the value of <m>r</m> for each value of <m>\theta</m> for this equation.
      </p>
      <tabular row-headers="yes">
        <row header="yes" bottom="minor">
          <cell right="minor"><m>\theta</m></cell>
          <cell><m>0</m></cell>
          <cell><m>\displaystyle\frac{\pi}{4}</m></cell>
          <cell><m>\displaystyle\frac{\pi}{6}</m></cell>
          <cell><m>\displaystyle\frac{\pi}{3}</m></cell>
          <cell><m>\displaystyle\frac{\pi}{2}</m></cell>
          <cell><m>\displaystyle\frac{3\pi}{4}</m></cell>
          <cell><m>\pi</m></cell>
          <cell><m>\displaystyle\frac{5\pi}{4}</m></cell>
          <cell><m>\displaystyle\frac{3\pi}{2}</m></cell>
          <cell><m>\displaystyle\frac{7\pi}{4}</m></cell>
          <cell><m>2\pi</m></cell>
        </row>
        <row>
          <cell right="minor"><m>r</m></cell>
          <cell/>
          <cell><m>\phantom{\displaystyle\frac{\sqrt{2}}{2}}</m></cell><!-- Put this in here to increase the row height-->
          <cell/>
          <cell/>
          <cell/>
          <cell/>
          <cell/>
          <cell/>
          <cell/>
          <cell/>
          <cell/>
        </row>
      </tabular>
    
    </task>
    <task>
      <p>Plot each of the eleven points you found in the previous part on the polar plane and connect them to make a plot of the graph of <m>r=\cos(\theta)</m>.</p>
    </task>
  </task>
  <task>
    <p>Graph the equation <m>r=1+\cos(\theta)</m> in the polar plane.</p>
    </task>
    <task>
      <p>Graph the equation <m>r=1-\cos(\theta)</m> in the polar plane.</p>
    </task>
    <task>
      <p>What are the points of intersections for the graphs of <m>r=1+\cos(\theta)</m> and <m>r=1-\cos(\theta)</m></p>
    </task>
  </activity>
</worksheet>
  <p>
    Now that you have some experience with plotting polar equations, the next activity will allow you to practice converting between polar and rectangular forms and seeing how graphs can help you with understanding these equations.
  </p>
  <worksheet>
  <activity workspace="1.5in">
    <introduction>
      <p>
        Below are several equations, some in polar form and some in rectangular form. For each equation, complete the following steps:
        <ol marker="i.">
          <li>
            Convert the equation to the other coordinate system (either rectangular to polar or polar to rectangular).
          </li>
          <li>
            State the shape of the graph for the equation and any other information needed to graph
          </li>
          <li>
            Graph the given equation and write a sentence explaining how the graph helps understand the converted equation you found in the first step.
          </li>
        </ol>
      </p>
      </introduction>
      <task>
        <statement>
          <p>
            <m>r=2</m>
          </p>
        </statement>
      </task>
      <task>
        <statement>
          <p>
            <m>\theta=\frac{\pi}{3}</m>
          </p>
        </statement>
      </task>
      <task>
        <statement>
          <p>
            <m>x=-1</m>
          </p>
        </statement>
      </task>
      <task>
        <statement>
          <p>
            <m>y=2</m>
          </p>
        </statement>
      </task>
      <task>
        <statement>
          <p>
            <m>y=-x</m>
          </p>
        </statement>
      </task>
      <task>
        <statement>
          <p>
            <m>r=\displaystyle\frac{3}{1-2\cos(\theta)}</m>
          </p>
        </statement>
        <hint>
          <p>
            You may find it useful to have an intermediate step with an equation involving both <m>r</m> and <m>x</m> and completing the square as in <xref ref="eqnconversion2"/> will likely be useful as well.
          </p>
        </hint>
      </task>
  </activity>
</worksheet>
  <p>
    In <xref ref="coord2d-PA"/>, you saw how a rectangular grid makes it easy to determine the rectangular coordinates of a point. A polar grid gives the same tools by plotting an array of constant coordinate graphs. An example of a polar grid is given in <xref ref="polargrid"/>, and thinking about this polar grid should help you answer the questions in <xref ref="act-polar-constant"/>
  </p>
  <figure xml:id="polargrid">
    <caption>A polar grid (from <url href="https://commons.wikimedia.org/wiki/File:Polar_coordinates_grid.svg" visual="commons.wikimedia.org/wiki/File:Polar_coordinates_grid.svg">WikiMedia</url>)</caption>
    <image width="60%" source="./images/Polar_coordinates_grid.png">
      <description>
        <p>A plot consisting of six concentric circles centered at the origin as well as rays emanating from the origin in <m>15^\circ</m> increments from <m>0^\circ</m> to <m>345^\circ</m>.
        </p>
      </description>
    </image>
  </figure>
  <worksheet>
  <activity workspace="1.5in" xml:id="act-polar-constant">
    <task>
      <statement>
        <p>
          Write a couple of sentences describing the graph of <m>r=c</m>, where <m>c</m> is a constant. You should consider what values of <m>c</m> will correspond to different shapes.
        </p>
      </statement>
    </task>
    <task>
      <statement>
        <p>
          Write a couple of sentences describing the graph of <m>\theta=d</m>, where <m>d</m> is a constant. You should consider what values of <m>d</m> will correspond to different shapes.
        </p>
      </statement>
    </task>
  </activity>
</worksheet>
  <p>
    The last idea of conversion we will look at between rectangular and polar coordinates is how to convert regions or inequalities between coordinate systems. Just as a graph of a an equation is a plot of the set of points that satisfies the equation, the graph of an inequality (or set of inequalities) is the region of points that satisfy the inequality. 
  </p>
  <example>
    <p>
      The graph of the inequality <m> -1\leq x \leq 1</m> is the vertical strip of points with horizontal coordinate between <m>-1</m> and <m>1</m> (inclusive) and has graph shown in <xref ref="convertreg1"/>.
    </p>
    <figure xml:id="convertreg1">
      <caption>A plot of <m> -1\leq x \leq 1</m> </caption>
      <image width="75%" xml:id="img-convertreg1">
        <description><p>A plot of <m> -1\leq x \leq 1</m> </p>
      </description><sageplot>
          plot12=line([(-1,-5),(-1,5)],color="black",thickness=2,axes=True,axes_labels=["$x$","$y$"],gridlines=True)
          plot12+=line([(1,-5),(1,5)],color="black",thickness=2)+polygon([(-1,-5),(-1,5),(1,5),(1,-5),(-1,-5)],color="green",xmin=-3,xmax=3,ymin=-3,ymax=3,aspect_ratio=1)
          plot12
        </sageplot>
      </image>
    </figure>
    <p>
      If we consider the set of inequalities given by <m> -1\leq x \leq 1</m> and <m> 0\leq y \leq 2</m>, then we are looking for the region of points that satisfies both inequalities. The second inequality is shown in red in <xref ref="convertreg2"/> and the intersection of the two plots corresponds to the region described by <m> -1\leq x \leq 1</m> and <m> 0\leq y \leq 2</m>, which is plotted in blue <xref ref="convertreg3"/>.
    </p>
    <figure xml:id="converreg-container">
      <sidebyside>
        <figure xml:id="convertreg2">
          <caption>A plot of <m> 0\leq y \leq 2</m> </caption>
          <image width="75%" xml:id="img-convertreg2">
            <description><p>A plot of <m> 0\leq y \leq 2</m> </p>
          </description><sageplot>
              plot13=line([(-5,0),(5,0)],color="black",thickness=2,axes=True,axes_labels=["$x$","$y$"],gridlines=True)
              plot13+=line([(-5,2),(5,2)],color="black",thickness=2)+polygon([(-5,0),(5,0),(5,2),(-5,2),(-5,0)],color="red",xmin=-3,xmax=3,ymin=-3,ymax=3,aspect_ratio=1)
              plot13
            </sageplot>
          </image>
        </figure>
        <figure xml:id="convertreg3">
          <caption>A plot of <m> -1\leq x \leq 1</m> and <m> 0\leq y \leq 2</m></caption>
          <image width="75%" xml:id="img-convertreg3">
            <description><p>A plot of <m> -1\leq x \leq 1</m> and <m> 0\leq y \leq 2</m></p>
          </description><sageplot>
              plot14=line([(-5,0),(5,0)],color="black",thickness=2,axes=True,axes_labels=["$x$","$y$"],gridlines=True)
              plot14+=line([(-5,2),(5,2)],color="black",thickness=2)+polygon([(-5,0),(5,0),(5,2),(-5,2),(-5,0)],color="red")
              plot14+=line([(-1,-5),(-1,5)],color="black",thickness=2,axes=True,axes_labels=["$x$","$y$"],gridlines=True)
              plot14+=line([(1,-5),(1,5)],color="black",thickness=2)+polygon([(-1,-5),(-1,5),(1,5),(1,-5),(-1,-5)],color="green")
              plot14+=polygon([(-1,0),(1,0),(1,2),(-1,2),(-1,0)],color="blue",xmin=-3,xmax=3,ymin=-3,ymax=3,aspect_ratio=1)
              plot14
            </sageplot>
          </image>
        </figure>
      </sidebyside>
    </figure>
  </example>
  <p>
    Our final two activities on polar coordinates ask you to plot regions that satisfy inequalities in rectangular and polar coordinates.
  </p>
  <worksheet>
  <activity workspace="1.5in">
    <task>
      <statement>
        <p>
          Graph the points that satisfy <m>y=x+1</m>.
        </p>
      </statement>
    </task>
    <task>
      <statement>
        <p>
          On the same axes as in the previous part, graph the points that satisfy <m>y \geq x+1</m>.
        </p>
      </statement>
      <hint>
        <p>
          Will the points above or below the line you drew in the first part of this activity satisfy this inequality?
        </p>
      </hint>
    </task>
    <task>
      <statement>
        <p>
          Graph the points that satisfy the inequality <m>x^2+y^2 \leq 4</m>.
        </p>
      </statement>
    </task>
    <task>
      <statement>
        <p>
          Graph the points that satisfy both <m>x^2+y^2 \leq 4</m> and <m>y \geq x+1</m>.
        </p>
      </statement>
    </task>
  </activity>
</worksheet>
  <worksheet>
  <activity workspace="1.5in">
    <task>
      <statement>
        <p>
          Plot the region that corresponds to the polar inequality <m> 1 \leq r \leq 3</m>. Write a sentence or two to describe this region.
        </p>
      </statement>
    </task>
    <task>
      <statement>
        <p>
          Plot the region that corresponds to the polar inequality <m> \frac{\pi}{4} \leq \theta \leq \frac{3\pi}{4}</m>. Write a sentence or two to describe this region.
        </p>
      </statement>
    </task>
    <task>
      <statement>
        <p>
          Plot the region that corresponds to the polar inequalities <m> 1 \leq r \leq 3</m> and <m> \frac{\pi}{4} \leq \theta \leq \frac{3\pi}{4}</m>. Write a sentence or two to describe this region.
        </p>
      </statement>
    </task>
    <task>
      <statement>
        <p>
          Plot the region that corresponds to the polar inequality <m> 1 \leq r \leq 3 \cos(\theta)</m>. Write a sentence or two to describe this region.
        </p>
      </statement>
    </task>
  </activity>
</worksheet>

  </subsection>
  <subsection xml:id="subsec-cylindrical">
    <title>Cylindrical Coordinates</title>
    
    <p>
      So far in this chapter, we have encountered two different coordinate systems in <m>\R^2</m>: rectangular and polar coordinates. Earlier in this section, we saw how polar coordinates form a convenient alternative in certain situations. In a similar way, there are two more coordinate systems in <m>\R^3</m> that come from different ideas of rotational measurement. This subsection introduces cylindrical coordinates, which we can view as a vertical extension  of polar coordinates to three dimensions. The next subsection will introduce spherical coordinates, which are useful for situations with significant rotational symmetry with respect to the origin.
    </p>
    <p>
      <term>Cylindrical coordinates</term> are a coordinate system for <m>\mathbb{R}^3</m> that consists of using polar coordinates, <m>r</m> and <m>\theta</m>, in place of <m>x</m> and <m>y</m> coordinates. Cylindrical coordinates are given in the order of <m>(r,\theta,z)</m> and can be described as <q>polar plus <m>z</m></q>. The <m>z</m>-coordinate is measured the same way as in rectangular coordinates (signed distance above or below the <m>xy</m>-plane) and polar coordinates are measured as a projection of the point in three dimensions onto the <m>xy</m>-plane. To convert between rectangular and cylindrical coordinates, we use the same conversion equations as between rectangular and polar coordinates (in two dimensions).
    </p>

    <figure xml:id="cylcoorddefn">
      <caption>A plot of point <m>P</m> with <m>y</m>, <m>z</m>, and <m>r</m> labeled</caption>
      <interactive label="interactive-cylcoorddefn" platform="sage" width="91%" aspect="1:1">
        <description><p>A plot of point <m>P</m> with <m>y</m>, <m>z</m>, and <m>r</m> labeled</p>
      </description><slate surface="sage">
          from sage.plot.plot3d.plot3d import axes
          var('s,t')
          scale=3.25
          et=arctan(2)
          plot12=axes(scale,2,color="black",frame=False)+text3d("x",(scale+0.5,0,0),fontsize=30)+text3d("y",(0,scale+0.5,0),fontsize=30)+text3d("z",(0,0,scale+0.5),fontsize=30)
          plot12+=parametric_plot3d((s,t,0),(s,-1,3),(t,-1,3),opacity=0.15,color="gray",aspect_ratio=1,mesh=True,plot_points=5)
          plot12+=parametric_plot3d((0.5*cos(t),0.5*sin(t),0),(t,0,et),color="blue",thickness=3)
          plot12+=arrow((0.5*cos(et-0.1),0.5*sin(et-0.1),0),(0.5*cos(et),0.5*sin(et),0),color="blue",width=10)
          plot12+=parametric_plot3d((t,2*t,0),(t,0,1),color="red",thickness=3)
          plot12+=line([(1,2,0),(1,2,2.5)],color="green",thickness=3)
          plot12+=sphere((1,2,2.5),color="black",size=0.15)
          plot12+=text3d("P=(r,\u03B8,z)",(1,2,3),fontsize=30,color="black")
          plot12+=text3d("\u03B8",(1.5,0.5,0),color="blue",fontsize=30)
          plot12+=text3d("r",(0.5,1.5,0.75),color="red",fontsize=30)
          plot12+=text3d("z",(1.25,2.5,1.5),color="green",fontsize=30)
          show(plot12,viewpoint=[[-0.4306,-0.5735,-0.6969],124.76],camera_position=[12.851,4.9751,4.488])
        </slate>
      </interactive>
    </figure>
    <!-- <figure xml:id="Cylindrical_coords_def">
      <caption>The cylindrical coordinates of a point</caption>
        <image width="55%" source="images/fig_11_8_cylindrical"/>
    </figure> -->

    <assemblage xml:id="Cartesian-cylindrical">
      <title>Converting between rectangular and cylindrical coordinates</title>
      <p>
        <dl>
          <li>
            <title>From cylindrical to rectangular</title>
            <p>
              Given cylindrical coordinates <m>(r,\theta,z)</m> of a point <m>P</m>, the rectangular coordinates <m>(x,y,z)</m> of <m>P</m> satisfy
              <md>
                <mrow>x \amp= r \cos(\theta) \amp y \amp= r \sin(\theta) \amp  z \amp= z</mrow>
              </md>.
            </p>
          </li>

          <li>
            <title>From rectangular to cylindrical</title>
            <p>
              Given rectangular coordinates <m>(x,y,z)</m> of a point <m>P</m>, the cylindrical coordinates <m>(r,\theta,z)</m> of <m>P</m> satisfy
              <md>
                <mrow>r^2  \amp= x^2  + y^2 \amp  \tan(\theta) \amp= \frac{y}{x} \amp  z \amp= z</mrow>
              </md>
              assuming <m> x \neq 0</m>.
            </p>
          </li>
        </dl>
      </p>
    </assemblage>
    <example>
      <task>
        <statement>
          <p>
            For our first example, we will look at the point with cylindrical coordinates <m>(r,\theta,z)=\left(\sqrt{5},\frac{3\pi}{4},-2\right)</m>. This point is shown in <xref ref="cylex1"/> with the measurements of the cylindrical coordinates.
          </p>
          <figure xml:id="cylex1">
            <caption>A plot of <m>(r,\theta,z)=(\sqrt{5},\frac{3\pi}{4},-2)</m></caption>
              <interactive label="interactive-cylex1" platform="sage" width="91%" aspect="1:1">
                <description><p>A plot of <m>(r,\theta,z)=(\sqrt{5},\frac{3\pi}{4},-2)</m></p>
              </description><slate surface="sage">
                  from sage.plot.plot3d.plot3d import axes
                  var('s,t')
                  scale=3.5
                  plot15=axes(scale,2,color="black",frame=False)+text3d("x",(scale+0.5,0,0),fontsize=30)+text3d("y",(0,scale+0.5,0),fontsize=30)+text3d("z",(0,0,scale+0.5),fontsize=30)
                  plot15+=sphere((-sqrt(10)/2,sqrt(10)/2,-2),size=0.15,color="black")+line([(-sqrt(10)/2,sqrt(10)/2,-2),(-sqrt(10)/2,sqrt(10)/2,0)],color="green",thickness=3)
                  plot15+=text3d("-2",(-sqrt(10)/2+0.5,2,-1),color="green",fontsize=30)
                  plot15+=line([(-sqrt(10)/2,sqrt(10)/2,0),(0,0,0)],color="red",thickness=3)+text3d("r",(-sqrt(10)/3,sqrt(10)/3-0.6,0),color="red",fontsize=30,fontsytle='italic')
                  plot15+=parametric_plot3d((cos(t),sin(t),0),(t,0, 0.75*pi),color="blue",thickness=3)+text3d("\u03B8",(1,1,0),color="blue",fontsize=30)
                  plot15+=arrow3d((cos(0.75*pi-0.1),sin(0.75*pi-0.1),0),(-1/sqrt(2),1/sqrt(2),0),color="red",arrowsize=3)
                  plot15+=parametric_plot3d((s,t,0),(s,-3,3),(t,-3,3),opacity=0.1,color="gray",aspect_ratio=1,mesh=True,plot_points=5)
                  show(plot15,aspect_ratio=1,viewpoint=[[0.076,-0.5053,-0.8596],194.73],camera_position=[-2.8466,11.7913,6.6115])
                </slate>
              </interactive>
          </figure>
          <p>
            To convert our cylindrical coordinates to rectangular, we can use <m>x = r \cos(\theta)</m> and <m>y = r \sin(\theta)</m>. This gives rectangular coordinates of <m>(x,y,z)= \left(-\frac{\sqrt{10}}{2},\frac{\sqrt{10}}{2},-2\right)</m>.
          </p>
        </statement>
      </task>
      <task>
        <statement>
          <p>
            Next, we will find cylindrical coordinates for the point with rectangular coordinates <m>(x,y,z)=(-2,1,2)</m>. Just as the polar coordinates of a point in two dimensions are not unique, the cylindrical coordinates of a point in three dimensions will not be unique. 
          </p>
          <p>
            Using our conversion equations from rectangular to cylindrical, we get <m>r^2=(-2)^2+(1)^2=5</m> and <m>\tan(\theta)= \frac{1}{-2}</m>. Remember that we must interpret the angle <em>and</em> our choice of <m>r</m> to make sure our coordinates describe a point in the second octant. In particular, we will choose a positive <m>r</m> value of <m>\sqrt{5}</m> which means we will need to select <m>\theta = \arctan\left(-\frac{1}{2}\right)+\pi</m>. 
          </p>
          <p>  
            Alternatively, we can use <m>\cos(\theta)=\frac{x}{r}</m> since <m>\arccos</m> will give an output of an angle in the first or second quadrants. You can verify that <m>\theta = \arctan\left(-\frac{1}{2}\right)+\pi = \arccos\left(-\frac{2}{\sqrt{5}}\right)</m>. So rectangular coordinates <m>(x,y,z)=(-2,1,2)</m> will correspond to cylindrical coordinates of <m>(r,\theta,z)= \left(\sqrt{5},\arctan\left(-\frac{1}{2}\right)+\pi,2\right)</m> or <m>(r,\theta,z)= \left(\sqrt{5},\arccos\left(-\frac{2}{\sqrt{5}}\right),2\right) </m>.
          </p>
          <figure xml:id="cylex2">
            <caption>A plot of <m>(x,y,z)=(-2,1,2)</m></caption>
              <interactive label="interactive-cylex2" platform="sage" width="91%" aspect="1:1">
                <description><p>A plot of <m>(x,y,z)=(-2,1,2)</m></p>
              </description><slate surface="sage">
                  from sage.plot.plot3d.plot3d import axes
                  var('s,t')
                  scale=3.5
                  a=arccos(-2/sqrt(5))
                  plot16=axes(scale,2,color="black",frame=False)+text3d("x",(scale+0.5,0,0),fontsize=30)+text3d("y",(0,scale+0.5,0),fontsize=30)+text3d("z",(0,0,scale+0.5),fontsize=30)
                  plot16+=parametric_plot3d((s,t,0),(s,-3,3),(t,-3,3),opacity=0.1,color="gray",aspect_ratio=1)
                  for i in range(-3,4):
                    plot16+=line([(3,i,0),(-3,i,0)],color="gray")+line([(i,3,0),(i,-3,0)],color="gray")
                  plot16+=sphere((-2,1,2),size=0.15,color="black")+line([(-2,1,2),(-2,1,0)],color="green",thickness=3)+text3d("2",(-2.25,1,1.35),color="green",fontsize=30)
                  plot16+=line([(-2,1,0),(-2,0,0)],color="purple",thickness=3)+text3d("1",(-2.5,0.5,0.25),color="purple",fontsize=30)
                  plot16+=line([(0,0,0),(-2,0,0)],color="magenta",thickness=3)+text3d("-2",(-1,-0.25,0.25),color="magenta",fontsize=30)
                  plot16+=line([(0,0,0),(-2,1,0)],color="red",thickness=3)+text3d("r",(-1.0,1.75,0.25),color="red",fontsize=30)
                  plot16+=parametric_plot3d((cos(t),sin(t),0),(t,0,a),color="blue",thickness=3)+text3d("\u03B8",(1.5,1.5,0.25),color="blue",fontsize=25)
                  plot16+=arrow3d((cos(a-.1),sin(a-0.1),0),(cos(a),sin(a),0),color="blue",arrowsize=3)
                  show(plot16,aspect_ratio=1,viewpoint=[[-0.1086,-0.5695,-0.8148],162.33],camera_position=[3.752,13.1687,6.9602])
                </slate>
              </interactive>
          </figure>
        </statement>
      </task>
      <task>
        <statement>
          <p>
            When introducing polar coordinates, we saw how the graph of <m>\theta=2</m> is a line with slope <m>\tan(2)</m>. If we consider only positive <m>r</m> coordinates then we get a ray with an angle of <m>2</m> radians from the positive <m>x</m>-axis. If we wanted to consider the graph in three dimensions of <m>\theta=2</m> using <em>cylindrical coordinates</em>, then we have a plane containing the <m>z</m>-axis and extending in the <m>\theta=2</m> direction. This is a cylinder surface with the line given by <m>y=tan(2) x</m> as the generating curve and rulings parallel to the <m>x</m>-axis.  
          </p>
          <figure xml:id="cylex3">
            <caption>A plot of <m>\theta=2</m> with positive <m>r</m> values in blue and negative <m>r</m> values in green</caption>
              <interactive label="interactive-cylex3" platform="sage" width="91%" aspect="1:1">
                <description><p>A plot of <m>\theta=2</m> with positive <m>r</m> values in blue and negative <m>r</m> values in green</p>
              </description><slate surface="sage">
                  from sage.plot.plot3d.plot3d import axes
                  var('s,t')
                  scale=3; d=2.5
                  a=pi+2
                  plot17=axes(scale,2,color="black",frame=False)+text3d("x",(scale+0.5,0,0),fontsize=30)+text3d("y",(0,scale+0.5,0),fontsize=30)+text3d("z",(0,0,scale+0.5),fontsize=30)
                  plot17+=parametric_plot3d((s,tan(2)*s,t),(t,-d,d),(s,-1.25,0),color="blue",opacity=.15)
                  plot17+=parametric_plot3d((s,tan(2)*s,t),(t,-d,d),(s,0,1.25),color="green",opacity=.15)
                  for i in range(-2,3):
                    plot17+=line([(i*d/4,tan(2)*i*d/4,d),(i*d/4,tan(2)*i*d/4,-d)],color="gray",thickness=1)
                    plot17+=line([(d/2,tan(2)*d/2,d*i/2),(-d/2,-tan(2)*d/2,d*i/2)],color="gray",thickness=1)
                  plot17+=parametric_plot3d((cos(t),sin(t),0),(t,0,2),color="red",thickness=3)+arrow((cos(2-0.3),sin(2-0.3),0),(cos(2),sin(2),0),color="red",arrowsize=8)
                  plot17+=arrow3d((0.5*cos(a-0.3),0.5*sin(a-0.3),0),(0.5*cos(a),0.5*sin(a),0),color="magenta",arrowsize=8)
                  plot17+=text3d("\u03B8=2",(1,2,0),color="red",fontsize=30)
                  plot17+=text3d("\u03B8=2+\u03C0",(-2,-1,0),color="magenta",fontsize=30)
                  plot17+=parametric_plot3d((0.5*cos(t),0.5*sin(t),0),(t,0,pi+2),color="magenta",thickness=3)
                  plot17+=text3d("\u03B8 with r\u003C0",(4*cos(pi+2),4*sin(pi+2),3),color="green",fontsize=25)
                  plot17+=text3d("\u03B8 with r\u003E0",(4*cos(2),4*sin(2),3),color="blue",fontsize=25)
                  show(plot17,aspect_ratio=1,viewpoint=[[-0.5738,-0.49,-0.6562],104.92],camera_position=[14.2567,-2.1413,4.5515])
                </slate>
              </interactive>
          </figure>
        </statement>
      </task>
      <task>
        <statement>
          <p>
            In this example we will convert the elliptic paraboloid given by <m>z=x^2+y^2</m> to cylindrical coordinates. Algebraically, this is requires little work because we can substitute <m>r^2=x^2+y^2</m> to obtain <m>z=r^2</m>. This should make sense for the graph of the elliptic paraboloid because the graph is rotationally symmetric around the <m>z</m>-axis because there is no explicit dependence on <m>\theta</m> in the equation and the height of the surface above the <m>xy</m>-plane increases quadratically as the location moves away from the <m>z</m>-axis.
          </p>
          <figure xml:id="cylex4">
            <caption>A plot of <m>z=r^2</m> with segments for <m>r</m> in red and <m>z=r^2</m> in green</caption>
              <interactive label="interactive-cylex4" platform="sage" width="100%" aspect="1:1.1">
                <description><p>A plot of <m>z=r^2</m> with segments for <m>r</m> in red and <m>z=r^2</m> in green</p>
              </description><slate surface="sage">
                  from sage.plot.plot3d.plot3d import axes
                  var('s,t')
                  scale=2
                  @interact
                  def zr2(b=slider(0,1.5,0.1,default=1.25,label="$r$:"),a=slider(0,6,0.1,default=2.5,label="$\\theta$:")):
                      plot18=axes(scale,2,color="black",frame=False)+text3d("x",(scale+0.5,0,0),fontsize=30)+text3d("y",(0,scale+0.5,0),fontsize=30)+text3d("z",(0,0,scale+0.5),fontsize=30)
                      #plot18+=parametric_plot3d((s*cos(t),s*sin(t),s^2),(s,0,1.5),(t,0,2*pi),color="lightblue",opacity=.25)
                      param(s,t)=(s*cos(t),s*sin(t),s^2)
                      #set up grid      n is number of steps in s    m is number of steps in t  
                      #a1 is min s    a2 is max s   b1 is min t    b2 is max t
                      n=9;m=9;a1=0;a2=1.5;b1=0;b2=2*pi; 
                      #c1 is surface color     o1 is surface opacity
                      #c2 and o2 are for constant t value traces
                      #c3 and o3 are for constant s value traces
                      c1="lightblue"; c2="gray"; c3="gray"; o1=0.5; o2=0.6; o3=0.6;
                      plot18+=parametric_plot3d(param,(s,a1,a2),(t,b1,b2),color=c1,opacity=o1)
                      for i in range(n+1):
                        sv=a1+i/n*(a2-a1)
                        plot18+=parametric_plot3d(param(sv,t),(t,b1,b2),color=c2,opacity=o2)
                      for i in range(m+1):
                        tv=b1+i/m*(b2-b1)
                        plot18+=parametric_plot3d(param(s,tv),(s,a1,a2),color=c3,opacity=o3)
                      plot18+=line([(0,0,0),(b*cos(a),b*sin(a),0)],color="red",thickness=3)+text3d("r",(b*cos(a)/1.6,b*sin(a)/1.6,-0.25),color="red",fontsize=25)
                      plot18+=line([(b*cos(a),b*sin(a),0),(b*cos(a),b*sin(a),b^2)],color="green",thickness=3)+text3d("z=r\u00B2",((b+0.75)*cos(a),(b+0.75)*sin(a),b^2/2),color="green",fontsize=25)
                      show(plot18,aspect_ratio=1,viewpoint=[[-0.0213,-0.6767,-0.7359],177.35],camera_position=[0.9859,8.7231,1.8168])
                </slate>
              </interactive>
          </figure>
        </statement>
      </task>
    </example>
    <p>
      The activities that close this subsection are meant to give you not only some algebraic experience with the cylindrical coordinate measurements but also some examples where you can make sense of your results from a geometric perspective. 
    </p>
    <worksheet>
  <activity workspace="1.5in">
      <task>
        <statement>
          <p>
            Convert <m>(x,y,z)=(1,2,3)</m> to cylindrical coordinates.
          </p>
        </statement>
      </task> 
      <task>
        <statement>
          <p>
            Use inequalities on cylindrical coordinates to describe the region given by the 6th octant.
          </p>
        </statement>
      </task> 
      <task>
        <statement>
          <p>
            Convert the cone <m>z^2=x^2+y^2</m> to cylindrical coordinates. Write a couple of sentences to make sense of how you can simplify your conversion and describe the shape of the graph in terms of <m>z</m> and <m>r</m>.
          </p>
        </statement>
      </task>
      <task>
        <statement>
          <p>
            Draw a plot of the surface in <m>\R^3</m> with equation <m>r=2</m> in cylindrical coordinates. Write a couple of sentences about the shape and properties of this surface.
          </p>
        </statement>
      </task>
      <task>
        <statement>
          <p>
            Draw a plot of the region given by <m>0 \leq \theta \leq \pi,  0 \leq r \leq 2,  0 \leq z \leq r^2 </m>. Write a couple of sentences about the shape and properties of this region.
          </p>
        </statement>
      </task>
    </activity>
</worksheet>

    <worksheet>
  <activity workspace="1.5in" xml:id="CylCoorSurfaces">
      <introduction>
        <p>
          In this activity, we graph some surfaces using cylindrical coordinates. To improve your intuition and test your understanding, you should first think about what each graph should look like before you plot it using appropriate technology.
        </p>
      </introduction>
      <task>
        <statement>
          <p>
            What familiar surface is described by the points in cylindrical coordinates with <m>r=2</m>, <m>0 \leq \theta \leq 2\pi</m>, and <m>0 \leq z \leq 2</m>?  How does this example suggest that we call these coordinates <em>cylindrical coordinates</em>? How does the surface change if we restrict <m>\theta</m> to <m> 0 \leq \theta \leq \pi</m>? 
          </p>
        </statement>
        <solution>
          <p>
            In polar coordinates, the graph of <m>r=2</m> is a circle centered at the origin with radius 2. Extending this to cylindrical coordinates, we obtain a cylinder centered at the origin of radius 2, with base on the <m>xy</m>-plane and height 2.
          </p>
        </solution>
      </task>
      <task>
        <statement>
          <p>
            What familiar surface is described by the points in cylindrical coordinates with <m>\theta=2</m>, <m>0 \leq r \leq 2</m>, and <m>0 \leq z \leq 2</m>?
          </p>
        </statement>
        <solution>
          <p>
            In polar coordinates, the graph of <m>\theta = 2</m> is a line through the origin making an angle of 2 radians with the positive <m>x</m>-axis. Extending this to cylindrical coordinates,the graph of <m>\theta=2</m> is a plane through the origin perpendicular to the <m>xy</m>-plane making an angle of 2 radians with the <m>xz</m>-plane.
          </p>
        </solution>
      </task>
      <task>
        <statement>
          <p>
            What familiar surface is described by the points in cylindrical coordinates with <m>z=2</m>, <m>0 \leq \theta \leq 2\pi</m>, and <m>0 \leq r \leq 2</m>?
          </p>
        </statement>
        <solution>
          <p>
            The graph of <m>z=2</m> is just a plane parallel to the <m>xy</m>-plane at a distance 2 above the <m>xy</m>-plane. With <m>0 \leq \theta \leq 2\pi</m> and <m>0 \leq r \leq 2</m>, the graph of <m>z=2</m> is just a disk of radius 2 centered at <m>(0,0,2)</m> within the plane <m>z=2</m>.
          </p>
        </solution>
      </task>
      <task>
        <statement>
          <p>
            Plot the graph of the cylindrical equation <m>z=r</m>, where <m>0 \leq \theta \leq 2\pi</m> and <m>0 \leq r \leq 2</m>. What familiar surface results?
          </p>
        </statement>
        <solution>
          <p>
            For a fixed value of <m>r</m>, the graph of <m>z=r</m> and <m>0 \leq \theta \leq 2\pi</m> is a circle of radius <m>r</m> in the plane <m>z=r</m>. As <m>r</m> increases the radii increase, so we will obtain a cone with base at the origin, opening up with height <m>2</m>.
          </p>
        </solution>
      </task>
      <task>
        <statement>
          <p>
            Plot the graph of the cylindrical equation <m>z= \theta</m> for <m>0 \leq \theta \leq 4 \pi</m>. What does this surface look like?
          </p>
        </statement>
        <solution>
          <p>
            For a fixed <m>\theta</m>, the graph of <m>z=\theta</m> is a line in the <m>z = \theta</m> plane making an angle of <m>\theta</m> with the <m>xz</m>-plane. Allowing <m>\theta</m> to vary will produce a set of lines, spiraling upward so that the result looks like a bit of an auger.
          </p>
        </solution>
      </task>
    </activity>
</worksheet>
    </subsection>
    <subsection xml:id="subsec-SphCoord">
      <title>Spherical Coordinates</title>
      <p>
        Cylindrical coordinates used an angular measurement in the <m>xy</m>-plane as part of the description of location. Spherical coordinates uses one linear measurement and two angular measurements to specify the location of a point. The three measurements used to define the spherical coordinates of a point in <m>\R^3</m> are <m>\rho</m> (rho), <m>\theta</m>, and <m>\phi</m> (phi), where 
        <ul>
          <li><m>\rho</m> is the distance from the point to the origin,</li>
          <li><m>\theta</m> has the same interpretation it does in polar coordinates, and</li>
          <li><m>\phi</m> is the (smallest) angle between the positive <m>z</m>-axis and the vector from the origin to the point.</li>
        </ul> 
        We illustrate this in <xref ref="sphdef">Figure</xref>, where the measures <m>r</m> and <m>z</m> from cylindrical coordinates are also depicted. You should convince yourself that any point in <m>\R^3</m> can be represented in spherical coordinates with <m>\rho \geq 0</m>, <m>0 \leq \theta \lt 2 \pi</m>, and <m>0 \leq \phi \leq \pi</m>.
      </p>
      <figure xml:id="sphdef">
        <caption>A plot of a point <m>P</m> with spherical coordinate measurement</caption>
          <interactive label="interactive-sphdef" platform="sage" width="91%" aspect="1:1">
            <description><p>A plot of a point <m>P</m> with spherical coordinate measurement</p>
          </description><slate surface="sage">
              from sage.plot.plot3d.plot3d import axes
              var('s,t')
              scale=3
              a=arccos(3/sqrt(14))
              plot19=axes(scale,2,color="black",frame=False)+text3d("x",(scale+0.5,0,0),fontsize=30)+text3d("y",(0,scale+0.5,0),fontsize=30)+text3d("z",(0,0,scale+0.5),fontsize=30)
              plot19+=line([(0,0,0),(1,2,3)],color="red",thickness=3)+text3d("\u03c1",(0.6,1.2,1.5),color="red",fontsize=30)
              plot19+=line([(0,0,0),(1,2,0)],color="magenta",thickness=3)
              plot19+=line([(1,2,3),(1,2,0)],color="gray",linestyle="--")
              plot19+=text3d("z",(1.25,2.5,1.5),color="grey",fontsize=25)
              plot19+=parametric_plot3d((cos(t),sin(t),0),(t,0,arctan(2)),color="blue",thickness=3)+arrow3d((cos(a-.3),sin(a-.3),0),(cos(a),sin(a),0),color="blue",arrowsize=8)
              plot19+=text3d("\u03b8",(1.5,0.75,0),color="blue",fontsize=25)
              plot19+=text3d("r",(1.25,2.5,0),color="magenta",fontsize=25)
              plot19+=parametric_plot3d((sin(t),2*sin(t),sqrt(5)*cos(t)),(t,0,a),color="green",thickness=2)+arrow3d((sin(a-.1),2*sin(a-.1),sqrt(5)*cos(a-.1)),(sin(a),2*sin(a),sqrt(5)*cos(a)),color="green",arrowsize=5)
              plot19+=text3d("\u03c6",(0.5,1,2.5),color="green",fontsize=25)
              plot19+=sphere((1,2,3),size=0.1,color="black")+text3d("P=(\u03c1,\u03b8,\u03c6)",(1.2,2.2,3.5),fontsize=25,color="black")
              show(plot19,aspect_ratio=1,viewpoint=[[-0.3784,-0.4878,-0.7867],117.21],camera_position=[8.8047,3.5745,5.4277])
            </slate>
          </interactive>
      </figure>
      <assemblage xml:id="Spherical-rect">
        <title>Coverting between rectangular and spherical coordinates</title>
        <p>
          <dl>
            <li>
              <title>From rectangular to spherical</title>
              <p>
                Given rectangular coordinates <m>(x,y,z)</m> of a point <m>P</m>, the spherical coordinates <m>(\rho,\theta,\phi)</m> of <m>P</m> satisfy
                <md>
                  <mrow>\rho  \amp = \sqrt{x^2  + y^2 + z^2}  </mrow>
                  <mrow>  \tan(\theta) \amp = \frac{y}{x}</mrow>
                  <mrow>  \cos(\phi) \amp = \frac{z}{\rho}</mrow>
                </md>
                where in the second and third equations, we require <m>x \ne 0</m> and <m>\rho \ne 0</m>.
              </p>
            </li>
    
            <li>
              <title>From spherical to rectangular</title>
              <p>
                Given spherical coordinates <m>(\rho,\theta,\phi)</m> of a point <m>P</m>, the rectangular coordinates <m>(x,y,z)</m> of <m>P</m> satisfy
                <md>
                  <mrow>x \amp = \rho \sin(\phi) \cos(\theta) </mrow>
                  <mrow>  y \amp = \rho \sin(\phi) \sin(\theta) </mrow>
                  <mrow>z \amp = \rho \cos(\phi)</mrow>
                </md>.
              </p>
            </li>
          </dl>
        </p>
      </assemblage>
    <example xml:id="sph-coord-ex1">
      <p>
        In this example, we investigate how to think about the spherical coordinates of a point and how to convert between spherical coordinates and rectangular coordinates. Consider the point <m>P</m> whose rectangular coordinates are <m>(-2,2,\sqrt{8})</m>, which we illustrate in <xref ref="sphex1"/>
      </p>

      <figure xml:id="sphex1">
        <caption>A plot of a point <m>P=(-2,2,\sqrt{8})</m> with spherical coordinate measurements</caption>
          <interactive label="interactive-sphex1" platform="sage" width="91%" aspect="1:1">
            <description><p>A plot of a point <m>P=(-2,2,\sqrt{8})</m> with spherical coordinate measurements</p>
          </description><slate surface="sage">
              from sage.plot.plot3d.plot3d import axes
              var('s,t')
              scale=3
              tval=3*pi/4
              xval=-2
              yval=2
              zval=sqrt(8)
              r=sqrt(xval^2+yval^2)
              rho=sqrt(xval^2+yval^2+zval^2)
              a=arccos(zval/rho)
              plot20=axes(scale,2,color="black",frame=False)+text3d("x",(scale+0.5,0,0),fontsize=30)+text3d("y",(0,scale+0.5,0),fontsize=30)+text3d("z",(0,0,scale+0.5),fontsize=30)
              plot20+=line([(0,0,0),(xval,yval,zval)],color="red",thickness=3)+text3d("\u03c1",(xval/1.6,yval/1.6,zval/1.6+0.5),color="red",fontsize=30)
              plot20+=line([(0,0,0),(xval,yval,0)],color="magenta",thickness=2)+text3d("r",(xval/1.6,yval/1.6,-0.5),color="magenta",fontsize=30)
              plot20+=line([(xval,yval,zval),(xval,yval,0)],color="gray",linestyle="--")+text3d("z",(xval/0.8,yval/0.8,zval/2),color="gray",fontsize=30)
              plot20+=parametric_plot3d((cos(t),sin(t),0),(t,0,tval),color="blue",thickness=3)+arrow3d((cos(tval-0.2),sin(tval-0.2),0),(cos(tval),sin(tval),0),color="blue")
              plot20+=text3d("\u03B8",(1,2,0),color="blue",fontsize=25)
              plot20+=parametric_plot3d((xval/rho*sin(t),yval/rho*sin(t),r/rho*cos(t)),(t,0,a),color="green",thickness=3)
              plot20+=arrow3d((sin(a-.01),2*sin(a-.01),sqrt(5)*cos(a-.01)),(sin(a),2*sin(a),sqrt(5)*cos(a)),color="green")
              plot20+=text3d("\u03c6",(xval/4,yval/4,zval/2),color="green",fontsize=30)
              plot20+=sphere((xval,yval,zval),size=0.1,color="black")+text3d("P",(xval,yval,zval+0.5),fontsize=25,color="black")
              show(plot20,aspect_ratio=1,viewpoint=[[-0.1362,-0.5482,-0.8252],156.83],camera_position=[5.0477,10.2784,5.5862])
            </slate>
          </interactive>
      </figure>
      <p> 
         What is the distance from <m>P</m> to the origin? The result is the value of <m>\rho</m> in the spherical coordinates of <m>P</m>, so 
          <me>
            \rho = \sqrt{2^2+2^2+(\sqrt{8})^2} = 4
          </me>
      </p>
      <p>        
        In order to find the <m>\theta</m>-coordinate of <m>P</m>, we will need to determine the point that is the projection of <m>P</m> onto the <m>xy</m>-plane. We can use this projection to find the value of <m>\theta</m> in the polar coordinates of the projection of <m>P</m> that lies in the plane. The projection of <m>P</m> onto the <m>xy</m>-plane is the point <m>(-2,2,0)</m>. As we saw earlier with polar and cylindrical coordinates, we can use <m>\tan(\theta) = \frac{y}{x}</m> to find <m>\theta</m>. For the point <m>P</m>, <m>\tan(\theta) = \frac{-2}{2}=-1</m>. Remember that you must interpret the result of inverse trigonometric functions according to the particular geometric situation given in the problem. In particular, <m>\arctan(-1)=-\frac{\pi}{4}</m> but we want will need to interpret <m>\theta</m> as a an angle in the second quadrant. We use <m>\theta=\frac{3\pi}{4}=\pi + \arctan(-1)</m>.
      </p>
      <p>
        Based on the illustration in <xref ref="sphex1">Figure</xref>, we can use the right triangle with sides that correspond to the measurement of <m>z</m>, <m>r</m>, and <m>\rho</m> to find the angle <m>\phi</m>. It may not be immediately clear where the angle <m>\phi</m> is in this triangle, but <xref ref="sphex11"/> shows how the alternate interior angles of the parallel lines associated with <m>z</m> will be equal. In other words, the upper right angle in our right triangle will be the same size as <m>\phi</m>. 
       </p>
       <figure xml:id="sphex11">
        <caption>A 2D plot of a point <m>P</m> with spherical coordinate measurements in the plane of the measurement of <m>\theta</m></caption>
        <image width="75%" xml:id="img-sphex11">
          <description><p>A 2D plot of a point <m>P</m> with spherical coordinate measurements in the plane of the measurement of <m>\theta</m></p>
        </description><sageplot>
            var('t')
            rho=sqrt(1.2^2+1)
            a=arctan(1.2)
            plot21=line([(0,0),(1.2,0)],color="magenta",thickness=3,zorder=3,axes=True,axes_labels=["","$z$-axis"],ticks=[[],[]])
            plot21+=text("$r$",(0.75,-.15),color="magenta",fontsize=20)
            plot21+=line([(0,0),(1.2,1)],color="red",thickness=3)+line([(1.2,1),(1.2,0)],color="gray",thickness=2)
            plot21+=text("$\\rho$",(0.7,0.8),color="red",fontsize=20)
            plot21+=text("$z$",(1.35,0.5),color="gray",fontsize=20)
            plot21+=parametric_plot((0.5*sin(t),0.5*cos(t)),(t,0,a),color="green")+arrow((0.5*sin(a-0.1),.5*cos(a-0.1)),(0.5*sin(a),0.5*cos(a)),color="green")
            plot21+=text("$\\phi$",(0.2,0.6),color="green",fontsize=20)+text("$\\theta$-direction",(1.5,-0.15),color="black",fontsize=15)
            plot21+=parametric_plot((1.2-0.5*sin(t),1-0.5*cos(t)),(t,0,a),color="green",thickness=2)+arrow((1.2-0.5*sin(a-0.1),1-0.5*cos(a-0.1)),(1.2-0.5*sin(a),1-0.5*cos(a)),color="green")
            plot21+=text("$\\phi$",(0.95,0.35),color="green",fontsize=20)+point((1.2,1),size=40,color="black",zorder=4)
            plot21+=text("$P$",(1.3,1.1),color="black",xmin=-0.5,xmax=1.5,ymin=-0.5,ymax=1.5,aspect_ratio=1,fontsize=20)
            plot21+=line([(1.1,0),(1.1,0.1),(1.2,0.1)],color="black")
            plot21
          </sageplot>
        </image>
      </figure>
      
      <p>
        We can calculate the <m>\phi</m>-coordinate of <m>P</m> using the property that <m>\cos(\phi) = \frac{z}{\rho}=\frac{\sqrt{8}}{4}=\frac{\sqrt{2}}{2}</m>, which means that <m>\phi=\frac{\pi}{4}</m>.
      </p>
      <p>
        The point <m>P</m> with rectangular coordinates <m>(-2,2,\sqrt{8})</m> will be given in spherical coordinates as <m>(\rho,\theta,\phi)=\left(4,\frac{3\pi}{4},\frac{\pi}{4}\right)</m>.

      </p>
    </example>
    <p>
      Our first spherical coordinates activity focuses on understanding how spherical coordinates can be converted to rectangular coordinates and visualizing what the spherical coordinates measure.
    </p>
    <worksheet>
  <activity workspace="1.5in" xml:id="Act-sph-rect-points">
      <task xml:id="Act-sph-rect-points1">
        <introduction>
          <p>
            Use the <xref ref="Spherical-rect" text="custom">conversion equations between rectangular and spherical coordinates</xref> to find the rectangular coordinates of the following points:
          </p>
        </introduction>
        <task>
          <statement>
            <p>
              <m> (\rho, \theta, \phi)= (3, \frac{\pi}{3}, \frac{\pi}{2})</m>
            </p>
          </statement>
        </task>
        <task>
          <statement>
            <p>
              <m> (\rho, \theta, \phi)= (4, \frac{4\pi}{3}, \frac{3\pi}{4})</m>
            </p>
          </statement>
        </task>
        <task>
          <statement>
            <p>
              <m> (\rho, \theta, \phi)= (\sqrt{7}, 20^\circ, \pi)</m>
            </p>
          </statement>
        </task>
      </task>
      <task>
        <statement>
          <p>
            Draw each of the points from <xref ref="Act-sph-rect-points1" text="local">part</xref> and show how the spherical coordinates of each point is being measured. You should use your plots to make sense of the rectangular coordinate measurements that were your answer to <xref ref="Act-sph-rect-points1" text="local">part</xref>.
          </p>
        </statement>
      </task>
    </activity>
</worksheet>
    <p>
      Now that we have worked through how to think about <em>points</em> in spherical coordinates, we will do as we did with the other coordinate systems in this section and think about equations and surfaces.
    </p>
    <example>
      <task>
        <p>
          First, we will consider the surface defined by <m>\rho = 2</m>. Geometrically, we can think about <m>\rho =2</m> as the set of points that are two units away from the origin, which creates a sphere of radius 2. Algebraically, we can square both sides of our equation to get <m> \rho^2=4</m> and since <m>\rho^2=x^2+y^2+z^2</m>, the spherical coordinate equation <m>\rho =2</m> corresponds to the rectangular equation <m>x^2+y^2+z^2=4</m>. In fact, for all positive values of <m>k</m>, the surface <m>\rho =k</m> will be a sphere of radius <m>k</m>. 
        </p>
      </task>
      <task>
        <p>
          Next, we consider how to convert the equation of the half cone given by <m>z^2=2x^2+2y^2</m> where <m>z \geq 0 </m> to spherical coordinates. Algebraically, we can use a couple of ideas from our conversion equations that include <m>z=\rho \cos(\phi)</m> and <m> r^2= \rho^2 \sin(\phi)^2</m>. Specifically, this means that
          <md>
            <mrow>z^2 =\amp 2x^2+2y^2</mrow>
            <mrow>z^2 =\amp 2\left(x^2+y^2\right)</mrow>
            <mrow>\rho^2 \cos(\phi)^2=\amp 2\left(\rho^2 \sin(\phi)^2\right)</mrow>
            <mrow>\tan(\phi)^2=\amp 2</mrow>
          </md>
          Since we are considering the part of the cone with <m>z \geq 0 </m>, we can use <m>\phi = \arctan(\sqrt{2})</m>. This should not be that suprising that half cones centered on the <m>z</m>-axis coorespond to a constant value of <m>\phi</m>. 
        </p>
        <figure xml:id="sphex12">
          <caption>A plot of the half cone <m>z^2=2x^2+2y^2</m> with <m>z\geq 0</m> shown in orange with measurement of <m>\phi</m></caption>
          <interactive label="interactive-sphex12" platform="sage" width="91%" aspect="1:1">
            <description><p>A plot of the half cone <m>z^2=2x^2+2y^2</m> with <m>z\geq 0</m> shown in orange with measurement of <m>\phi</m></p>
          </description><slate surface="sage">
              from sage.plot.plot3d.plot3d import axes
              var('s,t')
              scale=2
              a=arctan(sqrt(2))
              plot22=axes(scale,2,color="black",frame=False)+text3d("x",(scale+0.5,0,0),fontsize=30)+text3d("y",(0,scale+0.5,0),fontsize=30)+text3d("z",(0,0,scale+0.5),fontsize=30)
              #plot22+=parametric_plot3d((s*cos(t),s*sin(t),s/sqrt(2)),(s,0,1.75),(t,0,2*pi),color="red",opacity=0.45,mesh=True,plot_points=20)
              param(s,t)=(s*cos(t),s*sin(t),s/sqrt(2))
              #set up grid      n is number of steps in s    m is number of steps in t  
              #a1 is min s    a2 is max s   b1 is min t    b2 is max t
              n=9;m=9;a1=0;a2=2.5;b1=0;b2=2*pi; 
              #c1 is surface color     o1 is surface opacity
              #c2 and o2 are for constant t value traces
              #c3 and o3 are for constant s value traces
              c1="lightblue"; c2="gray"; c3="gray"; o1=0.5; o2=0.6; o3=0.6;
              plot22+=parametric_plot3d(param,(s,a1,a2),(t,b1,b2),color=c1,opacity=o1)
              for i in range(n+1):
                sv=a1+i/n*(a2-a1)
                plot22+=parametric_plot3d(param(sv,t),(t,b1,b2),color=c2,opacity=o2)
              for i in range(m+1):
                tv=b1+i/m*(b2-b1)
                plot22+=parametric_plot3d(param(s,tv),(s,a1,a2),color=c3,opacity=o3)
              plot22+=parametric_plot3d((0,1.5*sin(t),1.5*cos(t)),(t,0,a),color="green",thickness=2)
              plot22+=text3d("\u03C6\u224854.73\u00B0",(0,1,1.75),color="green",fontsize=25)
              plot22+=arrow3d((0,1.5*sin(a)-0.2,1.5*cos(a)+0.2),(0,1.5*sin(a),1.5*cos(a)),color="green",width=10)
              show(plot22,viewpoint=[[-0.5565,-0.5478,-0.6246],115.2],camera_position=[9.134,0.1137,2.3726])
            </slate>
            </interactive>
        </figure>
        <p>
          If we considered the bottom half of the cone given by <m>z^2=2x^2+2y^2</m> where <m>z \leq 0 </m>, we would need to find the angle <m>\phi</m> between <m>\frac{\pi}{2}</m> and <m>\pi</m> that satisfies <m>\tan(\phi)=\sqrt{2}</m>. Using complementary angles we see that the bottom half of the cone given by <m>z^2=2x^2+2y^2</m> where <m>z \leq 0 </m> corresponds to the spherical equation <m>\phi = \pi - \arctan(\sqrt{2})</m>. 
        </p>
        <figure xml:id="sphex13">
          <caption>A plot of the botom half of the cone <m>z^2=2x^2+2y^2</m> with <m>z\leq 0</m> shown in orange with measurement of <m>\phi</m> </caption>
          <interactive label="interactive-sphex13" platform="sage" width="91%" aspect="1:1">
            <description><p>A plot of the botom half of the cone <m>z^2=2x^2+2y^2</m> with <m>z\leq 0</m> shown in orange with measurement of <m>\phi</m> </p>
          </description><slate surface="sage">
              from sage.plot.plot3d.plot3d import axes
              var('s,t')
              scale=2
              a=pi-arctan(sqrt(2))
              plot23=axes(scale,1.5,color="black",frame=False)+text3d("x",(scale+0.5,0,0),fontsize=30)+text3d("y",(0,scale+0.5,0),fontsize=30)+text3d("z",(0,0,scale+0.5),fontsize=30)
              #plot23+=parametric_plot3d((s*cos(t),s*sin(t),-s/sqrt(2)),(s,0,2),(t,0,2*pi),color="red",opacity=0.65,mesh=True,plot_points=20)
              param(s,t)=(s*cos(t),s*sin(t),-s/sqrt(2))
              #set up grid      n is number of steps in s    m is number of steps in t  
              #a1 is min s    a2 is max s   b1 is min t    b2 is max t
              n=9;m=9;a1=0;a2=2.5;b1=0;b2=2*pi; 
              #c1 is surface color     o1 is surface opacity
              #c2 and o2 are for constant t value traces
              #c3 and o3 are for constant s value traces
              c1="lightblue"; c2="gray"; c3="gray"; o1=0.5; o2=0.6; o3=0.6;
              plot23+=parametric_plot3d(param,(s,a1,a2),(t,b1,b2),color=c1,opacity=o1)
              for i in range(n+1):
                sv=a1+i/n*(a2-a1)
                plot23+=parametric_plot3d(param(sv,t),(t,b1,b2),color=c2,opacity=o2)
              for i in range(m+1):
                tv=b1+i/m*(b2-b1)
                plot23+=parametric_plot3d(param(s,tv),(s,a1,a2),color=c3,opacity=o3)
              plot23+=parametric_plot3d((0,sin(t),cos(t)),(t,0,a),color="green")
              plot23+=arrow3d((0,sin(a)+0.1,cos(a)+0.2),(0,sin(a),cos(a)),color="green",width=2)
              plot23+=text3d("\u03C6\u2248125.27\u00B0",(0,2,0.5),color="green",fontsize=25)
              plot23+=line([(0,0,0),(0,0,-2)],color="black")
              show(plot23,viewpoint=[[-0.3876,-0.5801,-0.7164],128.84],camera_position=[9.8949,4.0994,2.5267])
            </slate>
          </interactive>
        </figure>
      </task>
      <task>
        <p> 
          Finally, we consider how to convert the plane given by <m>z=x+y</m> to spherical coordinates. We can use <m>x = \rho \sin(\phi) \cos(\theta)</m>, <m> y = \rho \sin(\phi) \sin(\theta)</m>, and <m> z = \rho \cos(\phi)</m> to make the following algebraic simplifications:
          <md>
            <mrow>z =\amp x + y </mrow>
            <mrow>\rho \cos(\phi) =\amp \rho \cos(\theta) \sin(\phi)+ \rho \sin(\theta) \sin(\phi) </mrow>
            <mrow>\cos(\phi) =\amp \sin(\phi) \left( \cos(\theta) + \sin(\theta) \right) </mrow>
            <mrow> \tan(\phi) =\amp  \cos(\theta) + \sin(\theta) </mrow>
          </md>
        </p>
        <p>
          If the graph of <m>\tan(\phi) =  \cos(\theta) + \sin(\theta)</m> seems unfamiliar, that is normal. This is likely not an expression you have seen before and does not simplify or offer geometric insight. This example shows how easily converting equations between coordinate systems without some geometric reasoning for making the conversion can quickly turn into an exercise of algebra without much meaning. 
        </p>
      </task>
    </example>
    <p>
      The next two activities help you develop your understanding of the angle <m>\phi</m> in spherical coordinates and then ask you to think about some surfaces and how you can express them using spherical coordinates.
    </p>
    <worksheet>
  <activity workspace="1.5in">
      <introduction>
        <p>
          For many students, the measurement of <m>\phi</m> is the most difficult and most unfamiliar measurement for spherical coordinates. In order to help understand the measurement of the <m>\phi</m>-coordinate, we will look at the collection of points described by a constant value of <m>\phi</m>. For each of the equations below, you should:
          <ol marker="i.">
            <li>
              <p>
                Draw a plot of the points that satisfy that equation. For some equations, your plot will be a path in space and others will correspond to a surface. You should draw how the <m>\phi</m>-coordinate is measured and related to the graph. 
              </p>
            </li>
            <li>
              <p>
                Write a sentence or two that describes the shape and features of your plot of the equation. You should mention any other descriptions that could be applied to your set of points, such as axes or coordinate planes.
              </p>
            </li>
          </ol>
        </p>
      </introduction>
      <task>
        <statement>
          <p>
            <m>\phi =0</m>
          </p>
        </statement>
      </task>
      <task>
        <statement>
          <p>
            <m>\phi =1</m>
          </p>
        </statement>
      </task>
      <task>
        <statement>
          <p>
            <m>\phi =\frac{\pi}{2}</m>
          </p>
        </statement>
      </task>
      <task>
        <statement>
          <p>
            <m>\phi =\frac{3\pi}{4}</m>
          </p>
        </statement>
      </task>
      <task>
        <statement>
          <p>
            <m>\phi = \pi</m>
          </p>
        </statement>
      </task>
    </activity>
</worksheet>
    <worksheet>
  <activity workspace="1.5in">
      <introduction>
        <p>
          For each of the surfaces described below, do the following:
          <ol marker="i.">
            <li>Find a corresponding equation in spherical coordinates (involving only <m>\rho</m>, <m>\theta</m>, and <m>\phi</m>). You may want to consider algebraic or geometric approaches to these problems.</li>
            <li>Draw a plot of surface and label any important measurements in terms of the spherical coordinates.</li>
            <li>Write a sentence or two about the corresponding equation in spherical coordinates and any assumptions made in your work.</li>
          </ol>
        </p>
      </introduction>
      <task>
        <statement>
          <p>
            the <m>xy</m>-plane
          </p>
        </statement>
      </task>
      <task>
        <statement>
          <p>
            the <m>xz</m>-plane 
          </p>
        </statement>
      </task>
      <task>
        <statement>
          <p>
            <m>z=x^2+y^2</m>
          </p>
        </statement>
      </task>
    </activity>
</worksheet>
    <example>
      <p>
        In this example, we will develop a method for understanding the region given by the spherical coordinates <m> 0 \leq \theta \leq \pi </m>, <m>1 \leq \rho \leq 2 </m>, and <m>\frac{\pi}{4} \leq \phi \leq \pi</m>. We will look at these inequalities in sequence to figure out what the set of points that satisfies all three looks like. Our first inequality,  <m> 0 \leq \theta \leq \pi </m>, corresponds to all points in the first, second, fifth, and sixth octants. It may be tempting to draw this region with a spherical outer boundary. However, with no restrictions on the other coordinates, your plot should emphasize that the region continues throughout all of these octants (without an outer boundary).
      </p>
      <figure xml:id="sphex14">
        <caption>A plot of the region <m> 0 \leq \theta \leq \pi </m></caption>
        <interactive label="interactive-sphex14" platform="sage" width="91%" aspect="1:1">
          <description><p>A plot of the region <m> 0 \leq \theta \leq \pi </m></p>
        </description><slate surface="sage">
            from sage.plot.plot3d.shapes import *
            from sage.plot.plot3d.plot3d import axes
            var('s,t')
            scale=3
            plot24=axes(scale+0.25,1.5,color="black",frame=False)+text3d("x",(scale+0.5,0,0),fontsize=30)+text3d("y",(0,scale+0.5,0),fontsize=30)+text3d("z",(0,0,scale+0.5),fontsize=30)
            plot24+=Box([3,1.5,3],color="yellow",opacity=0.25).translate((0,1.5,0))+text3d("0 \u2264 \u03C6 \u2264 \u03C0",(0,2,4),color="black",fontsize=25) 
            plot24+=parametric_plot3d((s,0,t),(s,0,scale),(t,-scale,scale),color="blue",opacity=0.5)+text3d("\u03B8 = 0",(3.5,-0.75,1.25),color="blue",fontsize=25)
            plot24+=parametric_plot3d((s,0,t),(s,-scale,0),(t,-scale,scale),color="magenta",opacity=0.5)+text3d("\u03B8 = \u03C0",(-3.5,-0.75,0.25),color="magenta",fontsize=25)
            show(plot24,viewpoint=[[0.8499,0.2985,0.4342],77.92],camera_position=[8.216,-8.8812,5.5437])
          </slate>
        </interactive>
      </figure>
      <p>
        We now want to think about the set of points that satisfy <m> 0 \leq \theta \leq \pi </m> and <m>1 \leq \rho \leq 2 </m>. The region given by <m>1 \leq \rho \leq 2 </m> is the set of points between the spheres of radius 1 and radius 2 centered at the origin. Hence, the region given by <m> 0 \leq \theta \leq \pi </m> and <m>1 \leq \rho \leq 2 </m> is the region between the spheres of radius 1 and radius 2 centered at the origin with positive <m>x</m>-coordinates.
      </p>
      <figure xml:id="sphex15">
        <caption>A plot of the region <m> 0 \leq \theta \leq \pi </m> and <m>1 \leq \rho \leq 2 </m></caption>
        <interactive label="interactive-sphex15" platform="sage" width="91%" aspect="1:1">
          <description><p>A plot of the region <m> 0 \leq \theta \leq \pi </m> and <m>1 \leq \rho \leq 2 </m></p>
        </description><slate surface="sage">
            from sage.plot.plot3d.shapes import *
            from sage.plot.plot3d.plot3d import axes
            var('s,t')
            scale=3
            plot25=axes(scale,1,color="black",frame=False)+text3d("x",(scale+0.5,0,0),fontsize=30)+text3d("y",(0,scale+0.5,0),fontsize=30)+text3d("z",(0,0,scale+0.5),fontsize=30)
            plot25+=parametric_plot3d((cos(t)*sin(s),sin(t)*sin(s),cos(s)),(s,0,pi),(t,0,pi),color="gray",opacity=.55)
            plot25+=parametric_plot3d((2*cos(t)*sin(s),2*sin(t)*sin(s),2*cos(s)),(s,0,pi),(t,0,pi),color="yellow",opacity=.35)
            plot25+=parametric_plot3d((s*sin(t),0,s*cos(t)),(s,1,2),(t,0,pi),color="green",opacity=0.4)+text3d("\u03B8=0",(2,-0.75,0),color="green",fontsize=25)
            plot25+=parametric_plot3d((-s*sin(t),0,s*cos(t)),(s,1,2),(t,0,pi),color="red",opacity=0.4)+text3d("\u03B8=\u03C0",(-4,-0.75,0.25),color="red",fontsize=25)
            plot25
          </slate>
        </interactive>
      </figure>
      <p>
        When we consider the additional restriction of <m>\frac{\pi}{4} \leq \phi \leq \pi</m>, we obtain the part of the region shown in <xref ref="sphex15"/> that is <em>below</em> the cone given by <m>\phi =\frac{\pi}{4}</m>. This gives the region shown in <xref ref="sphex16"/>. Note that we have shown each of the boundary surfaces in different colors to illustrate how each of the upper or lower bounds on each of the coordinates gives rise to a different part of our region. 
      </p>
      <figure xml:id="sphex16">
        <caption>A plot of the region <m> 0 \leq \theta \leq \pi </m>, <m>1 \leq \rho \leq 2 </m>, and <m>\frac{\pi}{4} \leq \phi \leq \pi</m></caption>
        <interactive label="interactive-sphex16" platform="sage" width="91%" aspect="1:1">
          <description><p>A plot of the region <m> 0 \leq \theta \leq \pi </m>, <m>1 \leq \rho \leq 2 </m>, and <m>\frac{\pi}{4} \leq \phi \leq \pi</m></p>
        </description><slate surface="sage">
            from sage.plot.plot3d.shapes import *
            from sage.plot.plot3d.plot3d import axes
            var('s,t')
            scale=3
            plot26=axes(scale,1,color="black",frame=False)+text3d("x",(scale+0.5,0,0),fontsize=30)+text3d("y",(0,scale+0.5,0),fontsize=30)+text3d("z",(0,0,scale+0.5),fontsize=30)
            plot26+=parametric_plot3d((cos(t)*sin(s),sin(t)*sin(s),cos(s)),(s,pi/4,pi),(t,0,pi),color="gray",opacity=.55)
            plot26+=parametric_plot3d((2*cos(t)*sin(s),2*sin(t)*sin(s),2*cos(s)),(s,pi/4,pi),(t,0,pi),color="yellow",opacity=.35)
            plot26+=parametric_plot3d((s*sin(t),0,s*cos(t)),(s,1,2),(t,pi/4,pi),color="green",opacity=0.4)+text3d("\u03B8=0",(3,-0.5,0),color="green",fontsize=25)
            plot26+=parametric_plot3d((-s*sin(t),0,s*cos(t)),(s,1,2),(t,pi/4,pi),color="red",opacity=0.4)+text3d("\u03B8=\u03C0",(-2,-0.75,0),color="red",fontsize=25)
            plot26+=parametric_plot3d((s*cos(t)*sqrt(2)/2,s*sin(t)*sqrt(2)/2,s*sqrt(2)/2),(s,1,2),(t,0,pi),color="blue",opacity=0.4)+text3d("\u03C6=\u03C0/4",(0,1,2),color="blue",fontsize=25)
            show(plot26,viewpoint=[[-0.8195,-0.3319,-0.4671],81.86],camera_position=[8.3609,-6.4789,4.5585])
          </slate>
        </interactive>
      </figure>
    </example>
    <p>
      The next activity gives you a chance to apply some of the skills introduced in the previous example.
    </p>
    <worksheet>
  <activity workspace="1.5in">
      <task>
        <statement>
          <p>
            Draw the region described by <m>\rho \leq 1</m> and <m> 0 \leq \phi \leq \frac{\pi}{2}</m>.
          </p>
        </statement>
      </task>
      <task>
        <statement>
          <p>
            Draw the region described by <m>x^2+y^2 \leq 9</m> with <m>x\leq y</m> and <m> -1 \leq z \leq 3</m>
          </p>
        </statement>
      </task>
      <task>
        <statement>
          <p>
            Give a set of inequalities in spherical coordinates that describes the points in the seventh octant.
          </p>
        </statement>
      </task>
    </activity>
</worksheet>
    <example>
      <p>
        For many people, the idea of latitude and longitude are the most familiar use of spherical coordinates. In particular, if you look at a globe as a map of the earth, then you will notice a grid of lines that run from the top to bottom or around the globe (horizontally). These lines measure latitude and longitude of different locations on the surface of the Earth. This latitude and longitude method of describing locations is actually spherical coordinates with a (slightly incorrect) assumption that the surface of the Earth corresponds to a constant value of <m>\rho</m>. 
      </p>
      <p>  
        If you look at the lines of longitude and latitude on a globe, you will see that these are angular measurements because each line in the grid is marked with a degree measurement. latitude describes how far a location is north or south of the equator and corresponds to a shifted measurement of the spherical coordinate <m>\phi</m>. Specifically, a latitude of <m>0^\circ</m> corresponds to the equator, which corresponds to points on the surface of the sphere with <m>\phi = \frac{\pi}{2} = 90^\circ </m>. The location identified with the <q>top</q> of the globe is often called the North Pole and corresponds to a latitude of <m>90^\circ</m> North and a spherical coordinate measurement of <m>\phi = 0</m>. Similarly, the <q>bottom</q> of the globe is called the South Pole and corresponds to a latitude of <m>90^\circ</m> South and a spherical coordinate measurment of <m>\phi=\pi=180^\circ</m>. 
      </p>
      <p>
        You can convert between latitude and <m>\phi</m> measurements by <me> \phi = 90^\circ + \text{latitude}</me>, where north latitudes are considered negative and south latitudes are considered positive.
      </p>
      <figure xml:id="sphex17">
        <caption>A plot of lines of constant latitude (in red) and longitude (in blue), with labels for the North and South Poles as well as the equator </caption>
        <interactive label="interactive-sphex17" platform="sage" width="91%" aspect="1:1">
          <description><p>A plot of lines of constant latitude (in red) and longitude (in blue), with labels for the North and South Poles as well as the equator </p>
        </description><slate surface="sage">
            from sage.plot.plot3d.shapes import *
            from sage.plot.plot3d.plot3d import axes
            var('s,t')
            scale=2
            nlat=10
            nlong=10
            plot27=axes(scale,1,color="gray",frame=False,opacity=0.2)+text3d("x",(scale+0.5,0,0),fontsize=30,color="gray")+text3d("y",(0,scale+0.5,0),fontsize=30,color="gray")+text3d("z",(0,0,scale+0.5),fontsize=30,color="gray")
            for i in range(nlat):
              lat=pi*i/nlat
              plot27+=parametric_plot3d((cos(t)*sin(lat),sin(t)*sin(lat),cos(lat)),(t,0,2*pi),color="red",thickness=1.5,opacity=0.5)
            for j in range(nlong):
              long=2*pi*j/nlong
              plot27+=parametric_plot3d((sin(t)*cos(long),sin(t)*sin(long),cos(t)),(t,0,pi),color="blue",thickness=1.5,opacity=0.5)
            plot27+=point3d((0,0,1),color="green",size=40)+text3d("North Pole",(0,1,1.25),color="green",fontsize=20)
            plot27+=point3d((0,0,-1),color="purple",size=40)+text3d("South Pole",(1,0,-1.25),color="purple",fontsize=20)
            plot27+=parametric_plot3d((cos(t),sin(t),0),(t,0,2*pi),color="black",thickness=2.5)+text3d("Equator",(0,2,0.25),color="black",fontsize=20)
            show(plot27,viewpoint=[[-0.2987,-0.6349,-0.7125],142.93],camera_position=[6.074,5.1549,1.4245])
          </slate>
        </interactive>
      </figure>
      <p>
        The blue curves in <xref ref="sphex17"/> are lines with constant longitude. Longitude corresponds to an angular measurement of how far around (horizontally) on the surface of the sphere. Longitude corresponds to a shifted version of the <m>\theta</m> coordinate. Lines of Longitude are called meridians and the Prime Meridian corresponds to the meridian that goes through the Greenwich Naval Observatory in Greenwich England. If you were to flatten out the surface of the globe to make the latitude and longitude lines form a rectangular grid, then you get a Mercator projection map which you may recoginize. While these flat maps are convienent there is a considerable amount of distortion in these maps as you get closer to the poles. As you can see in <xref ref="sphex17"/>, the lines with constant latitude are NOT all the same length, but need to be stretched out considerably near the poles to get a rectangular grid, as in <xref ref="MercatorProj"/>. Measuring the distortion of area (or volume) based on these coordinates will be an important idea in the later part of <xref ref="C_MI"/>.
      </p>
      <figure xml:id="MercatorProj">
        <caption>A Mercator projection of the Earth with latitude and longitude lines By Strebe - Own work, CC BY-SA 3.0, https://commons.wikimedia.org/w/index.php?curid=17700069</caption>
        <image source="./images/Mercator_projection_Square.JPG">
          <description><p>A Mercator projection of the Earth with latitude and longitude lines By Strebe - Own work, CC BY-SA 3.0, https://commons.wikimedia.org/w/index.php?curid=17700069</p>
        </description></image>
      </figure>
      <p>
        If we extended the grid of latitude and longitude to allow for multiple radii of spheres, we get a spherical coordinate grid as shown in <xref ref="sphex18"/>. You can see how visually cluttered this grid is and why you will likely not see this idea used in plotting again.
      </p>
      <figure xml:id="sphex18">
        <caption>A plot of a grid of spherical coordinates </caption>
        <interactive label="interactive-sphex18" platform="sage" width="91%" aspect="1:1">
          <description><p>A plot of a grid of spherical coordinates </p>
        </description><slate surface="sage">
            from sage.plot.plot3d.shapes import *
            from sage.plot.plot3d.plot3d import axes
            var('s,t')
            scale=3
            nlat=10
            nlong=10
            nrho=4
            plot28=axes(scale,1,color="gray",frame=False)+text3d("x",(scale+0.5,0,0),fontsize=30,color="gray")+text3d("y",(0,scale+0.5,0),fontsize=30,color="gray")+text3d("z",(0,0,scale+0.5),fontsize=30,color="gray")
            for k in range(1,nrho+1):
              r=2*k/nrho
              for i in range(nlat):
                lat=pi*i/nlat
                plot28+=parametric_plot3d((r*cos(t)*sin(lat),r*sin(t)*sin(lat),r*cos(lat)),(t,0,2*pi),color="red",thickness=1,opacity=0.5)
              for j in range(nlong):
                long=2*pi*j/nlong
                plot28+=parametric_plot3d((r*sin(t)*cos(long),r*sin(t)*sin(long),r*cos(t)),(t,0,pi),color="blue",thickness=1,opacity=0.5)
            show(plot28,viewpoint=[[-0.2733,-0.6455,-0.7132],146.39],camera_position=[8.3747,8.1398,1.8098])
          </slate>
        </interactive>
      </figure>
      
    </example>
  </subsection>


 

  <outcomes>
    <ul>
      <li>
        <p>
          The polar coordinates of a point <m>P</m> in <m>\R^2</m> are <m>(r,\theta)</m> where <m>r</m> is the distance from the origin to <m>P</m> and <m>\theta</m> is the angle that the line segment from the origin to <m>P</m> makes with the positive <m>x</m>-axis.  When <m>P</m> has rectangular coordinates <m>(x,y)</m>, it follows that  its polar coordinates are given by
          <md>
            <mrow>r^2  \amp= x^2  + y^2 \amp \tan(\theta) \amp= \frac{y}{x}.</mrow>
          </md>
          When <m>P</m> has given polar coordinates <m>(r,\theta)</m>, its rectangular coordinates are
          <md>
            <mrow>x \amp= r \cos(\theta)\amp y \amp= r \sin(\theta)</mrow>
          </md>.
        </p>
      </li>

      <li>
        <p>
          The cylindrical coordinates of a point <m>P</m> are <m>(r,\theta,z)</m> where <m>r</m> is the distance from the origin to the projection of <m>P</m> onto the <m>xy</m>-plane, <m>\theta</m> is the angle that the projection of <m>P</m> onto the <m>xy</m>-plane makes with the positive <m>x</m>-axis, and <m>z</m> is the vertical distance from <m>P</m> to the projection of <m>P</m> onto the <m>xy</m>-plane.  When <m>P</m> has rectangular coordinates <m>(x,y,z)</m>, it follows that  its cylindrical coordinates are given by
          <md>
            <mrow>r^2  \amp = x^2  + y^2 \amp \tan(\theta) \amp = \frac{y}{x} \amp z \amp = z</mrow>
          </md>.
          When <m>P</m> has given cylindrical coordinates <m>(r,\theta,z)</m>, its rectangular coordinates are
          <md>
            <mrow>x \amp = r \cos(\theta) \amp y \amp = r \sin(\theta) \amp z \amp = z</mrow>
          </md>.
        </p>
      </li>

      <li>
        <p>
          The spherical coordinates of a point <m>P</m> in 3-space are <m>\rho</m> (rho), <m>\theta</m>, and <m>\phi</m> (phi), where <m>\rho</m> is the distance from <m>P</m> to the origin, <m>\theta</m> is the angle that the projection of <m>P</m> onto the <m>xy</m>-plane makes with the positive <m>x</m>-axis, and <m>\phi</m> is the angle between the positive <m>z</m> axis and the vector from the origin to <m>P</m>.  When <m>P</m> has rectangular coordinates <m>(x,y,z)</m>, the spherical coordinates are given by
          <md>
            <mrow>\rho^2  \amp = x^2  + y^2 + z^2 \amp \tan(\theta) \amp = \frac{y}{x} \amp \cos(\phi) \amp = \frac{z}{\rho}</mrow>
          </md>.
          Given the point <m>P</m> in spherical coordinates <m>(\rho, \phi, \theta)</m>, its rectangular coordinates are
          <md>
            <mrow>x \amp = \rho \sin(\phi) \cos(\theta)\amp y \amp = \rho \sin(\phi) \sin(\theta) \amp z \amp = \rho \cos(\phi)</mrow>
          </md>.
        </p>
      </li>
      <li>
        <p>
          The conversion formulas above can be used to convert equations between coordinate systems.
        </p>
      </li>
    </ul>
    </outcomes>

    <xi:include href="exercises/ez-S_Precalc_Other_Coordinate_Systems.ptx"/>
</section>
