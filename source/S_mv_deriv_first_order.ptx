<?xml version="1.0"?>
<!-- **********************************************************************-->
<!-- Copyright 2013-2025                                                   -->
<!-- Nicholas Long, Mitch Keller, Steven Schlicker                         -->
<!--                                                                       -->
<!-- This file is part of Active Calculus Multivariable.                   -->
<!--                                                                       -->
<!-- Permission is granted to copy, distribute and/or modify this document -->
<!-- under the terms of the Creative Commons BY-NC-SA license.  The work   -->
<!-- may be used for free by any party so long as attribution is given to  -->
<!-- the author(s), the work and its derivatives are used in the spirit of -->
<!-- "share and share alike"; no party may sell this work or any of its    -->
<!-- derivatives for profit.  All trademarks are the registered marks of   -->
<!-- their respective owners.                                              -->
<!-- **********************************************************************-->
<section xml:id="S-10-2-First-Order-Partial-Derivatives"  xmlns:xi="http://www.w3.org/2001/XInclude">
  <title>First-Order Partial Derivatives</title>
  <objectives>
  <ul>
    <li>
      <p>
        Given a function to two variables, <m>f(x,y)</m>, how can we measure the rate of change with respect to one of the input variables?
      </p>
    </li>
    <li>
      <p>
        Given a function <m>f</m> of the independent variables <m>x</m> and <m>y</m>, what does the rate of change with respect to either <m>x</m> or <m>y</m> tell us about the graph of <m>z=f(x,y)</m>?
      </p>
    </li>
  </ul>
      <!-- <ul>
        <li>
          <p>
            How are the first-order partial derivatives of a function <m>f</m> of the independent variables <m>x</m> and <m>y</m> defined?
          </p>
        </li>

        <li>
          <p>
            Given a function <m>f</m> of the independent variables <m>x</m> and <m>y</m>, what do the first-order partial derivatives <m>\frac{\partial
                f}{\partial x}</m> and <m>\frac{\partial f}{\partial y}</m> tell us about <m>f</m>?
          </p>
        </li>
      </ul> -->
  </objectives>
  <introduction>
  <p>
    The derivative plays a central role in single variable calculus because it provides important information about a function in terms of each of the representations of the function. Thinking graphically, the derivative at a point tells us the slope of the line tangent to the graph at the given point. Numerically, the derivative at a point also provides the instantaneous rate of change of the function with respect to a change in the independent variable. Algebraically, we can calculate the derivative as a function of the same input variable, which is useful as a tool to examine where the function is increasing or decreasing, as well as the concavity of the function's graph. 
  </p>
  <p>
    In this chapter, we are investigating functions of two or more variables and we can still ask how fast a function of several variables is changing, but we have to be careful about what we mean. Thinking graphically again, we can try to measure how steep the graph of the function is in a particular direction. As we saw in <xref ref="S-10-1-Limits"/>, the idea of measuring the behavior of a two variable function in a particular direction and generalizing to other directions is a <em>much</em> deeper idea when you have multiple input variables. Alternatively, we may want to know how quickly a function's output is changing in response to varying only one of the inputs. Over the next few sections, we will develop tools for addressing these questions and more. In the following preview activity, we will look at how we can apply our single variable calculus knowledge to measure the rate of change when we hold all but one input variable constant. 
    <!-- Preview <xref ref="PA_10_2">Activity</xref> explores some issues with what we will come to call <em>partial derivatives</em>. -->
  </p>
  <exploration xml:id="PA_10_2">
    <introduction>
      <p>
        Suppose we take out an $18,000 car loan at interest rate <m>r</m> and we agree to pay off the loan in <m>t</m> years. The monthly payment, in dollars, is
        <me>
          M(r,t) =
            \frac{1500r}{1-\left(1+\frac{r}{12}\right)^{-12t}}.
        </me>
      </p>
    </introduction>
    <task>
      <statement>
        <p>
          If you take a loan with an interest rate of <m>3\%</m> (so <m>r = 0.03</m>) and will pay it off in <m>t=4</m> years, what will your monthly payment be?
        </p>
      </statement>
      <answer>
        <p>
          approximately <m>\$ 398.42 </m>
        </p>
      </answer>
      <solution>
        <p>
          <m>M(0.03,4)=\$ 398.42 </m>
        </p>
      </solution>
    </task>
    <task>
      <statement>
        <p>
          Suppose the interest rate on loans is fixed at <m>3\%</m>.  Express <m>M</m> as a function <m>f</m> of <m>t</m> alone using <m>r=0.03</m>. That is, let <m>f(t) = M(0.03, t)</m>. Sketch the graph of <m>f</m> on <xref ref="F_10_2_preview_1"/> and write a couple of sentences to explain the meaning of the function <m>f</m>.
        </p>
        <figure xml:id="F_10_2_preview_1">
          <caption>A plot of <m>f(t)=M(0.03,t)</m></caption>
          <image width="50%" xml:id="img-F_10_2_preview_1">
            <sageplot>
              tx=[i for i in range(0,11)]
              ty=[j for j in range(0,1250,250)]
              plot1=point((0,0),size=0,color="black",gridlines=True,ticks=[tx,ty],xmin=0,xmax=10,ymin=0,ymax=1000,axes_labels=["$t$","$f(t)$"],frame=False)
              plot1
            </sageplot>
          </image>
        </figure>
      </statement>
      <answer>
        <p>
          If <m>r</m> is fixed at <m>r=0.03</m>, then <m>M</m> is a function of <m>t</m> alone and
          <me>
            f(t) = M(0.03,t) =  \frac{1500(0.03)}{1-\left(1+\frac{0.03}{12}\right)^{-12t}} = \frac{45}{1-1.0025^{-12t}}
          </me>
          The function <m>f</m> tells us the monthly payment on a loan at different durations of time if the interest rate is fixed at <m>3\%</m>.
        </p>
      </answer>
      <solution>
        <p>
          If <m>r</m> is fixed at <m>r=0.03</m>, then <m>M</m> is a function of <m>t</m> alone and
          <me>
            f(t) = M(0.03,t) =  \frac{1500(0.03)}{1-\left(1+\frac{0.03}{12}\right)^{-12t}} = \frac{45}{1-1.0025^{-12t}}
          </me>
          The function <m>f</m> tells us the monthly payment on a loan at different durations of time if the interest rate is fixed at <m>3\%</m>.
        </p>
      </solution>
    </task>
    <task>
      <statement>
        <p>
          Find the instantaneous rate of change <m>f'(4)</m> and state the units on this quantity.  What information does <m>f'(4)</m> tell us about our car loan? What information does <m>f'(4)</m> tell us about the graph you sketched in (b)?
        </p>
      </statement>
      <answer>
        <p>
          We have
          <me>
            f'(4) \approx -93.75 \ \frac{\text{ dollars } }{\text{ year } }
          </me>
          which tells us that if we keep the interest rate constant at <m>3\%</m>, for every one year increase in the duration of the loan from 4 years there is an approximate decrease in the monthly payment of approximately 93.75 dollars. The quantity <m>f'(4)</m> also tells us the slope of the line tangent to the graph of <m>f</m> at <m>t=4</m>.
        </p>
      </answer>
      <solution>
        <p>
          We have
          <me>
            f'(4) \approx -93.75 \ \frac{\text{ dollars } }{\text{ year } }
          </me>
          which tells us that if we keep the interest rate constant at <m>3\%</m>, for every one year increase in the duration of the loan from 4 years there is an approximate decrease in the monthly payment of approximately 93.75 dollars. The quantity <m>f'(4)</m> also tells us the slope of the line tangent to the graph of <m>f</m> at <m>t=4</m>.
        </p>
      </solution>
    </task>
    <task>
      <statement>
        <p>
          Suppose that we want to examine how the monthly payment will change if we plan to take 4 years to pay off the loan. Express <m>M</m> as a function of the interest rate <m>r</m> with a fixed loan term of <m>t=4</m>. That is, let <m>g(r) = M(r, 4)</m>. Give the function <m>g(r)</m> and sketch a graph of <m>g</m> on <xref ref="F_10_2_preview_2"/>. Write a couple of sentences to explain the meaning of the function <m>g</m>.
        </p>
        <figure xml:id="F_10_2_preview_2">
          <caption>A plot of <m>f(t)=M(0.03,t)</m></caption>
          <image width="50%" xml:id="img-F_10_2_preview_2">
            <sageplot>
              tx=[i*0.02 for i in range(0,11)]
              ty=[j for j in range(0,1250,250)]
              plot2=point((0,0),size=0,color="black",gridlines=True,ticks=[tx,ty],xmin=0,xmax=0.1,ymin=0,ymax=1000,axes_labels=["$r$","$g(r)$"],frame=False)
              plot2
            </sageplot>
          </image>
        </figure>
      </statement>
      <answer>
        <p>
          If <m>t</m> is fixed at <m>t=4</m>, then <m>M</m> is a function of <m>r</m> alone and
          <me>
            g(r) = M(r,4) = \frac{1500r}{1-\left(1+\frac{r}{12}\right)^{-48}}
          </me>.
          The function <m>g</m> tells us the monthly payment on a loan at different interest rates if the duration of the loan is fixed at 4 years.
        </p>
      </answer>
      <solution>
        <p>
          If <m>t</m> is fixed at <m>t=4</m>, then <m>M</m> is a function of <m>r</m> alone and
          <me>
            g(r) = M(r,4) = \frac{1500r}{1-\left(1+\frac{r}{12}\right)^{-48}}
          </me>.
          The function <m>g</m> tells us the monthly payment on a loan at different interest rates if the duration of the loan is fixed at 4 years.
        </p>
      </solution>
    </task>
    <task>
      <statement>
        <p>
          Find the instantaneous rate of change <m>g'(0.03)</m> and state the units on this quantity.  Write a couple of sentences to explain what information does <m>g'(0.03)</m> tell us about our car loan.  What information does <m>g'(0.03)</m> tell us about the graph you sketched in (d)?
        </p>
      </statement>
      <answer>
        <p>
          We have
          <me>
            g'(0.03) \approx 795.54  \frac{\text{ dollars } }{\% }
          </me>,
          which tells us that if we keep the duration of the loan constant at 4 years, when we increase the interest rate by 1 percent from a rate of 3%, the monthly payment on the loan increases by approximately $795.54. The quantity <m>g'(0.03)</m> also tells us the slope of the line tangent to the graph of <m>g</m> at <m>r=0.03</m>.
        </p>
      </answer>
      <solution>
        <p>
          We have
          <me>
            g'(0.03) \approx 795.54  \frac{\text{ dollars } }{\% }
          </me>,
          which tells us that if we keep the duration of the loan constant at 4 years, when we increase the interest rate by 1 from a rate of 3%, the monthly payment on the loan increases by approximately $795.54. The quantity <m>g'(0.03)</m> also tells us the slope of the line tangent to the graph of <m>g</m> at <m>r=0.03</m>.
        </p>
      </solution>
    </task>
    </exploration>
  </introduction>

  <subsection>
    <title>First-Order Partial Derivatives</title>
    <p>
      In <xref ref="S-MV-Functions">Section</xref>, we studied the behavior of a function of two or more variables by considering the <em>traces</em> of the function. By holding one of our input variables constant, we restricted our multivariable function to have only one input variable, which means we can use all of our calculus tools from the past several courses on these traces.
    </p>  
    <p>  
      Recall that in one example, we considered the function <m>f</m> defined by
      <me>
        f(x,y) = \frac{x^2 \sin(2 y)}{32},
      </me>
      which measures the range, or horizontal distance, in feet, traveled by a projectile launched with an initial speed of <m>x</m> feet per second at an angle <m>y</m> radians to the horizontal. The graph of this function is given again in <xref ref="zfnxy2">Figure</xref> with traces plotted on the surface for <m>x=150</m> (in blue) and <m>y=0.6</m> (in red). 
    </p>
    <figure xml:id="zfnxy2">
      <caption>The distance surface given by <m>z=f(x,y) = \frac{x^2 \sin(2y)}{g}</m></caption>
      <interactive title="interactive-zfnxy2" platform="sage" width="85%" aspect="1:1">
        <slate surface="sage">
          scale=100
          plot11=line([(0,0,0),(scale,0,0)],color="black",thickness=3)+line([(0,0,0),(0,scale/100,0)],color="black",thickness=3)+line([(0,0,0),(0,0,scale*20)],color="black",thickness=3)
          var('x,y,z')
          d1=100
          d2=1
          g(x,y)=x^2*sin(2*y)/9.8
          plot11+=plot3d(g,(x,0,200),(y,0,pi/2),color="gray",plot_points=21,opacity=0.8,mesh=True,frame=False)
          plot11+=parametric_plot3d((x,0.6,g(x,0.6)),(x,0,200),color="red",thickness=3)
          plot11+=parametric_plot3d((150,y,g(150,y)),(y,0,pi/2),color="blue",thickness=3)
          plot11+=parametric_plot3d((x,pi/2+d2,g(x,0.6)),(x,0,200),color="red",thickness=3)
          plot11+=parametric_plot3d((200+d1,y,g(150,y)),(y,0,pi/2),color="blue",thickness=3)
          plot11+=parametric_plot3d((x,pi/2+d2,z),(x,0,200),(z,0,4100),color="gray",plot_points=5,opacity=0.0,mesh=True)
          plot11+=parametric_plot3d((200+d1,y,z),(y,0,pi/2),(z,0,4100),color="gray",plot_points=5,opacity=0.0,mesh=True)
          plot11+=text3d("x",(100,pi/2+d2,-300),fontsize=50)
          plot11+=text3d("z",(200+d1,pi/2+d2,4100),fontsize=50)
          plot11+=text3d("y",(200+d1,0.75,-300),fontsize=50)
          show(plot11,aspect_ratio=[1,100,0.05],viewpoint=[[-0.8958,0.2603,0.3602],77.78],camera_position=[-150.5634,-345.094,280.5231])
        </slate>
      </interactive>
    </figure>
    <p>
      Moreover, if we fix the angle <m>y = 0.6</m>, we may view the trace <m>f(x,0.6)</m> as a function of <m>x</m> alone, as seen in <xref ref="F_10_2_trace_y">Figure</xref>.
    </p>
    <figure xml:id="F_10_2_trace_y">
      <caption>A plot of <m>f(x,0.6)</m></caption>
      <image width="50%" xml:id="img-F_10_2_trace_y">
        <sageplot>
          var('x,y,t')
          g(x,y)=x^2*sin(2*y)/32
          gx=diff(g,x)
          plot3=plot(g(x,0.6),(x,0,200),color="red",thickness=2,gridlines=True,ymin=0,ymax=1200,xmin=0,xmax=250,axes_labels=["$x$","$f(x,0.06)$"],frame=True)
          plot3+=point((150,g(150,0.6)),size=50,color="black",aspect_ratio=0.2,zorder=5)
          plot3+=parametric_plot((150+t,g(150,0.6)+t*gx(150,0.6)),(t,-30,30),color="blue",thickness=2,aspect_ratio=0.2)
          plot3
        </sageplot>
      </image>
    </figure>
    <!-- <figure xml:id="F_10_2_trace_y">
      <caption>Left: The trace of <m>z=\frac{x^2 \sin(2 y)}{32}</m> with <m>y = 0.6</m>.</caption>
      <sidebyside widths="50% 50%">
      <image source="images/fig_10_2_trace_y_a"/>
      <image source="images/fig_10_2_trace_y"/>
      </sidebyside>
    </figure> -->
    <p>
      Since the trace is a one-variable function, we may consider its derivative just as we did in single variable calculus. With <m>y=0.6</m>, we have
      <me>
        f(x,0.6) = \frac{\sin(1.2)}{32}x^2,
      </me>
      and therefore
      <me>
        \frac{d}{dx}\Bigl[ f(x,0.6) \Bigr] = \frac{\sin(1.2)}{16}x.
      </me>
    </p>
    <p>
      When <m>x=150</m>, this gives
      <me>
        \frac{d}{dx}\Bigr[ f(x,0.6) \Bigr]\restrict{x=150} = \frac{\sin(1.2)}{16}150 \approx 8.74~\mbox{feet per feet per second} ,
      </me>
      which gives the slope of the tangent line shown in <xref ref="F_10_2_trace_y">Figure</xref>. Thinking of this derivative as an instantaneous rate of change implies that if we increase the initial speed of the projectile by one foot per second, we expect the horizontal distance traveled to increase by approximately 8.74 feet when we fix the launch angle at <m>0.6</m> radians. Note here that the sign of the derivative of the trace is positive, which is why there would be an increase to the range of the projectile if we increased the initial speed (above <m>150 ft/s</m>) while holding the launch angle constant at <m>0.6</m> radians. 
    </p>
    <p>
      By holding <m>y</m> fixed and differentiating with respect to <m>x</m>, we obtain the first-order <em>partial derivative of <m>f</m> with respect to <m>x</m></em>. Denoting this partial derivative as <m>f_x</m>, we have seen that
      <me>
        f_x(150, 0.6) = \frac{d}{dx} \Bigl[ f(x,0.6) \Bigr] \restrict{x=150} = \lim_{h\to 0}\frac{f(150+h, 0.6) - f(150, 0.6)}{h}
      </me>
    </p>
    <p>
      More generally, we have
      <me>
        f_x(a,b) = \lim_{h \to 0} \frac{f(a+h, b)-f(a,b)}{h},
      </me>
      provided this limit exists.
    </p>

    <p>
      In the same way, we may obtain a trace by setting, say, <m>x=150</m> as shown in <xref ref="F_10_2_trace_x">Figure</xref>.
    </p>
    <figure xml:id="F_10_2_trace_x">
      <caption>A plot of <m>f(x,0.6)</m></caption>
      <image width="50%" xml:id="img-F_10_2_trace_x">
        <sageplot>
          var('x,y,t')
          g(x,y)=x^2*sin(2*y)/32
          gv=g(150,0.6)
          gy=diff(g,y)
          gyv=gy(150,0.6)
          plot4=plot(g(150,y),(y,0,pi/2),color="blue",thickness=2,gridlines=True,ymin=0,ymax=1200,axes_labels=["$y$","$f(150,y)$"],frame=True)
          plot4+=point((0.6,gv),size=50,color="black",zorder=5)
          #plot4+=parametric_plot((t+0.06,gv),(t,-0.02,0.02),color="blue",thickness=2)
          plot4+=line([(0.4,gv-0.2*gyv),(0.8,gv+0.2*gyv)],color="red",thickness=2,aspect_ratio=0.0015)
          plot4
        </sageplot>
      </image>
    </figure>
    <!-- <figure xml:id="F_10_2_trace_x">
      <caption>The trace of <m>z=\frac{x^2 \sin(2 y)}{32}</m> with <m>x = 150</m>.</caption>
      <sidebyside widths="50% 50%">
      <image source="images/fig_10_2_trace_x_a"/>
      <image source="images/fig_10_2_trace_x"/>
      </sidebyside>
    </figure> -->
    <p>
      This gives
      <me>
        f(150, y) = \frac{150^2}{32}\sin(2y),
      </me>
      and therefore
      <me>
        \frac{d}{dy}[f(150,y)] = \frac{150^2}{16}\cos(2y).
      </me>
    </p>
    <p>
      If we evaluate this quantity at <m>y=0.6</m>, we have
      <me>
        \frac{d}{dy}\Bigl[ f(150,y) \Bigr]\restrict{y=0.6} = \frac{150^2}{16}\cos(1.2) \approx 509.5
        ~\mbox{feet per radian} 
      </me>
    </p>
    <p>
      Once again, the derivative gives the slope of the tangent line shown on the right in <xref ref="F_10_2_trace_x">Figure</xref>. Thinking of the derivative as an instantaneous rate of change, we expect that the range of the projectile increases by 509.5 feet for every radian we increase the launch angle <m>y</m> if we keep the initial speed of the projectile constant at 150 feet per second.
    </p>
    <p>
      By holding <m>x</m> fixed and differentiating with respect to <m>y</m>, we obtain the first-order <em>partial derivative of <m>f</m> with respect to <m>y</m></em>. As before, we denote this partial derivative as <m>f_y</m> and write
      <me>
        f_y(150, 0.6) = \frac{d}{dy} \Bigl[ f(150,y) \Bigr]\restrict{y=0.6} = \lim_{h \to 0}\frac{f(150, 0.6+h) - f(150, 0.6)}{h}.
      </me>
    </p>
    <p>
      As with the partial derivative with respect to <m>x</m>, we may express this quantity more generally at an arbitrary point <m>(a,b)</m>. To recap, we have now arrived at the formal definition of the first-order partial derivatives of a function of two variables.
    </p>
    <definition>
      <statement>
        <p>
          The first-order <term>partial derivatives of <m>f</m> with respect to <m>x</m> and <m>y</m></term><idx><h>partial derivatives</h><h>first-order</h></idx> at a point <m>(a,b)</m> are (provided the limits exist), respectively,
          <md>
            <mrow>f_x(a,b) \amp = \frac{\partial f}{\partial x} \amp = \lim_{h \to 0} \frac{f(a+h,b)-f(a,b)}{h}</mrow>
            <mrow>f_y(a,b) \amp = \frac{\partial f}{\partial y} \amp = \lim_{h \to 0} \frac{f(a,b+h)-f(a,b)}{h}</mrow>
          </md>
        </p>
      </statement>
    </definition>

    <activity xml:id="A_10_2_10">
    <introduction>
      <p>
        In this activity, we will be examining the function <m>f</m> defined by
          <me>
            f(x,y) = \frac{x y^2}{x+1}
          </me>
          at the point <m>(1,2)</m>. Specifically, we will be looking how the traces of this function will be related to the values of the partial derivatives. 
      </p>
    </introduction>
    <task>
      <statement>
        <p>
          Give the trace <m>f(x,2)</m> at the fixed value <m>y=2</m> as a function of <m>x</m>. On <xref ref="F_10_2_activity_trace1">Figure</xref>, draw the graph of the trace with <m>y=2</m> around the point where <m>x=1</m>, indicating the scale and labels on the axes. On the graph of the trace with <m>y=2</m>, sketch the tangent line at the point <m>x=1</m>.
        </p>
        <figure xml:id="F_10_2_activity_trace1">
          <caption>A plot of <m>f(x,2)</m></caption>
          <image width="50%" xml:id="img-F_10_2_trace1">
            <sageplot>
              plot5=point((0,0),size=0,color="black",gridlines=True,xmin=-3,xmax=3,ymin=-3,ymax=3,frame=False,aspect_ratio=1)
              plot5 
            </sageplot>
          </image>
        </figure>
      </statement>
      <answer>
        <p>
          Here we have <m>f(x,2) = \frac{4x}{x+1}</m>. At the point where <m>x=1</m>, the tangent line to this trace has slope <m>\frac{d}{dx} f(x,2) \left. \restrict{x=1} = 1</m>, and so the line tangent to the graph of this trace at <m>x=1</m> has equation <m>z=2+(x-1)</m>.
        </p>
      </answer>
      <solution>
        <p>
          Here we have <m>f(x,2) = \frac{4x}{x+1}</m>. At the point where <m>x=1</m>, the tangent line to this trace has slope <m>\frac{d}{dx} f(x,2) \left. \restrict{x=1} = 1</m>, and so the line tangent to the graph of this trace at <m>x=1</m> has equation <m>z=2+(x-1)</m>.
        </p>
      </solution>
    </task>
    <task>
      <statement>
        <p>
          Find the partial derivative <m>f_x(1,2)</m> and relate its value to the sketch you just made.
        </p>
      </statement>
      <answer>
        <p>
          We have <m>f_x(1,2) = \frac{8-4}{4} = 1</m>. This is the slope of the line tangent to the trace <m>f(x,2)</m> at the point where <m>x=1</m>, as calculated in part (a).
        </p>
      </answer>
      <solution>
        <p>
          We have <m>f_x(1,2) = \frac{8-4}{4} = 1</m>. This is the slope of the line tangent to the trace <m>f(x,2)</m> at the point where <m>x=1</m>, as calculated in part (a).
        </p>
      </solution>
    </task>
    <task>
      <statement>
        <p>
          Give the trace <m>f(1,y)</m> as a function of <m>y</m> at the fixed value <m>x=1</m>. On <xref ref="F_10_2_activity_trace2">Figure</xref>, draw the graph of the trace with <m>x=1</m> indicating the scale and labels on the axes. On your graph of the trace corresponding to <m>x=1</m>, sketch the tangent line at the point <m>y=2</m>.
        </p>
        <figure xml:id="F_10_2_activity_trace2">
          <caption>A plot of <m>f(x,2)</m></caption>
          <image width="50%" xml:id="img-F_10_2_trace2">
            <sageplot>
              plot5=point((0,0),size=0,color="black",gridlines=True,xmin=-3,xmax=3,ymin=-3,ymax=3,frame=False,aspect_ratio=1)
              plot5 
            </sageplot>
          </image>
        </figure>
      </statement>
      <answer>
        <p>
          Here we have <m>f(1,y) = \frac{1}{2}y^2</m>. At the point where <m>y=2</m>, the tangent line to this trace has slope <m>\frac{d}{dy} f(1,y) \left. \restrict{y=2} = 2</m>, and so the line tangent to the graph of this trace at <m>y=2</m> has equation <m>z=2+2(y-2)</m>.
        </p>
      </answer>
      <solution>
        <p>
          Here we have <m>f(1,y) = \frac{1}{2}y^2</m>. At the point where <m>y=2</m>, the tangent line to this trace has slope <m>\frac{d}{dy} f(1,y) \left. \restrict{y=2} = 2</m>, and so the line tangent to the graph of this trace at <m>y=2</m> has equation <m>z=2+2(y-2)</m>.
        </p>
      </solution>
    </task>           
    <task>
      <statement>
        <p>
          Find the partial derivative <m>f_y(1,2)</m> and relate its value to the sketch you just made.
        </p>
      </statement>
      <answer>
        <p>
          Now <m>f_y(1,2) = 2</m>. This is the slope of the line tangent to the trace <m>f(1,y)</m> at the point where <m>y=2</m>, as calculated in part (c).
        </p>
      </answer>
      <solution>
        <p>
          Now <m>f_y(1,2) = 2</m>. This is the slope of the line tangent to the trace <m>f(1,y)</m> at the point where <m>y=2</m>, as calculated in part (c).
        </p>
      </solution>
    </task>
  </activity>
  <p>
    As these examples show, each partial derivative at a point arises as the derivative of a one-variable function defined by fixing all other coordinates. In addition, we may consider each partial derivative as defining a new function with input given by the point <m>(x,y)</m>, just as the derivative <m>f'(x)</m> defines a new function of <m>x</m> in single-variable calculus. Due to the connection between one-variable derivatives and partial derivatives, we will often use Leibniz-style notation to denote partial derivatives by writing
    <me>
      \frac{\partial f}{\partial x}(a, b) = f_x(a,b),
      \ 
      \mbox{and} 
      \ 
      \frac{\partial f}{\partial y}(a, b) = f_y(a,b).
    </me>
  </p>
  <p>
    To calculate the partial derivative <m>f_x</m>, we hold <m>y</m> fixed and thus we treat <m>y</m> as a constant. In Leibniz notation, observe that
    <me>
      \frac{\partial }{\partial x} (x) = 1  \  \mbox{and}  \  \frac{\partial }{\partial x}(y) = 0.
    </me>
  </p>
  <p>
    To see the contrast between how we calculate single variable derivatives and partial derivatives, and the difference between the notations <m>\frac{d}{dx}\bigl[ \ \bigr]</m> and <m>\frac{\partial}{\partial x}\bigl[ \ \bigr]</m>, observe that
    <md>
      <mrow> \frac{d}{dx}\Bigl[ 3x^2 - 2x + 3 \Bigr] = 3\frac{d}{dx} \Bigl[ x^2 \Bigr] - 2\frac{d}{dx} \Bigl[ x \Bigr] + \frac{d}{dx} \Bigl[ 3 \Bigr] = 3\cdot 2x - 2 </mrow>    
      <mrow> \frac{\partial}{\partial x}\Bigl[ x^2y - xy + 2y \Bigr] = y\frac{\partial}{\partial x} \Bigl[ x^2 \Bigr] - y\frac{\partial}{\partial x} \Bigl[ x \Bigr] + \frac{\partial}{\partial x} \Bigl[ 2y \Bigr] = y\cdot 2x - y</mrow>
    </md>
  </p>
  <p>
    We will highlight a few terms of the above calculations for emphasis. Note that when we are interested in taking the partial derivative with respect to <m>x</m> of a term like <m>x^2y</m>, we can factor out the <m>y</m> like it was a coefficient because <m>y</m> is constant with respect to changes in <m>x</m>. Algebraically, this looks like <me> \frac{\partial}{\partial x} \Bigl[ x^2y \Bigr] = y\frac{\partial}{\partial x} \Bigl[ x^2 \Bigr] </me>
    Similarly, when we are taking the partial derivative with respect to <m>x</m> of a term like <m>2y</m>, the entire term is constant (with respect to <m>x</m>), so 
    <me> \frac{\partial}{\partial x} \Bigl[ 2y \Bigr] = 0 </me>
  </p>
  <p>
    Thus, computing partial derivatives is straightforward: we use the standard algebraic rules from single variable calculus, but do so while holding all but one of the variables constant.
  </p>
  <activity xml:id="A_10_2_2">
  <task>
    <statement>
      <p>
        If <m>f(x,y) = 3x^3 - 2x^2y^5</m>, find the partial derivatives <m>f_x</m> and <m>f_y</m>.
      </p>
    </statement>
    <answer>
      <p>
        <me>
          \frac{\partial f}{\partial x} = 9x^2 - 4y^5x
        </me>
        and
        <me>
          \frac{\partial f}{\partial y} = -10x^2y^4
        </me>
      </p>
    </answer>
  </task>
  <task>
    <statement>
      <p>
        If <m>f(x,y) = \displaystyle\frac{xy^2}{x+1}</m>, find the partial derivatives <m>f_x</m> and <m>f_y</m>.
      </p>
    </statement>
    <answer>
      <p>
        <me>
          \frac{\partial f}{\partial x} = \frac{(x + 1)y^2 - xy^2}{(x + 1)^2} = \frac{y^2}{(x + 1)^2}
        </me>
        and
        <me>
          \frac{\partial f}{\partial y} = \frac{2xy}{x + 1}
        </me>
      </p>
    </answer>
    <solution>
      <p>
        <me>
          \frac{\partial f}{\partial x} = \frac{(x + 1)y^2 - xy^2}{(x + 1)^2} = \frac{y^2}{(x + 1)^2}
        </me>
        and
        <me>
          \frac{\partial f}{\partial y} = \frac{2xy}{x + 1}
        </me>
      </p>
    </solution>
  </task>
  <task>
    <statement>
      <p>
        If <m>g(r,s) = rs\cos(r)</m>, find the partial derivatives <m>g_r</m> and <m>g_s</m>.
      </p>
    </statement>
    <answer>
      <p>
        <me>
          g_r(r,s) = -rs\sin(r) + s\cos(r)
        </me>
        and
        <me>
          g_s(r,s) = r\cos(r)
        </me>
      </p>
    </answer>
    <solution>
      <p>
        <me>
          g_r(r,s) = -rs\sin(r) + s\cos(r)
        </me>
        and
        <me>
          g_s(r,s) = r\cos(r)
        </me>
      </p>
    </solution>
  </task>
  <task>
    <statement>
      <p>
        Assuming <m>f(w,x,y) = (6w+1)\cos(3x^2+4xy^3+y)</m>, find the partial derivatives <m>f_w</m>, <m>f_x</m>, and <m>f_y</m>.
      </p>
    </statement>
    <answer>
      <p>
        <me>
          \frac{\partial f}{\partial w} = 6\cos(3x^2+4xy^3+y)
        </me>,
        <me>
          \frac{\partial f}{\partial x} = -(6w+1)\sin(3x^2+4xy^3+y)(6x+4y^3)
        </me>,
        and
        <me>
          \frac{\partial f}{\partial y} = -(6w+1)\sin(3x^2+4xy^3+y)(12xy^2+1)
        </me>
      </p>
    </answer>
    <solution>
      <p>
        <me>
          \frac{\partial f}{\partial w} = 6\cos(3x^2+4xy^3+y)
        </me>,
        <me>
          \frac{\partial f}{\partial x} = -(6w+1)\sin(3x^2+4xy^3+y)(6x+4y^3)
        </me>,
        and
        <me>
          \frac{\partial f}{\partial y} = -(6w+1)\sin(3x^2+4xy^3+y)(12xy^2+1)
        </me>
      </p>
    </solution>
  </task> 
  <task>
    <statement>
      <p>
        Find all possible first-order partial derivatives of <m>q(x,t,z) = \displaystyle \frac{x2^tz^3}{1+x^2}.</m>
      </p>
    </statement>
    <answer>
      <p>
        <me>
          q_x(x,t,z) = \frac{(1+x^2)(2^tz^3)-(x2^tz^3)(2x)}{(1+x^2)^2}
        </me>,
        <me>
          q_t(x,t,z) = \frac{1}{1+x^2}(x2^t\ln(2)z^3)
        </me>,
        and
        <me>
          q_z(x,t,z) = \frac{1}{1+x^2}(3x2^tz^2)
        </me>
      </p>
    </answer>
    <solution>
      <p>
        <me>
          q_x(x,t,z) = \frac{(1+x^2)(2^tz^3)-(x2^tz^3)(2x)}{(1+x^2)^2}
        </me>,
        <me>
          q_t(x,t,z) = \frac{1}{1+x^2}(x2^t\ln(2)z^3)
        </me>,
        and
        <me>
          q_z(x,t,z) = \frac{1}{1+x^2}(3x2^tz^2)
        </me>
      </p>
    </solution>
  </task>       
  </activity>
</subsection>
<subsection>
  <title>Interpretations of First-Order Partial Derivatives</title>
  <p>
    Recall that the derivative of a single variable function has a geometric interpretation as the slope of the line tangent to the graph at a given point. Similarly, we have seen that the partial derivatives measure the slope of a line tangent to a trace of a function of two variables as shown in <xref ref="F_10_2_trace_tangent">Figure</xref>.
  </p>
  <figure xml:id="F_10_2_trace_tangent">
    <caption>A surface given by <m>z=f(x,y)</m> with traces <m>y=b</m> (in red) and <m>x=a</m> (in blue)</caption>
    <interactive title="interactive-F_10_2_trace_tangent" platform="sage" width="85%" aspect="1:1.15">
      <slate surface="sage">
        <xi:include href="./interacts/trace_tangent_code.txt" parse="text"/>
      </slate>
    </interactive>
  </figure>
    <!-- <figure xml:id="F_10_2_trace_tangent">
      <caption>Tangent lines to two traces of the distance function.</caption>
      <sidebyside widths="50% 50%">
        <image source="images/fig_10_2_trace_tangent_y"/>
        <image source="images/fig_10_2_trace_tangent_x"/>
      </sidebyside>
    </figure> -->

    <p>
      We will finish this section by looking at the meaning of partial derivatives as they relate to average rates of change for a function. Recall that the difference quotient <m>\frac{f(a+h)-f(a)}{h}</m> for a function <m>f</m> of a single variable <m>x</m> at a point where <m>x=a</m> tells us the average rate of change of <m>f</m> over the interval <m>[a,a+h]</m>, while the derivative <m>f'(a)</m> tells us the instantaneous rate of change of <m>f</m> at <m>x=a</m>. We can use a similar relationship between limits of difference quotients and partial derivatives to provide context and meaning to partial derivatives as a measurement.  
    </p>

    <activity xml:id="A_10_2_11">
    <introduction>
      <p>
        The speed of sound <m>C</m> traveling through ocean water is a function of temperature, salinity and depth. It may be modeled by the function
          <md>
            <mrow> C \amp= 1449.2+4.6T-0.055T^2+0.00029T^3 </mrow>
            <mrow>   \amp \quad +(1.34-0.01T)(S-35)+0.016D </mrow>
          </md>
          Here <m>C</m> is the speed of sound in meters/second, <m>T</m> is the temperature in degrees Celsius, <m>S</m> is the salinity in grams/liter of water, and <m>D</m> is the depth below the ocean surface in meters.
      </p>
    </introduction>
    <task>
      <statement>
        <p>
          State the units for each of the partial derivatives, <m>C_T</m>, <m>C_S</m> and <m>C_D</m>, and explain the physical meaning of each partial derivative in terms of the rate of change for <m>C</m>.
        </p>
      </statement>
      <answer>
        <p>
          The partial derivative <m>C_T</m> is defined in terms of a change in <m>C</m> per change in <m>T</m>. So the units of <m>C_T</m> are units of <m>C</m> over units of <m>T</m>, or <m>\frac{\frac{\text{m} }{\text{ sec } }}{^{\circ}C}</m>. This partial <m>C_T</m> approximates how the speed of sound changes for every degree Celsius increase in the temperature of the water. Similarly, the units of <m>C_S</m> are <m>\frac{\frac{\text{m} }{\text{ sec } }}{\frac{g}{L}}</m>. This partial <m>C_S</m> approximates how the speed of sound changes for every gram per liter increase of the salinity of the water. Finally, the units of <m>C_D</m> are <m>\frac{\frac{\text{m} }{\text{ sec } }}{\text{m}}</m>. This partial <m>C_D</m> approximates how the speed of sound changes for every meter increase in depth below the ocean surface.
        </p>
      </answer>
      <solution>
        <p>
          The partial derivative <m>C_T</m> is defined in terms of a change in <m>C</m> per change in <m>T</m>. So the units of <m>C_T</m> are units of <m>C</m> over units of <m>T</m>, or <m>\frac{\frac{\text{m} }{\text{ sec } }}{^{\circ}C}</m>. This partial <m>C_T</m> approximates how the speed of sound changes for every degree Celsius increase in the temperature of the water. Similarly, the units of <m>C_S</m> are <m>\frac{\frac{\text{m} }{\text{ sec } }}{\frac{g}{L}}</m>. This partial <m>C_S</m> approximates how the speed of sound changes for every gram per liter increase of the salinity of the water. Finally, the units of <m>C_D</m> are <m>\frac{\frac{\text{m} }{\text{ sec } }}{\text{m}}</m>. This partial <m>C_D</m> approximates how the speed of sound changes for every meter increase in depth below the ocean surface.
        </p>
      </solution>
    </task>
    <task>
      <statement>
        <p>
          Use algebraic rules to find the partial derivatives <m>C_T</m>, <m>C_S</m> and <m>C_D</m>.
        </p>
      </statement>
      <answer>
        <p>
          Here we have
          <md>
            <mrow>C_T \amp = 4.6-0.11T+0.00087T^2-0.01(S-35)</mrow>
            <mrow>C_S \amp = 1.34-0.01T</mrow>
            <mrow>C_D \amp = 0.016</mrow>
          </md>
        </p>
      </answer>
      <solution>
        <p>
          Here we have
          <md>
            <mrow>C_T \amp = 4.6-0.11T+0.00087T^2-0.01(S-35)</mrow>
            <mrow>C_S \amp = 1.34-0.01T</mrow>
            <mrow>C_D \amp = 0.016</mrow>
          </md>
        </p>
      </solution>
    </task>
    <task>
      <statement>
        <p>
          Evaluate each of the three partial derivatives at the point where <m>T=10</m>, <m>S=35</m> and <m>D=100</m>. Write a few sentences to explain what the sign of each partial derivatives tell us about the behavior of the function <m>C</m> at the point <m>(10,35, 100)</m>.
        </p>
      </statement>
    <answer>
      <p>
        Evaluating the partial derivatives at the point (10,35,100) gives us
        <md>
          <mrow>C_T(10,35,100) \amp = 3.587</mrow>
          <mrow>C_S(10,35,100) \amp = 1.24</mrow>
          <mrow>C_D(10,35,100) \amp = 0.016</mrow>
        </md>.
        That <m>C_T(10,35,100)</m> is positive tells us that if we increase the temperature from <m>10^{\circ}C</m> while holding the salinity constant at 35 grams per liter and the depth constant at 100 meters, the speed of sound in the ocean increases. Similarly, the fact that <m>C_S(10,35,100)</m> is positive tells us that if we increase salinity from 35 grams per liter while holding the the temperature constant at <m>10^{\circ}C</m> and the depth constant at 100 meters, the speed of sound in the ocean increases. Also, the fact that <m>C_D(10,35,100)</m> is positive tells us that if we increase depth from 100 meters while holding the the temperature constant at <m>10^{\circ}C</m> and the salinity constant at 35 grams per liter, the speed of sound in the ocean increases.
      </p>
    </answer>
    <solution>
      <p>
        Evaluating the partial derivatives at the point (10,35,100) gives us
        <md>
          <mrow>C_T(10,35,100) \amp = 3.587</mrow>
          <mrow>C_S(10,35,100) \amp = 1.24</mrow>
          <mrow>C_D(10,35,100) \amp = 0.016</mrow>
        </md>.
        That <m>C_T(10,35,100)</m> is positive tells us that if we increase the temperature from <m>10^{\circ}C</m> while holding the salinity constant at 35 grams per liter and the depth constant at 100 meters, the speed of sound in the ocean increases. Similarly, the fact that <m>C_S(10,35,100)</m> is positive tells us that if we increase salinity from 35 grams per liter while holding the the temperature constant at <m>10^{\circ}C</m> and the depth constant at 100 meters, the speed of sound in the ocean increases. Also, the fact that <m>C_D(10,35,100)</m> is positive tells us that if we increase depth from 100 meters while holding the the temperature constant at <m>10^{\circ}C</m> and the salinity constant at 35 grams per liter, the speed of sound in the ocean increases.
      </p>
    </solution>
    </task>
  </activity>
</subsection>
<subsection>
  <title>Using Tables and Contour Plots to Estimate Partial Derivatives</title>
  <p>
    Remember that functions of two variables can be represented numerical or graphically as either a table of data or a contour plot. In single variable calculus, if we only know the value of the function at a few points, then we can use the difference quotient to approximate derivatives. The same idea applies to partial derivatives; we need to make sure we are holding other input variables constant when we compute the difference quotient. The next two activities are focused on the meaning of partial derivatives using a table as a numerical representation of a multivariable function (<xref ref="A_10_2_11" />) and using a contour plot as a graphical representation of a multivariable function (<xref ref="A_10_2_12"/>).
  </p>
  <activity xml:id="A_10_2_12">
    <introduction>
      <p>
        The wind chill, as frequently reported, is a measure of how cold it feels outside when the wind is blowing. In <xref ref="T_10_2_wind_chill">Table</xref>, the wind chill <m>w</m>, measured in degrees Fahrenheit, is a function of the wind speed <m>v</m>, measured in miles per hour, and the ambient air temperature <m>T</m>, also measured in degrees Fahrenheit. We thus view <m>w</m> as being of the form <m>w = w(v, T)</m>.
      </p>
      <table xml:id="T_10_2_wind_chill">
          <title>Wind chill as a function of wind speed and temperature</title>
          <tabular halign="center">
            <row>
              <cell><m>v \backslash T</m></cell>
              <!-- <cell bottom="medium"><m>-30</m></cell>
              <cell bottom="medium"><m>-25</m></cell> -->
              <cell bottom="medium"><m>-20</m></cell>
              <cell bottom="medium"><m>-15</m></cell>
              <cell bottom="medium"><m>-10</m></cell>
              <cell bottom="medium"><m>-5</m></cell>
              <cell bottom="medium"><m>0</m></cell>
              <cell bottom="medium"><m>5</m></cell>
              <cell bottom="medium"><m>10</m></cell>
             <!--  <cell bottom="medium"><m>15</m></cell>
              <cell bottom="medium"><m>20</m></cell> -->
            </row>
            <!-- <row>
              <cell right="medium"><m>5</m></cell>
              <cell><m>-46</m></cell>
              <cell><m>-40</m></cell>
              <cell><m>-34</m></cell>
              <cell><m>-28</m></cell>
              <cell><m>-22</m></cell>
              <cell><m>-16</m></cell>
              <cell><m>-11</m></cell>
              <cell><m>-5</m></cell>
              <cell><m>1</m></cell>
              <cell><m>7</m></cell>
              <cell><m>13</m></cell>
            </row> -->
            <row>
              <cell right="medium"><m>10</m></cell>
              <!-- <cell><m>-53</m></cell>
              <cell><m>-47</m></cell> -->
              <cell><m>-41</m></cell>
              <cell><m>-35</m></cell>
              <cell><m>-28</m></cell>
              <cell><m>-22</m></cell>
              <cell><m>-16</m></cell>
              <cell><m>-10</m></cell>
              <cell><m>-4</m></cell>
              <!-- <cell><m>3</m></cell>
              <cell><m>9</m></cell> -->
            </row>
            <row>
              <cell right="medium"><m>15</m></cell>
              <!-- <cell><m>-58</m></cell>
              <cell><m>-51</m></cell> -->
              <cell><m>-45</m></cell>
              <cell><m>-39</m></cell>
              <cell><m>-32</m></cell>
              <cell><m>-26</m></cell>
              <cell><m>-19</m></cell>
              <cell><m>-13</m></cell>
              <cell><m>-7</m></cell>
              <!-- <cell><m>0</m></cell>
              <cell><m>6</m></cell> -->
            </row>
            <row>
              <cell right="medium"><m>20</m></cell>
              <!-- <cell><m>-61</m></cell>
              <cell><m>-55</m></cell> -->
              <cell><m>-48</m></cell>
              <cell><m>-42</m></cell>
              <cell><m>-35</m></cell>
              <cell><m>-29</m></cell>
              <cell><m>-22</m></cell>
              <cell><m>-15</m></cell>
              <cell><m>-9</m></cell>
              <!-- <cell><m>-2</m></cell>
              <cell><m>4</m></cell> -->
            </row>
            <row>
              <cell right="medium"><m>25</m></cell>
              <!-- <cell><m>-64</m></cell>
              <cell><m>-58</m></cell> -->
              <cell><m>-51</m></cell>
              <cell><m>-44</m></cell>
              <cell><m>-37</m></cell>
              <cell><m>-31</m></cell>
              <cell><m>-24</m></cell>
              <cell><m>-17</m></cell>
              <cell><m>-11</m></cell>
              <!-- <cell><m>-4</m></cell>
              <cell><m>3</m></cell> -->
            </row>
            <row>
              <cell right="medium"><m>30</m></cell>
              <!-- <cell><m>-67</m></cell>
              <cell><m>-60</m></cell> -->
              <cell><m>-53</m></cell>
              <cell><m>-46</m></cell>
              <cell><m>-39</m></cell>
              <cell><m>-33</m></cell>
              <cell><m>-26</m></cell>
              <cell><m>-19</m></cell>
              <cell><m>-12</m></cell>
             <!--  <cell><m>-5</m></cell>
              <cell><m>1</m></cell> -->
            </row>
            <row>
              <cell right="medium"><m>35</m></cell>
              <!-- <cell><m>-69</m></cell>
              <cell><m>-62</m></cell> -->
              <cell><m>-55</m></cell>
              <cell><m>-48</m></cell>
              <cell><m>-41</m></cell>
              <cell><m>-34</m></cell>
              <cell><m>-27</m></cell>
              <cell><m>-21</m></cell>
              <cell><m>-14</m></cell>
              <!-- <cell><m>-7</m></cell>
              <cell><m>0</m></cell> -->
            </row>
            <!-- <row>
              <cell right="medium"><m>40</m></cell>
              <cell><m>-71</m></cell>
              <cell><m>-64</m></cell>
              <cell><m>-57</m></cell>
              <cell><m>-50</m></cell>
              <cell><m>-43</m></cell>
              <cell><m>-36</m></cell>
              <cell><m>-29</m></cell>
              <cell><m>-22</m></cell>
              <cell><m>-15</m></cell>
              <cell><m>-8</m></cell>
              <cell><m>-1</m></cell>
            </row> -->
          </tabular>
        </table>
    </introduction>
    <task>
      <statement>
        <p>
          Do you think <m>w_v</m>, the partial derivative with respect to wind speed, is positive, negative, or zero at <m>(v,T)=(20,-10)</m>? Write a couple of sentences to justify why you think the partial derivative is +/-/0 and remember to pay attention to which variable will be changing and which variable will be constant. 
        </p>
      </statement>
    </task>
    <answer>
      <p>
        Negative
      </p>
    </answer>
    <solution>
      <p>
        For an increase in wind speed of 5 (going from 20 to 25) while holding the ambient temperature constant at -10, there is a decrease of 2 degrees in the wind chill. Physically this makes sense as well; if you have the same ambient temperature and increase wind speed, then you will feel colder.
      </p>
    </solution>
    <task>
      <statement>
        <p>
          Do you think <m>w_T</m>, the partial derivative with respect to wind speed, is positive, negative, or zero at <m>(v,T)=(20,-10)</m>? Write a couple of sentences to justify why you think the partial derivative is +/-/0 and remember to pay attention to which variable will be changing and which variable will be constant. 
        </p>
      </statement>
      <answer>
      <p>
        Positive
      </p>
    </answer>
    <solution>
      <p>
        For an increase in the ambient temperature (going from -10 to -5) while holding the wind speed constant at 20, there is a increase of 6 degrees in the wind chill. Physically this makes sense as well; if you have the same wind speed and increase the ambient temperature, then you will feel warmer.
      </p>
    </solution>
    </task>
    <task>
      <statement>
        <p>
          Estimate the partial derivative <m>w_v(20,-10)</m>.  What are the units on this quantity and what does it mean? (Recall that we can estimate a partial derivative of a single variable function <m>f</m> using the symmetric difference quotient <m>\frac{f(x+h)-f(x-h)}{2h}</m> for small values of <m>h</m>. A partial derivative is a derivative of an appropriate trace.) 
        </p>
      </statement>
      <answer>
        <p>
          Recall that
          <me>
            w_v(v,T) = \lim_{h \to 0} \frac{w(v+h,T) - w(v,T)}{h}
          </me>,
          which gives us the slope of the tangent line to the trace in the <m>v</m> direction. We can approximate this slope with the slope of a secant line, choosing points equally spaced on both sides of <m>(v,T)</m>. In other words,
          <me>
            w_v(v,T) \approx \frac{w(v+h,T) - w(v-h,T)}{2h}
          </me>,
          for small values of <m>h</m>. This is the symmetric difference quotient from calculus 1. The data in our table allows us to use <m>h=5</m> for wind speed, so
          <me>
            w_v(20,-10) \approx \frac{w(25,-10)-w(15,-10)}{10} = \frac{-37-(-32)}{10} = -\frac{1}{2}
          </me>
          degrees Fahrenheit per mile per hour. So for every one mile per hour increase in the wind speed from 20 miles per hour, while holding the air temperature constant at <m>-10^{\circ}F</m>, the wind chill decreases by approximately 0.5 <m>^{\circ}F</m>.
        </p>
      </answer>
      <solution>
        <p>
          Recall that
          <me>
            w_v(v,T) = \lim_{h \to 0} \frac{w(v+h,T) - w(v,T)}{h}
          </me>,
          which gives us the slope of the tangent line to the trace in the <m>v</m> direction. We can approximate this slope with the slope of a secant line, choosing points equally spaced on both sides of <m>(v,T)</m>. In other words,
          <me>
            w_v(v,T) \approx \frac{w(v+h,T) - w(v-h,T)}{2h}
          </me>,
          for small values of <m>h</m>. This is the symmetric difference quotient from calculus 1. The data in our table allows us to use <m>h=5</m> for wind speed, so
          <me>
            w_v(20,-10) \approx \frac{w(25,-10)-w(15,-10)}{10} = \frac{-37-(-32)}{10} = -\frac{1}{2}
          </me>
          degrees Fahrenheit per mile per hour. So for every one mile per hour increase in the wind speed from 20 miles per hour, while holding the air temperature constant at <m>-10^{\circ}F</m>, the wind chill decreases by approximately 0.5 <m>^{\circ}F</m>.
        </p>
      </solution>
    </task>
    <task>
      <statement>
        <p>
          Estimate the partial derivative <m>w_T(20,-10)</m>.  What are the units on this quantity and what does it mean?
        </p>
      </statement>
      <answer>
        <p>
          We approximate <m>w_T(20,-10)</m> in the same way, using <m>h=5</m> again. So,
          <me>
            w_T(20,-10) \approx \frac{w(20,-5)-w(20,-15)}{10} = \frac{-29-(-42)}{10} = 1.3
          </me>
          degrees Fahrenheit per degree Fahrenheit. So for every one degree Fahrenheit increase in the wind temperature <m>-10^{\circ}F</m>, while holding the wind speed constant at 20 miles per hour, the wind chill increases by approximately 1.3 <m>^{\circ}F</m>.
        </p>
      </answer>
      <solution>
        <p>
          We approximate <m>w_T(20,-10)</m> in the same way, using <m>h=5</m> again. So,
          <me>
            w_T(20,-10) \approx \frac{w(20,-5)-w(20,-15)}{10} = \frac{-29-(-42)}{10} = 1.3
          </me>
          degrees Fahrenheit per degree Fahrenheit. So for every one degree Fahrenheit increase in the wind temperature <m>-10^{\circ}F</m>, while holding the wind speed constant at 20 miles per hour, the wind chill increases by approximately 1.3 <m>^{\circ}F</m>.
        </p>
      </solution>
    </task>
    <task>
      <statement>
        <p>
          Use your results to estimate the wind chill <m>w(18, -10)</m>. (Recall from single variable calculus that for a function <m>f</m> of <m>x</m>, <m>f(x+h) \approx f(x) + hf'(x)</m>.)
        </p>
      </statement>
      <answer>
        <p>
          This is just like a linearization from calculus 1 along the trace with <m>T=-10</m>. We found the slope of the tangent line to the <m>T=-10</m> trace of <m>w</m> at the point <m>(20,-10)</m> to be <m>-0.5</m>, so
          <me>
            w(18,-10) \approx  w(20,-10) - 0.5(18-20) = -35 + 1 = -34
          </me>.
        </p>
      </answer>
      <solution>
        <p>
          This is just like a linearization from calculus 1 along the trace with <m>T=-10</m>. We found the slope of the tangent line to the <m>T=-10</m> trace of <m>w</m> at the point <m>(20,-10)</m> to be <m>-0.5</m>, so
          <me>
            w(18,-10) \approx  w(20,-10) - 0.5(18-20) = -35 + 1 = -34
          </me>.
        </p>
      </solution>
    </task>
    <task>
      <statement>
        <p>
          Use your results to estimate the wind chill <m>w(20, -12)</m>.
        </p>
      </statement>
      <answer>
        <p>
          This is just like a linearization from calculus 1 along the trace with <m>v=20</m>. We found the slope of the tangent line to the <m>v=20</m> trace of <m>w</m> at the point <m>(20,-10)</m> to be <m>1.3</m>, so
          <me>
            w(20,-12) \approx  w(20,-10) + 1.3(-12-(-10)) = -35 - 2.6 = -37.6
          </me>.
        </p>
      </answer>
      <solution>
        <p>
          This is just like a linearization from calculus 1 along the trace with <m>v=20</m>. We found the slope of the tangent line to the <m>v=20</m> trace of <m>w</m> at the point <m>(20,-10)</m> to be <m>1.3</m>, so
          <me>
            w(20,-12) \approx  w(20,-10) + 1.3(-12-(-10)) = -35 - 2.6 = -37.6
          </me>.
        </p>
      </solution>
    </task>
    <task>
      <statement>
        <p>
          Consider how you might combine your previous results to estimate the wind chill <m>w(18, -12)</m>. Explain your process. 
        </p>
      </statement>
      <answer>
        <p>
          We might expect that the total change in <m>w</m> will be calculated by using the changes in <m>w</m> that arise from changing both the <m>v</m> and <m>T</m> coordinates. In other words,
          <me>
            w(18,-12) \approx w(20,-10) - 0.5(18-20) + 1.3(-12-(-10)) = -35 + 1 - 2.6 = -36.6
          </me>.
        </p>
      </answer>
      <solution>
        <p>
          We might expect that the total change in <m>w</m> will be calculated by using the changes in <m>w</m> that arise from changing both the <m>v</m> and <m>T</m> coordinates. In other words,
          <me>
            w(18,-12) \approx w(20,-10) - 0.5(18-20) + 1.3(-12-(-10)) = -35 + 1 - 2.6 = -36.6
          </me>.
        </p>
      </solution>
    </task>
  </activity>
  <activity xml:id="A_10_2_13">
    <introduction>
      <p>
        Shown below in <xref ref="F_10_2_activity_contour">Figure</xref> is a contour plot of a function <m>f</m>. The values of the function on a few of the contours are indicated to the left of the figure.
      </p>
      <!-- <figure xml:id="F_10_2_activity_contour">
        <caption>A contour plot of <m>f</m>.</caption>
        <image width="50%" source="images/fig_10_2_activity_contours"/>
      </figure> -->
      <figure xml:id="F_10_2_activity_contour">
        <caption>A plot of <m>f(t)=M(0.03,t)</m></caption>
        <image width="50%" xml:id="img-F_10_2_activity_contour">
          <sageplot>
            var('x,y,z')
            g(x,y)=(cos(pi/5.5)*x+sin(pi/5.5)*y-2)*(-sin(pi/5.5)*x+cos(pi/5.5)*y-1)/2
            c=[i for i in range(-3,9)]
            plot12=contour_plot(g(x,y),(x,-3,3),(y,-3,3),contours=c,fill=false,gridlines=True,labels=True,label_fmt="%1.0f",axes_labels=["$x$","$y$"],label_inline=True,linewidths=2,axes=True,frame=False)
            plot12
          </sageplot>
        </image>
      </figure>
    </introduction>
    <task>
      <statement>
        <p>
          Estimate the partial derivative <m>f_x(-2,-1)</m>. (Hint: How can you find values of <m>f</m> that are of the form <m>f(-2+h)</m> and <m>f(-2-h)</m> so that you can use a symmetric difference quotient?)
        </p>
      </statement>
      <answer>
        <p>
          Using <m>h=1</m> and approximating values from the contour plot gives us
          <me>
            f_x(-2, -1) \approx \frac{f(-1,-1)-f(-3,-1)}{2} \approx \frac{4.5-2.9}{2} = 0.8
          </me>.
        </p>
      </answer>
      <solution>
        <p>
          Using <m>h=1</m> and approximating values from the contour plot gives us
          <me>
            f_x(-2, -1) \approx \frac{f(-1,-1)-f(-3,-1)}{2} \approx \frac{4.5-2.9}{2} = 0.8
          </me>.
        </p>
      </solution>
    </task>
    <task>
      <statement>
        <p>
          Estimate the partial derivative <m>f_y(-2,-1)</m>.
        </p>
      </statement>
      <answer>
        <p>
          We approximate <m>f_y(-2,-1)</m> in the same way, using <m>h=1</m> again. So
          <me>
            f_y(-2,-1) \approx \frac{f(-2,0)-f(-2,-2)}{2} \approx \frac{2.4-6}{2} = -1.8
          </me>.
        </p>
      </answer>
      <solution>
        <p>
          We approximate <m>f_y(-2,-1)</m> in the same way, using <m>h=1</m> again. So
          <me>
            f_y(-2,-1) \approx \frac{f(-2,0)-f(-2,-2)}{2} \approx \frac{2.4-6}{2} = -1.8
          </me>.
        </p>
      </solution>
    </task>
    <task>
      <statement>
        <p>
          Estimate the partial derivatives <m>f_x(-1,2)</m> and <m>f_y(-1,2)</m>.
        </p>
      </statement>
      <answer>
        <p>
          As above,
          <md>
            <mrow>f_x(-1,2) \amp \approx \frac{f(0,2)-f(-2,2)}{2} \approx \frac{3-0.8}{2} = 1.1</mrow>
            <mrow>f_y(-1,2) \amp \approx \frac{f(-1,3)-f(-1,1)}{2} \approx \frac{2.1-2.3}{2} = -0.1</mrow>
          </md>.
        </p>
      </answer>
      <solution>
        <p>
          As above,
          <md>
            <mrow>f_x(-1,2) \amp \approx \frac{f(0,2)-f(-2,2)}{2} \approx \frac{3-0.8}{2} = 1.1</mrow>
            <mrow>f_y(-1,2) \amp \approx \frac{f(-1,3)-f(-1,1)}{2} \approx \frac{2.1-2.3}{2} = -0.1</mrow>
          </md>.
        </p>
      </solution>
    </task>
    <task>
      <statement>
        <p>
          Locate, if possible, one point <m>(x,y)</m> where <m>f_x(x,y)= 0</m>.
        </p>
      </statement>
      <answer>
        <p>
          A point at which <m>f_x(x,y) = 0</m> will occur when we have a horizontal tangent line. Such a point occurs near <m>(0,-0.5)</m>.
        </p>
      </answer>
      <solution>
        <p>
          A point at which <m>f_x(x,y) = 0</m> will occur when we have a horizontal tangent line. Such a point occurs near <m>(0,-0.5)</m>.
        </p>
      </solution>
    </task>
    <task>
      <statement>
        <p>
          Locate, if possible, one point <m>(x,y)</m> where <m>f_x(x,y)\lt 0</m>.
        </p>
      </statement>
      <answer>
        <p>
          We want a point at which <m>f</m> is decreasing in the <m>x</m>-direction. Such a point is <m>(2,-2)</m>.
        </p>
      </answer>
      <solution>
        <p>
          We want a point at which <m>f</m> is decreasing in the <m>x</m>-direction. Such a point is <m>(2,-2)</m>.
        </p>
      </solution>
    </task>
    <task>
      <statement>
        <p>
          Locate, if possible, one point <m>(x,y)</m> where <m>f_y(x,y)&gt;0</m>.
        </p>
      </statement>
      <answer>
        <p>
          We want a point at which <m>f</m> is increasing in the <m>y</m>-direction. Such a point is <m>(-1.2,-1)</m>.
        </p>
      </answer>
      <solution>
        <p>
          We want a point at which <m>f</m> is increasing in the <m>y</m>-direction. Such a point is <m>(-1.2,-1)</m>.
        </p>
      </solution>
    </task>    
          <!-- <li>
            <p>
              Suppose you have a different function <m>g</m>, and you know that <m>g(2,2) =
                4</m>, <m>g_x(2,2) &gt; 0</m>, and <m>g_y(2,2) &gt; 0</m>.  Using this information,
                sketch a possibility for the contour <m>g(x,y)=4</m> passing through
                <m>(2,2)</m> on the left side of <xref ref="F_10_2_activity_grad">Figure</xref>.  Then
                include possible contours <m>g(x,y) = 3</m> and <m>g(x,y) = 5</m>.

              <figure xml:id="F_10_2_activity_grad">
                <caption>Plots for contours of <m>g</m> and <m>h</m>.</caption>
                <sidebyside widths="50% 50%">
                <image source="images/fig_10_2_activity_grad"/>
                <image source="images/fig_10_2_activity_grad"/>
                </sidebyside>
              </figure>

            </p>
          </li>

          <li>
            <p>
              Suppose you have yet another function <m>h</m>, and you know that <m>h(2,2) =
                4</m>, <m>h_x(2,2) \lt  0</m>, and <m>h_y(2,2) &gt; 0</m>.  Using this information,
                sketch a possible contour <m>h(x,y)=4</m> passing through
                <m>(2,2)</m> on the right side of <xref ref="F_10_2_activity_grad">Figure</xref>.
                Then include possible contours <m>h(x,y) = 3</m> and <m>h(x,y) = 5</m>.
            </p>
          </li>
        </ol>
      </statement> -->

    </activity>
  <p>
    Before we end this section, we will talk about a few ideas that were not necessary to understand and motivate the first partial derivatives, but will be important when we look at measuring or approximating the rate of change in other directions. In particular, we did not need to use our classic calculus approach to define the partial derivative because we restricted our two variable function along a trace to be a single variable function. This was extremely convenient but we will need new tools to make similar arguments in any other direction (that is not along a trace like <m>x=a</m> or <m>y=b</m>). 
  </p>
  <p>
    The approximations, algebraic rules, and interpretations for partial derivatives are the same as in single variable calculus. Additionally, the form of the difference quotients and limit definition for partial derivatives maintains the same form as in single variable calculus and for <xref ref="changeform" text="custom">vector-valued functions of one variable</xref>:
    <me> \text{rate of change}= \lim \frac{\text{change in output of function}}{\text{change in input of function}}</me>
    Again, conveniently all of the change we look at with a partial derivative is in a single input variable (holding all other input variables constant).
  </p>

  </subsection>


  <subsection>
    <title>Summary</title>
    <ul>
      <li>
        <p>
          If <m>f=f(x,y)</m> is a function of two variables, there are two first order partial derivatives of <m>f</m>: the partial derivative of <m>f</m> with respect to <m>x</m>,
          <me>
            \frac{\partial f}{\partial x}(x,y) = f_x(x,y) = \lim_{h \to 0} \frac{f(x+h,y) - f(x,y)}{h}
          </me>
          and the partial derivative of <m>f</m> with respect to <m>y</m>
          <me>
            \frac{\partial f}{\partial y}(x,y) = f_y(x,y) = \lim_{h \to 0} \frac{f(x,y+h) - f(x,y)}{h},
          </me>
          where each partial derivative exists only at those points <m>(x,y)</m> for which the limit exists.
        </p>
      </li>
      <li>
        <p>
          The partial derivative <m>f_x(a,b)</m> tells us the instantaneous rate of change of <m>f</m> with respect to <m>x</m> at <m>(x,y) = (a,b)</m> when <m>y</m> is fixed at <m>b</m>.  Geometrically, the partial derivative <m>f_x(a,b)</m> tells us the slope of the line tangent to the <m>y=b</m> trace of the function <m>f</m> at the point <m>(a,b,f(a,b))</m>.
        </p>
      </li>
      <li>
        <p>
          The partial derivative <m>f_y(a,b)</m> tells us the instantaneous rate of change of <m>f</m> with respect to <m>y</m> at <m>(x,y) = (a,b)</m> when <m>x</m> is fixed at <m>a</m>.  Geometrically, the partial derivative <m>f_y(a,b)</m> tells us the slope of the line tangent to the <m>x=a</m> trace of the function <m>f</m> at the point <m>(a,b,f(a,b))</m>.
        </p>
      </li>
    </ul>

    </subsection>
    <xi:include href="./exercises/ez-S_mv_first_partials.ptx" />
    
</section>
