<?xml version="1.0"?>
<!-- **********************************************************************-->
<!-- Copyright 2013-2025                                                   -->
<!-- Nicholas Long, Mitchel Keller, Steven Schlicker                       -->
<!--                                                                       -->
<!-- This file is part of Active Calculus Multivariable.                   -->
<!--                                                                       -->
<!-- Permission is granted to copy, distribute and/or modify this document -->
<!-- under the terms of the Creative Commons BY-NC-SA license.  The work   -->
<!-- may be used for free by any party so long as attribution is given to  -->
<!-- the author(s), the work and its derivatives are used in the spirit of -->
<!-- "share and share alike"; no party may sell this work or any of its    -->
<!-- derivatives for profit.  All trademarks are the registered marks of   -->
<!-- their respective owners.                                              -->
<!-- **********************************************************************-->
<section xml:id="S-VVF-Curvature" xmlns:xi="http://www.w3.org/2001/XInclude">
  <title>Curvature</title>
  <objectives>
      <ul>
        <li>
          <p>
            How can you measure how fast a path is turning (regardless of the parameterization)?
          </p>
        </li>

        <li>
          <p>
            What is the radius of curvature for a path at a given location?
          </p>
        </li>
      </ul>
  </objectives>
<subsection>
  <title>Introduction</title>
    <p>
      In <xref ref="S-VVF-TNB" />, we defined <m>\vT</m> and <m>\vN</m> to measure the direction of travel and the direction of turning for an oriented curve in space. Both <m>\vT</m> and <m>\vN</m> are unit vectors that are used to capture <em>direction</em> aspects of motion. In the next couple of sections, we will look at a few different ways to measure the <em>magnitude</em> of various aspects of our motion and turning on a curve in space. 
    </p>
    <p>
      Given a parameterization of a curve in space, the speed will give us an idea about how fast an object moves <em>along the curve</em> at any given parameter value. We learned in the previous section that <m>\vN</m> tells us the <em>direction of turning</em>, but we have not yet developed a way to measure <em>how much turning</em> is happening at a given location. For example, consider the three curves shown in <xref ref="fig-VVF-curvature-3-curves"/>. We would like to be able to measure how much turning is happening at the indicated point on each curve. Right now, you probably intuitively would say there is no turning in the first curve, a small amount in the second, and considerably more in the third. However, how can we assign a number to measure this amount of turning?
    </p>
    <figure xml:id="fig-VVF-curvature-3-curves">
      <caption>Three curves demonstrating variation in amount of turning</caption>
      <sidebyside widths="30% 30% 30%">
        <image>
          <shortdescription>A straight line</shortdescription>
          <prefigure xmlns="https://prefigure.org"
                     label="img-VVF-curvature-line">
            <diagram dimensions="(180,180)" margins="5">
              <definition>f(x)=2*x-0.75</definition>
              <coordinates bbox="(-4,-4,4,4)">
                <graph function="f"/>
                <point p="(1.1,f(1.1))" />
              </coordinates>
            </diagram>                     
          </prefigure>
        </image>
        <image>
          <shortdescription>An arc with gentle curving</shortdescription>
          <prefigure xmlns="https://prefigure.org"
                     label="img-VVF-curvature-ellipse-arc">
            <diagram dimensions="(180, 180)" margins="5">
              <definition>f(t) = (3.9*cos(t) , 8*sin(t))</definition>
              <coordinates bbox="[-4,-4,4,4]">
                <parametric-curve function="f" domain="[-pi/3,pi/3]" stroke="blue" />
                <point p="f(0)" />
              </coordinates>
            </diagram>                   
          </prefigure>
        </image>
        <image>
          <shortdescription>An arc of a circle of small radius</shortdescription>
          <prefigure xmlns="https://prefigure.org"
                     label="img-VVF-curvature-small-circle">
            <diagram dimensions="(180, 180)" margins="5">
              <definition>f(t) = (2*cos(t) , 2*sin(t))</definition>
              <coordinates bbox="[-4,-4,4,4]">
                <parametric-curve function="f" domain="[pi/2,pi]" stroke="blue" />
                <point p="f(5*pi/6)" />
              </coordinates>
            </diagram>                   
          </prefigure>
        </image>
      </sidebyside>
    </figure>
    <p>  
      In this section, we focus on measuring how quickly <em>a curve</em> is turning. Keeping our running example in mind, we can think of this as measuring a property of <em>the road</em>. How quickly a curve is turning is a different measurement from how fast <em>an object</em> is turning as it moves along a path. That is a property of <em>the driver</em> to which we will return in <xref ref="S-VVF-Spliting-Acceleration" />.
    </p>
    <worksheet>
  <exploration
>
      <introduction>
        <p>
          As Chief Engineer and CEO at <em>Steer Clear</em>, you have done great work in transforming information from your location tracking system (LTS) into information on the position, velocity, and distance traveled by your car. In order to make the <q>self-driving</q> part of the self-driving car, you will need to compare information from the LTS (which describes how your car is moving) to GPS location data for the network of roads (which describe the paths your car should be taking). Since everyone on the road drives differently, you realize that you need to measure how quickly a stretch of road is turning in different places, which leads you to contact a friend who is a civil engineer for help understanding highway construction specifications.
          <!-- This measurement should not depend on the particular driver but should be a property of the path the road takes. Remember that your car cannot look forward in time to see how it will need to turn, but the car can look forward along the road to see how the path changes. -->
        </p>
      </introduction>
      <task>
        <statement>
          <p>
            <xref ref="PA-curvatureplot1" /> shows a map of a section of road on your testing route for your self-driving car with points labeled <m>P_0</m> and <m>P_1</m> which are 10 meters apart (along the road). Draw a vector in the direction of travel at both <m>P_0</m> and <m>P_1</m>. Use these vectors to describe how the direction of travel is changing along the path from <m>P_0</m> to <m>P_1</m>.
          </p>
          <figure xml:id="PA-curvatureplot1">
            <caption>A plot of the section of road with points <m>P_0</m> and <m>P_1</m> separated by 10 meters</caption>
            <image width="75%">
              <shortdescription>A 2D curve with two points marked</shortdescription>
              <description><p>A two-dimensional curve with points <m>P_0</m> and <m>P_1</m> labeled </p></description>
              <sageplot label="img-curvatureplot1">
                tpoints=[0.9,1.3]
                offsetx=[0.1,-0.1]
                offsety=[-0.2,-0.2]
                labels=["$P_0$","$P_1$"]
                var('t');
                r1(t)=((t^2/15+2)*cos(t),(1.5-t/12)*sin(t))
                plot1=parametric_plot(r1(t),(t,0.5,4),aspect_ratio=1,color='black',thickness=2,axes=False)
                plot1+=arrow(r1(2),r1(2.01),color="black")
                for i in range(len(tpoints)):
                    position=r1(tpoints[i])
                    withoffset=(position[0]+offsetx[i],position[1]+offsety[i])
                    plot1+=point([position],color='black',size=50)+text(labels[i],withoffset,fontsize=24,color='black')
                plot1
              </sageplot>
            </image>
          </figure>
        </statement>
      </task>
      <task>
        <statement>
          <p>
            <xref ref="PA-curvatureplot2" /> shows a map of a section of road on your testing route for your self-driving car with points labeled <m>Q_0</m> and <m>Q_1</m> which are 10 meters apart (along the road). Draw a vector in the direction of travel at both <m>Q_0</m> and <m>Q_1</m>. Use these vectors to describe how the direction of travel is changing along the path from <m>Q_0</m> to <m>Q_1</m>.
          </p>
          <figure xml:id="PA-curvatureplot2">
            <caption> A plot of the section of road with points <m>Q_0</m> and <m>Q_1</m> separated by 10 meters</caption>
            <image width="75%">
              <shortdescription>A 2D curve with two points marked</shortdescription>
              <description><p>A two-dimensional curve with points <m>Q_0</m> and <m>Q_1</m> labeled </p></description>
              <sageplot label="img-curvatureplot2">
                tpoints=[3,3.4]
                offsetx=[-0.1,-0.2]
                offsety=[0.2,0.1]
                labels=["$Q_0$","$Q_1$"]
                var('t');
                r1(t)=((t^2/15+2)*cos(t),(1.5-t/12)*sin(t))
                plot2=parametric_plot(r1(t),(t,0.5,4),aspect_ratio=1,color='black',thickness=2,axes=False)
                plot2+=arrow(r1(2),r1(2.01),color="black")
                for i in range(len(tpoints)):
                    position=r1(tpoints[i])
                    withoffset=(position[0]+offsetx[i],position[1]+offsety[i])
                    plot2+=point([position],color='black',size=50)+text(labels[i],withoffset,fontsize=24,color='black')
                plot2
              </sageplot>
            </image>
          </figure>
        </statement>
      </task>
      <task>
        <statement>
          <p>
            Is the direction of travel changing faster over the path from <m>P_0</m> to <m>P_1</m> or over the path from <m>Q_0</m> to <m>Q_1</m>. Write a few sentences to explain your reasoning and connect to your arguments and plots for the first two tasks.
          </p>
        </statement>
      </task>
      <!-- <task>
        <statement>
          <p>
            Let <m>P_2</m> be the point on the path that is 5 meters ahead of <m>P_0</m> and <m>Q_2</m> be the point on the path that is 5 meters ahead of <m>Q_0</m>. Draw the points <m>P_2</m> and <m>Q_2</m> on your plots above. Is the direction of travel changing faster over the path from <m>P_0</m> to <m>P_2</m> or to the path from <m>Q_0</m> to <m>Q_2</m>? Explain your reasoning and compare your answer to the previous question.
          </p>
        </statement>
      </task> -->
    </exploration>
</worksheet>
    <p>
      The Preview Activity showed how looking at the change in <m>\vT</m>, the direction of travel, for small steps in terms of arc length along our curve will allow us to measure the rate at which a curve is turning. This is different than measuring how quickly an object traveling along the path needs to turn in order to stay on the path. The arguments in the Preview Activity depend only on intrinsic geometric properties of the path (road) rather than how an object (car) moves along that path.
    </p>
  </subsection>
  <subsection>
    <title>Curvature</title>
    <p>
      Hopefully it is not surprising that the unit speed parameterization of a curve <m>\vr_1(s)</m>. One way to think about this is that if two drivers follow the same path, each at a speed of exactly 1 meter per second, then for any point on the path, the two drivers both reach that point in the same amount of time. For instance, it will take both drivers exactly 15 seconds to reach the point that is 15 meters down the path. (Remember the most useful property of a unit speed parameterization is that the parameter value for <m>\vr_1</m> is equal to the numeric value of the distance traveled along the curve, albeit with different units.) Conceptually, you can see how using the unit speed parameterization allows us to measure geometric properties of the curve independent of how an object moves along the path.
    </p>
    <p>
      We have already explored how <m>\vN</m> points in the direction of turning. Now, however, we are looking for a <em>scalar</em> quantity that measures <em>how quickly</em> a curve turns. To measure how quickly a path turns, we examine how quickly the direction of travel changes in terms of the unit speed parameterization. We apply the classic calculus approach to this measurement in order to obtain the exact value of this measurement. Suppose <m>\vr_1(s)</m> is the unit speed parameterization of a curve <m>C</m> and consider a section of <m>C</m> from <m>\vr_1(s_0)</m> to <m>\vr_1(s_0+\Delta s)</m>. We first consider how different the direction of travel is over this curve of length <m>\Delta s</m>. (Remember, the change in parameter value here corresponds to the arc length along the curve because <m>\vr_1</m> is a unit speed parameterization.) A plot a sample curve and two points separated by an arc length of <m>\Delta s</m> is shown in <xref ref="curvatureplot7" />.
      
    </p> 
    <figure xml:id="curvatureplot7">
      <caption> A plot of a curve with <m>\vT</m> shown for two points</caption>
      <image width="45%">
        <shortdescription>A parameterized curve with two points and unit tangent vectors</shortdescription>
        <description><p>A two-dimensional curve with points corresponding to the tips of <m>\vr_1(s_0)</m> and <m>\vr_1(s_0+\Delta s)</m> marked. Also depictred are the unit tangent vectors to the curve at these points.</p></description>
        <sageplot label="img-curvatureplot7">
          tpoints=[3.1,3.4]
          offsetx=[0.2,0.35]
          offsety=[0,0]
          labels=["$\\vec{r}_1(s_0)$","$\\vec{r}_1(s_0+\\Delta s)$"]
          vlabels=["$\\vec{T}(s_0)$","$\\vec{T}(s_0+\\Delta s)$"]
          var('t');
          r1(t)=((t^2/15+2)*cos(t),(1.5-t/12)*sin(t))
          v1(t)=diff(r1,t)
          T(t)=v1(t)/norm(v1(t))
          plot7=parametric_plot(r1(t),(t,3,4),aspect_ratio=1,color='black',thickness=2,axes=False)
          for i in range(len(tpoints)):
              position=r1(tpoints[i])
              withoffset=(position[0]+offsetx[i],position[1]+offsety[i])
              voffset=(position[0]+(T(tpoints[i])[0])/1.2-0.15-0.15*i,position[1]+(T(tpoints[i])[1])/1.2)
              plot7+=point([position],color='black',size=50)+text(labels[i],withoffset,fontsize=20,color='black')
              plot7+=arrow(r1(tpoints[i]),r1(tpoints[i])+T(tpoints[i]),color="blue")
              plot7+=text(vlabels[i],voffset,color="blue",fontsize=15)
          plot7
        </sageplot>
      </image>
    </figure>
    <p>
      We want to know how fast the direction of travel is changing at the point <m>\vr_1(s_0)</m>. To do this, we approximate the change in the direction of travel on an interval around this point and take the limit as the size of the interval goes to zero. We compute the difference between the directions of travel at the beginning and end of our interval by putting both <m>\vT(s_0+\Delta s)</m> and <m>\vT(s_0)</m> starting at the same location. This allows us to use vector subtraction to find <m>\vT(s_0+\Delta s)-\vT(s_0)</m>, which is the change in the direction of travel over the given interval. This vector subtraction is shown using the triangle of vectors in <xref ref="curvatureplot3" />.
    </p>
    <figure xml:id="curvatureplot3">
      <caption> A plot of a curve with <m>\vT</m> shown for two points</caption>
      <image width="45%">
        <shortdescription>Unit tangent vectors and the vector between their tips</shortdescription>
        <description><p>The unit tangent vectors from <xref ref="curvatureplot7"/> drawn with their initial points at the same location. The vector <m>\vT(s_0+\Delta s)-\vT(s_0)</m> pointing from the tip of <m>\vT(s_0)</m> to the tip of <m>\vT(s_0+\Delta s)</m> is also shown.</p></description>
        <sageplot label="img-curvatureplot3">
          tpoints=[3.1,3.4]
          offsetx=[0.2,0.35]
          offsety=[0,0]
          labels=["$\\vec{r}_1(s_0)$","$\\vec{r}_1(s_0+\\Delta s)$"]
          vlabels=["$\\vec{T}(s_0)$","$\\vec{T}(s_0+\\Delta s)$"]
          var('t');
          r1(t)=((t^2/15+2)*cos(t),(1.5-t/12)*sin(t))
          v1(t)=diff(r1,t)
          T(t)=v1(t)/norm(v1(t))
          plot3=text("$\\vec{T}(s_0+\\Delta s)-\\vec{T}(s_0)$",((T(3.1)[0]-4+T(3.4)[0]-4)/2,(T(3.1)[1]+T(3.4)[1])/2-0.1),color="red",fontsize=15,aspect_ratio=1,axes=False)
          for i in range(len(tpoints)):
              position=r1(tpoints[i])
              withoffset=(position[0]+offsetx[i],position[1]+offsety[i])
              voffset=(position[0]+(T(tpoints[i])[0])/1.2-0.15-0.15*i,position[1]+(T(tpoints[i])[1])/1.2)
              vvoffset=(-4+(T(tpoints[i])[0])/2-0.15+0.45*i,(T(tpoints[i])[1])/2)
              plot3+=arrow((-4,0),(T(tpoints[i])[0]-4,T(tpoints[i])[1]),color="blue")
              plot3+=text(vlabels[i],vvoffset,color="blue",fontsize=15)
          plot3+=arrow((T(3.1)[0]-4,T(3.1)[1]),(T(3.4)[0]-4,T(3.4)[1]),color="red")
          dT=T(3.4)-T(3.1)
          plot3
<!-- 
          tpoints=[3.1,3.4]
          offsetx=[0.2,0.35]
          offsety=[0,0]
          labels=["$\\vec{r}_1(t_0)$","$\\vec{r}_1(t_0+\\Delta h)$"]
          vlabels=["$\\vec{T}(t_0)$","$\\vec{T}(t_0+\\Delta h)$"]
          var('t');
          r1(t)=((t^2/15+2)*cos(t),(1.5-t/12)*sin(t))
          v1(t)=diff(r1,t)
          T(t)=v1(t)/norm(v1(t))
          plot3=parametric_plot(r1(t),(t,3,4),aspect_ratio=1,color='black',thickness=2,axes=False)
          for i in range(len(tpoints)):
            position=r1(tpoints[i])
            withoffset=(position[0]+offsetx[i],position[1]+offsety[i])
            voffset=(position[0]+(T(tpoints[i])[0])/1.2-0.15-0.15*i,position[1]+(T(tpoints[i])[1])/1.2)
            vvoffset=(-4+(T(tpoints[i])[0])/2-0.15+0.45*i,(T(tpoints[i])[1])/2)
            plot3+=point([position],color='black',size=50)+text(labels[i],withoffset,fontsize=20,color='black')
            plot3+=arrow(r1(tpoints[i]),r1(tpoints[i])+T(tpoints[i]),color="blue")
            plot3+=arrow((-4,0),(T(tpoints[i])[0]-4,T(tpoints[i])[1]),color="blue")
            plot3+=text(vlabels[i],voffset,color="blue",fontsize=15)
            plot3+=text(vlabels[i],vvoffset,color="blue",fontsize=15)
          plot3+=arrow((T(3.1)[0]-4,T(3.1)[1]),(T(3.4)[0]-4,T(3.4)[1]),color="red")
          dT=T(3.4)-T(3.1)
          plot3+=text("$\\vec{T}(t_0+\\Delta h)-\\vec{T}(t_0)$",((T(3.1)[0]-4+T(3.4)[0]-4)/2,(T(3.1)[1]+T(3.4)[1])/2-0.1),color="red",fontsize=15)
          plot3+=arrow((T(3.1)[0]-4,T(3.1)[1]-0.5),(T(3.1)[0]-4+2.5*dT[0],T(3.1)[1]-0.5+dT[1]*2.5),color="red")
          plot3+=text("$\\frac{\\vec{T}(t_0+\\Delta h)-\\vec{T}(t_0)}{\\Delta h}$",(T(3.1)[0]-4+1.2*dT[0],T(3.1)[1]+dT[1]*1.2-0.65),color="red",fontsize=20)
          plot3 -->
        </sageplot>
      </image>
    </figure>
    <p>
      So for a step of size <m>\Delta s</m> in arc length along our curve, we have a change in direction of <m>\vT(s_0+\Delta s)-\vT(s_0)</m> in the direction of travel. In order to approximate the rate of change for the direction of travel, we will need to look at the ratio 
      <me>\frac{\vT(s_0+\Delta s)-\vT(s_0)}{\Delta s}</me>.
    </p>
    <p>
      The unit normal vector <m>\vN</m> points in the direction of turning. We want to measure as a <em>scalar</em> how quickly the direction of turning is changing along our path. To do this, we compute the magnitude of this difference quotient as an approximation of rate of change for the direction of travel on the interval <m>[s_0,s_0+\Delta s]</m>. This gives
      <me>\vecmag{ \frac{\vT(s_0+\Delta s)-\vT(s_0)}{\Delta s}  }</me>,
      which completes the first step of the classic calculus approach. We now consider smaller step sizes in the parameter, which corresponds to smaller changes in arc length along the curve because we have a unit speed parameterization. In doing so, we obtain a better approximation of how fast the direction of travel is changing along the path at the point <m>\vr_1(s_0)</m>. 
    </p>
    <p>
      Taking the limit as <m>\Delta s \rightarrow 0</m>, completes step three of the classic calculus approach to measure how quickly a curve is turning at the point <m>P=\vr_1(s_0)</m>. Calculating, we have
      <me>
        \lim_{\Delta s \rightarrow 0} \vecmag{ \frac{\vT(s_0+\Delta s)-\vT(s_0)}{\Delta s}  }  = \vecmag{ \frac{d\vT}{ds} }
      </me>.
    </p>
    <p>
      This leads us to the following definition:
    </p>
    <definition>
      <statement>
        <p>
          If <m>C</m> is a smooth space curve and <m>s</m> is the parameter for the unit speed parameterization of <m>C</m>, then the <term>curvature</term><idx><h>curvature</h></idx>, <m>\kappa</m>, of <m>C</m> is
          <me>
            \kappa = \kappa(s) = \vecmag{ \frac{d \vT}{ds} }
          </me>
        </p> 
      </statement>
    </definition>
    <p>
      Remember that the parameter <m>s</m> for the unit speed parameterization <m>C</m> is the arc length traveled along the curve. Curvature is denoted by <m>\kappa</m>, the lowercase Greek letter <q>kappa</q>.
    </p>

    <worksheet>
  <activity xml:id="act-VVF-curvature-line-circle">
      <introduction>
        <p>
          In this activity we will use our previous work in finding unit speed parameterizations of lines and circles to make sense of the definition of curvature.
        </p>
      </introduction>
      <task>
        <statement>
          <p>
            Recall that in <xref ref="linearclength"/> we found that the unit speed parameterization of a line through the points <m>(1,2,3)</m> and <m>(2,0,5)</m> to be <m>\vr_1(t)= \langle 1,2,3\rangle + \frac{t}{3} \langle 1,-2,2 \rangle</m>. 
            Calculate <m>\vT(s)</m>, <m>\frac{d\vT}{ds}</m>, and <m>\vecmag{ \frac{d\vT}{ds} }</m> for the unit speed parameterization of this line.
          </p>
        </statement>
      </task>
      <task>
        <statement>
          <p>
            Write a few sentences to explain why your result for the calculation of the curvature <m>\kappa=\vecmag{ \frac{d\vT}{ds} }</m> for this line makes sense. <xref ref="ez-VVF-curvature-line" text="type-local"/> asks you to do the calculations to confirm this property of an arbitrary line.
          </p>
        </statement>
      </task>
      <task>
        <statement>
          <p>
            Recall that we concluded <xref ref="act-VVF-arclength-circle-helix"/> by noting giving a  parameterization of circle in 2-space of radius <m>R</m> centered at
            the origin as <m>\langle R\cos(t),R\sin(t)</m>. A quick calculation can verify that this parameterization has constant speed and that speed is <m>R</m>. Modifying this parameterization by multiplying the parameter by <m>\frac{1}{\text{speed}}=\frac{1}{R}</m> gives the following parameterization:
          <me>
            \vr(s) = \left\langle R \cos\left(\frac{s}{R}\right), R \sin\left(\frac{s}{R}\right)\right\rangle
          </me>
          Compute the speed of this parameterization to verify that this has unit speed. This will also show that <m>\vr\, '(s)=\vv(s)=\vT(s)</m>. (Recall that this fact is not true in general!)
          </p>
        </statement>
      </task>
      <task>
        <statement>
          <p>
            Calculate <m>\vT(s)</m>, <m>\frac{d\vT}{ds}</m>, and <m>\vecmag{ \frac{d\vT}{ds} }</m> for the unit speed parameterization of a circle of radius <m>R</m> centered at the origin.
          </p>
        </statement>
        <solution>
          <p>
            We have
            <me>
              \vT(s) = \left\langle -\sin\left(\frac{s}{R}\right), \cos\left(\frac{s}{R}\right) \right\rangle
            </me>.
            Thus, the curvature of a circle of radius <m>R</m> is
            <md>
              <mrow>\kappa \amp = \left\lvert \frac{d \vT}{ds} \right\rvert</mrow>
              <mrow>\amp = \left\lvert \left\langle -\frac{1}{R}\cos\left(\frac{s}{R}\right), -\frac{1}{R}\sin\left(\frac{s}{R}\right) \right\rangle \right\rvert</mrow>
              <mrow>\amp = \frac{1}{R}</mrow>
            </md>. 
          </p>
        </solution>
      </task>
      <task>
        <statement>
          <p>
            Write a few sentences to explain why your result for the calculation of <m>\kappa=\vecmag{ \frac{d\vT}{ds} }</m> of circle will be constant. You should also address why circles with larger radii will have have smaller curvature.
          </p>
        </statement>
      </task>
    </activity>
</worksheet>
    <p>
      Notice that a unit speed parameterization will have the property that <m>\vr_1\, '(s)=\vv(s)=\vT(s)</m>. While this fact is not true in general, it does make the calculation and interpretation of <m>\vT</m> as simple as possible. It is also helpful to observe that a unit speed parameterization has the property that <m>\vT(s) = \va(s)</m>, the acceleration vector of the curve. Thus, when we have a unit speed parameterization for a path, we can think of the curvature of the path at a point as being the magnitude of the acceleration vector.
    </p>
    <p>
      The definition of curvature relies on our ability to parameterize curves with unit speed. Since finding unit speed parametrization is frequently difficult to compute directly, the following theorem gives a way of computing the curvature of a curve in terms of <em>any</em> parametrization <m>\vr(t)</m>.
    </p>
    <theorem xml:id="thm-calc-curvature">
      <statement>
        <p>
          If <m>\vr</m> is a parameterization of a curve <m>C</m>, and if <m>\vr\, '(t)\neq \vzero</m> and <m>\vr\, ''(t)</m> exists, then the curvature <m>\kappa</m> of <m>C</m> can be calculated by
          <me> \kappa(t) = \frac{\vecmag{ \vT'(t) }}{ \vecmag{ \vr\, '(t) }}</me>.
        </p>
        <p>
          Further, we can efficiently calculate curvature in terms of the velocity and acceleration functions as
          <men xml:id="ec-curv">\kappa = \frac{\vecmag{ \vr\, '(t) \times \vr\, ''(t) }}{\vecmag{ \vr\, '(t) }^3}= \frac{\vecmag{ \vv(t) \times \va(t) }}{\vecmag{ \vv(t) }^3}</men>.
        </p>
      </statement>
      <proof>
        <p>
          We will give the outline of a proof of the first result here in order to emphasize that this result comes from a chain rule argument related to <xref ref="coordchangetounitspeed" text="custom">the change of parameters going to a unit speed parameterization</xref>. 
        </p>
        <p>
          Let <m>\vr(t)</m> be some parameterization of the curve <m>C</m>. To calculate the curvature, <m>\vT</m> must have an input corresponding to the parameter of the unit speed parameterization. This means that the input of <m>\vT</m> must measure the arc length of <m>C</m> to the point of interest. We will use a function <m>s(t)</m>. The input to this function is the parameter of <m>\vr(t)</m>, and the output of <m>s(t)</m> is the arc length on <m>C</m> to the point <m>\vr(t)</m>. Note that <m>s(t)</m> is computed using <xref ref="Length-of-a-curve" /> and that the derivative <m>\frac{ds}{dt}</m> will be <m>\vecmag{\vr\, '(t)}</m>. 
        </p>
        <p>
          We can write <m>\vT</m> as a function of the parameter <m>t</m> by the composition <m>\vT(t)=\vT(s(t))</m>. Taking the derivative of this composition with respect to <m>t</m> uses a chain rule argument:
          <me>
            \frac{d\vT}{dt}=\frac{d}{dt}\left(\vT(s(t))\right)=\frac{d\vT}{ds} \frac{ds}{dt}
          </me>.
          Note here that <m>\frac{d\vT}{dt}=\vT\, '</m> is the same derivative of <m>\vT</m> we have seen a few times. 
        </p>
        <p>
          Because <m>\frac{ds}{dt}</m> is a scalar-valued function, we can divide both sides of the equation by it to get
          <me>
           \frac{\vT\, '}{\frac{ds}{dt}}=\frac{d\vT}{ds}
          </me>.
          Using the idea above from <xref ref="Length-of-a-curve" />, we can substitute <m>\frac{ds}{dt}= \vecmag{\vr\, '(t)}</m>. Computing the magnitude of each side yields
          <men xml:id="eqn-curv">\vecmag{ \frac{\vT\, '}{\vecmag{\vr\, '(t)}} } = \vecmag{\frac{d\vT}{ds} } =\kappa</men>.
        </p>
        <p>
          There is also a nice conceptual interpretation of the equation above. Specifically, if we want to convert a measurement such as curvature or the derivative of <m>\vT</m> between the unit speed parameterization and any other parameterization, we adjust by the speed. Equation <xref ref="eqn-curv"/> shows that the adjustment between the derivative of <m>\vT</m> with respect to the unit speed parameter and another parameter is to divide by the speed, which may vary depending on time (or position).
        </p>
        <p>
          We omit the proof of <xref ref="ec-curv"/> because the argument involves technical algebraic ideas that do not offer geometric insight into what curvature measures. <xref ref="Ez_9_8_5" text="type-local" /> guides you through this calculation.
        </p>
      </proof>
    </theorem>
    <p>
      Soon we will turn to an example of calculating curvature and then some activities for you to practice. Frist, however, we consider how we can use <xref ref="ec-curv"/> to make sense of when curvature is undefined (or does not make sense). From an algebraic perspective, the curvature cannot be defined when the speed is zero. This should make sense because if you are not moving along the curve, as indicated by having speed equal to zero, then it does not make sense to measure how quickly the curve is turning. In <xref ref="S-VVF-Spliting-Acceleration" />, we consider why <m>\vecmag{ \vv(t) \times \va(t) }</m> being zero means that there will be zero curvature. This is different than the curvature being undefined!
    </p>
    <example>
      <p>
        In this example, we will calculate the curvature of the parabola given by <m>y=x^2</m> for <m>-2 \lt x \lt 2</m>. We would like to use <xref ref="ec-curv" /> to calculate the curvature, so we must parameterize this curve in three dimensions with the <m>z</m>-component constantly zero. This is because the cross product is only defined for three-dimensional vectors. The vector-valued function <m>\vr(t)=\langle t,t^2,0\rangle</m> with <m>-2\leq t\leq 2</m> will parameterize the curve given by <m>y=x^2</m> for <m>-2 \lt x \lt 2</m>.
      </p>
      <figure xml:id="paracurv1">
        <caption> A plot of <m>y=x^2</m> with points <m>(0,0)</m> and <m>(-1,1)</m></caption>
        <image width="55%">
          <shortdescription>A parabola with two points marked</shortdescription>
          <description><p>A parabola with vertex a the origin. The points <m>(0,0)</m> and <m>(-1,1)</m> are marked on the parabola. </p></description>
          <prefigure xmlns="https://prefigure.org"
                     label="img-paracurv1">
            <diagram dimensions="(320,320)" margins="5">
              <definition>f(x)=x^2</definition>
              <definition>a = 1</definition>
              <coordinates bbox="(-2.1,-0.5,2.1,4.1)">
                <grid-axes xlabel="x" ylabel="y"/>
                <graph function="f" domain="[-2,2]" />
                <point p="(0,f(0))"/>
                <point p="(-1,f(-1))"/>  
              </coordinates>
            </diagram>
          </prefigure>
          <!-- <sageplot>
            var('t,x')
            plot4=plot(x^2, (x,-2,2),aspect_ratio=1,gridlines=True,color="black",thickness=2,axes_labels=["$x$","$y$"])
            plot4+=point((0,0),size=50,color="black",xmin=-2,xmax=2,ymin=-0.5,ymax=4)
            plot4+=point((-1.5,9/4),size=50,color="black",xmin=-2,xmax=2,ymin=-0.5,ymax=4)
            plot4
          </sageplot> -->
        </image>
      </figure>
      <p>  
        Using this parameterization, we compute the following:
        <md>
          <mrow>\vv(t) = \vr\, '(t) \amp=\langle1,2t,0\rangle </mrow>
          <mrow>\va(t) = \vr\, ''(t) \amp=\langle0,2,0\rangle </mrow>
          <mrow>\vv(t)\times\va(t) \amp=\langle0,0,2\rangle </mrow>
          <mrow>\vecmag{\vv(t)\times\va(t)} \amp=2 </mrow>
          <mrow>\vecmag{\vv(t)} \amp=\sqrt{1+4t^2} </mrow>
        </md>
        Using <xref ref="ec-curv" />, the curvature is
        <me>
          \kappa(t) = \frac{\vecmag{ \vv(t) \times \va(t) }}{\vecmag{ \vv(t) }^3} = \frac{2}{(1+4t^2)^{3/2}}
        </me>.
      </p>
      <p>
        Comparing the points <m>(0,0)</m> and <m>(-2,4)</m> on <xref ref="paracurv1" />, you can see that the path bends more at <m>(0,0)</m> than at <m>(-1,1)</m>, which corresponds to the parabola having larger curvature at <m>(0,0)</m> than at <m>(-1,1)</m>. Using the formula we obtained above, we can see that at <m>(0,0)</m>, when <m>t=0</m>, the curvature is <m>\kappa(0)=2</m> while at <m>(-1,1)</m>, when <m>t=-1</m>, the curvature is <m>\kappa(-1)=\frac{2}{(5)^{3/2}}\approx0.179</m>. This calculation of curvature matches with our visual description from above.
      </p>
    </example>
      <!-- <p>
        We can also think of the curvature as a function of the parameter being used (in our case <m>t=x</m>). A plot of <m>\kappa(t) = \frac{2}{(1+4t^2)^{3/2}}</m> as a function of <m>t=x</m> is shown in <xref ref="curvparabola"/>. You can see that the curvature is highest near the vertex of the parabola and the curvature gets closer to zero as you look farther up the parabola. This should make sense because the parabola is <q>flatter</q> away from the origin.
      </p>
      <figure xml:id="curvparabola">
        <caption> A plot of the curvature of <m>y=x^2</m> as a function of <m>x</m></caption>
        <image width="55%" xml:id="img-curvparabola">
          <description><p>A 2D curve with points </p></description>
          <sageplot>
            var('t,x')
            plot5=plot(2/(1+4*x^2)^(3/2), (x,-2,2),aspect_ratio=1,gridlines=True,color="black",thickness=2,axes_labels=["$t=x$","Curvature $\\kappa$"])
            plot5
          </sageplot>
        </image>
      </figure> -->
      <p>
        Suppose at the instant <m>t=x=0</m> you were driving along the path given by <m>y=x^2</m> at unit speed and your steering wheel locked up preventing you from changing how you were turning. Because the steering wheel is held fixed, you will no longer stay on the path given by <m>y=x^2</m>. Instead, your car will drive in a circle, and we can figure out what the radius of that circle would be by using curvature.
      </p>
      <p>
        In <xref ref="act-VVF-curvature-line-circle"/>, we saw that the curvature of a circle of radius <m>R</m> is <m>\frac{1}{R}</m>, so it hopefully is not too surprising that the radius of the circle in which the car would match. In fact, the radius of this circle will be <m>\frac{1}{\kappa(0)}=\frac{1}{2}</m>. In general, the <term>radius of curvature</term> is defined to be <m>\frac{1}{\kappa}</m> and the circle that is tangent to the curve at the point where the curvature is measured with radius <m>\frac{1}{\kappa}</m> is called the <term>osculating circle</term>. The osculating circle can be described as the circle that best approximates the curve at the point since the osculating circle goes through the point and has the same curvature as the original path. 
      </p>
      <p>  
        In <xref ref="paracurv2" />, you can see a plot of the path <m>y=x^2</m> with the osculating circle drawn at a particular point. Adjust the slider to change the parameter value (and thus point) at which the osculating circle is drawn. Notice how the radius of the circle becomes larger as the point moves farther away from the vertex in either direction. Remember that curvature and the radius of curvature have an <em>reciprocal relationship</em>: large curvature means small radius and small curvature means large radius. 
      </p>
      <figure xml:id="paracurv2">
        <caption>A plot of <m>y=x^2</m> with the osculating circle drawn tangent to the curve</caption>
        <interactive label="interactive-paracurv2" platform="sage" width="100%" aspect="1:1">
          <slate surface="sage">
            var('s,t,x')
            @interact
            def paracurv(a=slider(-2,2,1/10,default=0,display_value=False,label="Parameter Value")):
              plot6=plot(x^2, (x,-2,2),aspect_ratio=1,gridlines=True,color="black",thickness=2)
              plot6+=point((a,a^2),size=30,color="black",xmin=-2,xmax=2,ymin=-0.5,ymax=4)
              k(s)=2/(1+4*s^2)^(3/2)
              plot6+=parametric_plot((cos(t)/k(a)-2*a/k(a)/(1+4*a^2)^(1/2)+a,sin(t)/k(a)+1/(1+4*a^2)^(1/2)/k(a)+a^2),(t,0,2*pi),color="blue",thickness=2,zorder=3)
              show(plot6)
          </slate>
        </interactive>
      </figure>
    
    <worksheet>
  <activity xml:id="act-VVF-curvature-ellipse-helix">
      <introduction>
        <p>
          In this activity, we calculate the curvature of an ellipse and of a helix and use graphs to help with our understanding
        </p>
      </introduction>
      <task workspace="3cm">
        <statement>
          <p>
            Consider the ellipse shown below. We have omitted the scale on the axes because we want to think of this as the general ellipse <m>\frac{x^2}{a^2} + \frac{y^2}{b^2} = 1</m>, which has parameterization
            <me>
              \vr_1(t) = \langle a\cos(t), b\sin(t) \rangle
            </me>.
            (The ellipse pictured below has <m>a\gt b</m>.)
          </p>
          <image width="50%">
            <shortdescription>An ellipse</shortdescription>
            <description>
              <p>An ellipse centered at the origin. The ellipse is wider than it is tall.
              </p>
            </description>
            <prefigure xmlns="https://prefigure.org" label="img-VVF-curvature-ellipse-no-labels">
              <diagram dimensions="(300,300)" margins="5">
                <definition>f(x,y)=x^2/7+y^2/2</definition>
                <definition>a = 1</definition>
                <coordinates bbox="(-3,-3,3,3)">
                  <grid-axes xlabel="x" ylabel="y" decorations="no" />
                  <implicit-curve function="f" k="1" stroke="blue" /> 
                </coordinates>
              </diagram>
            </prefigure>
          </image>
          <p>
            On the graph, identify the points at which you believe the curvature to be the largest and the points at which you believe the curvature is smallest.
          </p>
        </statement>
      </task>
      <task xml:id="task-act-VVF-curvature-ellipse-helix-v-a">
        <statement>
          <p>
            For the given parameterization of the ellipse, find <m>\vv(t)</m> and <m>\va(t)</m>. Also identify the parameter values that correspond to the points of the ellipse with the largest and smallest <m>x</m> or <m>y</m> coordinates.
          </p>
        </statement>
      </task>
      <task>
        <statement>
          <p>
            Using your calculations for <m>\vv(t)</m> and <m>\va(t)</m> from <xref ref="task-act-VVF-curvature-ellipse-helix-v-a" text="type-local"/> in Equation <xref ref="ec-curv" /> to find a formula for the curvature of the ellipse with the given parameterization. Use your formula to find the curvature of the ellipse at the parameter values you identified in <xref ref="task-act-VVF-curvature-ellipse-helix-v-a" text="type-local"/> as corresponding to the extreme points of the ellipse.
          </p>
        </statement>
        <hint>
          <p>
            Remember that to compute the cross product here, you will need to consider <m>\vv</m> and <m>\va</m> as three-dimensional vectors.
          </p>
        </hint>
        <solution>
          <p>
            We have
              <me>
                \vT(t) = \left\langle -\frac{a\sin(t)}{\sqrt{a^2\sin^2(t) + b^2\cos^2(t)}}, \frac{b\cos(t)}{\sqrt{a^2\sin^2(t) + b^2\cos^2(t)}} \right\rangle
              </me>
              and
              <me>
                \vT'(t) = \left\langle -\frac{ab^2\cos(t)}{\left(a^2\sin^2(t) + b^2\cos^2(t)\right)^{3/2}}, -\frac{a^2b\sin(t)}{\left(a^2\sin^2(t) + b^2\cos^2(t)\right)^{3/2}} \right\rangle
              </me>.
              So the curvature of the ellipse is given by
              <md>
                <mrow>\kappa(t) \amp = \frac{1}{\left(a^2\sin^2(t) + b^2\cos^2(t)\right)^2} \sqrt{(ab^2\cos(t))^2 +(a^2b\sin(t))^2}</mrow>
                <mrow>\amp = \frac{ab}{\left(a^2\sin^2(t) + b^2\cos^2(t)\right)^2} \sqrt{b^2\cos^(t) + a^2\sin^2(t)}</mrow>
                <mrow>\amp = \frac{ab}{\left(a^2\sin^2(t) + b^2\cos^2(t)\right)^{3/2}}</mrow>
              </md>.
          </p>
        </solution>
      </task>
      <task>
        <statement>
          <p>
            While it is possible to use single-variable calculus techniques to find the parameter values that maximize and minimize <m>\kappa(t)</m> on the interval <m>[0,2\pi]</m>, the algebra involved masks much of the insight. Use graphing technology such as Desmos to plot the curvature function you found above, preferably with sliders that allow you to adjust the values of <m>a</m> and <m>b</m>. Write a couple of sentences about what you observe about the parameter values that maximize and minimize curvature and how they depend on <m>a</m> and <m>b</m>. Then use the general form of the curvature function from above to find the curvature at these parameter values, simplifying as much as possible.
          </p>
        </statement>
        <solution>
          <p>
            Working in Desmos, it becomes clear that with <m>a\gt b</m>, the curvature is always maximized at the points where <m>t=0</m> (or <m>t=2\pi</m>) and <m>t=\pi</m> and the curvature is minimized at the points where <m>t=\pi/2</m> and <m>t=3\pi/2</m>. Simplifying gives <m>\kappa(0)=\kappa(\pi)=a/b^2</m> and <m>\kappa(\pi/2)=\kappa(3\pi/2) = b/a^2</m>.
          </p>
          <p>
            To more rigorously verify thse claims, consider the following. If we assume that <m>0 \lt  b \lt  a</m>, then we should expect that ellipse to have the largest curvature at the points <m>(\pm a, 0)</m> and the smallest at the points <m>(0, \pm b)</m> (when <m>t = \frac{\pi}{2} + \pi k</m> for some integer <m>k</m>). The denominator of our curvature function can be written as
            <me>
              a^2(1-\cos^2(t)) + b^2 \cos^2(t) = a^2 - (a^2-b^2)\cos^2(t)
            </me>
            The curvature of the ellipse is largest when this denominator is smallest, or when <m>t = 0</m> or <m>t=\pi</m>. These <m>t</m> values correspond to the points <m>(\pm a, 0)</m>. Similarly, the curvature of the ellipse is smallest when the denominator is largest, or when <m>t = \frac{\pi}{2}</m> and <m>t = \frac{3\pi}{2}</m>. These <m>t</m> values correspond to the points <m>(0, \pm b)</m> as expected.
          </p>
        </solution>
      </task>
      <task>
        <statement>
          <p>
            The standard helix has parameterization <m>\vr_2(t) = \cos(t) \vi + \sin(t) \vj + t \vk</m>.  Find the curvature of the helix using this parameterization.
          </p>
        </statement>
        <solution>
          <p>
            Here we have
              <me>
                \vr_2\, '(t) = (-\sin(t)) \vi + \cos(t) \vj + \vk
              </me>
              and
              <me>
                \vT(t) = \frac{1}{\sqrt{2}}\left( (-\sin(t)) \vi + \cos(t) \vj + \vk \right)
              </me>.
              Then
              <me>
                \vT'(t) = \frac{1}{\sqrt{2}}\left( (-\cos(t)) \vi - \sin(t) \vj \right)
              </me>
              and so
              <me>
                \kappa(t) = \frac{1}{2}
              </me>
          </p>
        </solution>
      </task>
      <task>
        <statement>
          <p>
            Write a few sentences to describe why the curvature of the helix given above is constant. You may want to include a plot of the curve. 
          </p>
        </statement>
      </task>
    </activity>
</worksheet>

    <p>
      Before concluding this section, it may be helpful to think about what the units are on curvature. To do this, we again consider the formula that is in terms of velocity and acceleration:
      <me>
        \kappa = \frac{\vecmag{\vv\times\va}}{\vecmag{\vv}^3}
      </me>
      If we assume that our parameterization has distance with units of meters and input is thought of as time measured in seconds, then the units on <m>\vv</m> are meters per second and the units on <m>\va</m> are meters per second-squared. This means the numerator of <m>\kappa</m> has units meters per second-cubed and the denominator is measured in meters-cubed per second-cubed. Simplifying, we find that curvature has units one over meters. This aligns with the idea of the radius of curvature being <m>1/\kappa</m>, as it results radius of curvature having meters as its unit. That makes sense for something that we call a radius!
    </p>

    <worksheet>
  <activity>
      <introduction>
        <p>
          In this activity we will look at the measurement of curvature and determine if curvature is a property of the driver or a property of the road. This is a continuation of <xref ref="driver_road_act" />. As a reminder, a measurement is a property of the driver if the value(s) of that measurement <em>can</em> be different for different drivers (when measured at the same location on the racetrack). A measurement is a property of the road when different drivers <em>must</em> have the same value(s) (when measured at the same location on the racetrack).
        </p>
      </introduction>
      <task>
        <statement>
          <p>
           Is curvature a property of the driver or the road? Write a few sentences about your reasoning and be sure to address why every driver may or may not have the same measurement at the same location on the track. 
          </p>
        </statement>
      </task>
      <task>
        <statement>
          <p>
            What is the curvature on a straightaway (the race track is a line segment)? What would the radius of curvature be for a straightaway? Write a couple of sentences to justify your answers. 
            
          </p>
        </statement>
      </task>
    </activity>
</worksheet>
  </subsection>
  <outcomes>
    <ul>
      <li>
        <p>
          We define the curvature <m>\kappa</m> of a curve in 2- or 3-space to be the rate of change of the magnitude of the unit tangent vector with respect to arc length, or
          <me>
            \kappa = \vecmag{ \frac{d\vT}{ds} }
          </me>
        </p>
      </li>
      <li>
        <p>
          Curvature can be efficiently calculated by the following formula for curves in space:
          <me>
            \kappa = \frac{\vecmag{ \vr\, '(t) \times \vr\, ''(t) }}{\vecmag{ \vr\, '(t) }^3}= \frac{\vecmag{ \vv(t) \times \va(t) }}{\vecmag{ \vv(t) }^3}
          </me>
        </p>
      </li>
      <li>
        <p>
          The radius of curvature is <m>\frac{1}{\kappa}</m> and describes the radius of a circle corresponding to how quickly a path is turning.
        </p>
      </li>
    </ul>
    
  </outcomes>

    <xi:include href="exercises/ez-S_VVF_Curvature.ptx" />
    
</section>
