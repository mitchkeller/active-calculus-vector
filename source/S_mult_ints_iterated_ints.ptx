<!-- **********************************************************************-->
<!-- Copyright 2013-2025                                                   -->
<!-- Nicholas Long, Mitchel Keller, Steven Schlicker                       -->
<!--                                                                       -->
<!-- This file is part of Active Calculus Multivariable.                   -->
<!--                                                                       -->
<!-- Permission is granted to copy, distribute and/or modify this document -->
<!-- under the terms of the Creative Commons BY-NC-SA license.  The work   -->
<!-- may be used for free by any party so long as attribution is given to  -->
<!-- the author(s), the work and its derivatives are used in the spirit of -->
<!-- "share and share alike"; no party may sell this work or any of its    -->
<!-- derivatives for profit.  All trademarks are the registered marks of   -->
<!-- their respective owners.                                              -->
<!-- **********************************************************************-->
<section xmlns:xi="http://www.w3.org/2001/XInclude" xml:id="sec-mult_int-iterated">
  <title>Iterated Integrals</title>
  <objectives>
      <ul>
        <li>
          <p>
            How do we evaluate a double integral over a rectangle as an iterated integral, and why does this process work?
          </p>
        </li>
      </ul>
  </objectives>
  <introduction component="instructor">
    <title>Notes to the Instructor and Dependencies</title>
    <p>
      This section introduces iterated integrals as an algebraic tool and motivates their use in evaluating double integrals by using a horizontal or vertical slicing of the domain. Because we are still using rectangular regions of integration, we do not yet introduce horizontally or vertically simple descriptions of regions in the plane. This section can likely be done in a single class but sets up many of the elements that will be defined and used in double integrals over non-rectangular regions. While this section can be given a quick description, the practice with the mechanics of slicing and setting up interated integrals to evaluate double integrals is an important step in student understanding. 
    </p>
  </introduction>
  <subsection>
    <title>Introduction</title>
    <p>
      In <xref ref="sec-mult_ints-double_ints_rects"/>, we defined the double integral of a continuous function <m>f = f(x,y)</m> over a rectangle <m>R = [a,b] \times [c,d]</m> as
      <me>
        \iint_R f(x,y) \, dA = \lim_{m,n \to \infty} \sum_{j=1}^n \sum_{i=1}^m f\left(x_{ij}^*, y_{ij}^*\right) \cdot \Delta A,
      </me>
      using the classic calculus approach. Thus <m>\iint_R f(x,y) \, dA</m> is a limit of double Riemann sums. However, while this definition tells us exactly what a double integral <em>is</em>, it is not very helpful for computing the <em>value</em> of a double integral. Fortunately, there is a way to view a double integral as an <term>iterated integral</term><idx><h>iterated integral</h><h>rectangular coordinates</h></idx>, which will make computations feasible in many cases.
    </p>

    <p>
      The viewpoint of an iterated integral is closely connected to an important idea from single-variable calculus. When we studied solids of revolution, such as the one shown in <xref ref="fig-mult_ints-iteration-solid_rot">Figure</xref>, we saw that in some circumstances we could slice the solid perpendicular to an axis and approximate the volume using circular disks or washers. From there, we were able to find the volume of each disk, after which we used an integral to add the volumes of the slices and found the total volume of the rotated solid. 
    </p>
    <figure xml:id="fig-mult_ints-iteration-solid_rot">
      <caption>A plot of a volume of revolution with circular disk used in estimating the enclosed volume</caption>
        <interactive label="interactive-fig-mult_ints-iteration-solid_rot" platform="sage" width="91%" aspect="1:1">
          <description><p>A plot of a volume of revolution with circular disk used in estimating the enclosed volume</p>
        </description><slate surface="sage">
            <xi:include href="interacts/surfrot.txt" parse="text"/>     
          </slate>
        </interactive>
    </figure>
    <p>  
      We will consider an example of this approach in the following Preview Activity. Specifically, you examine how to how use single-variable integrals along traces in a similar way to the rotation volume described above. We will generalize this approach in this section for double integrals over rectangular regions. In <xref ref="S-mult_ints-general"/>, we will look at using this technique on non-rectangular regions of integration. 
    </p>
    <worksheet>
  <exploration workspace="1.5in" xml:id="PA-mult_ints-iterated">
      <introduction>
        <p>
          In this activity we will explore the double integral of <m>f(x,y) = 25-x^2-y^2</m> on the rectangular domain <m>R</m> containing the points that satisfy <m>-3\leq x\leq 3</m> and <m>-4\leq y\leq 4</m>. As with partial derivatives, we may treat one of the variables in <m>f</m> as constant and think of the resulting function as a function of a single variable. We will now investigate what this means geometrically and algebraically when we integrate with one input variable fixed. 
        </p>
      </introduction>
      <task>
        <statement>
          <p>
            Let <m>a</m> be a fixed value in the interval <m>[-3,3]</m>. Compute 
            <me>\int_{-4}^4 f(a,y) dy </me>.
          </p>
        </statement>
        <answer>
          <p>
            <m>200-8a^2-128/3</m>
          </p>
        </answer>
        <solution>
          <p>
            We will integrate in terms of <m>y</m> to get
            <me>\int_{-4}{^4} 25-a^2-y^2 \, dy = 25 (8)-8a^2-y^3/3 \restrict{-4}^4 = 200-8a^2-128/3</me>
          </p>
        </solution>
      </task>
      <task>
        <statement>
          <p>
            The answer of the previous part depended on the value of <m>a</m>, but the process would be the exact same set of steps for every <m>a</m>. This allows us to define a function <m>A(x)</m> as 
            <me>
              A(x) = \int_{-4}^4 f(x,y) \, dy
            </me>.
            Write a couple of sentences to explain the geometric meaning of the value of <m>A(x)</m>. Your explanation should refer to different parts of <xref ref="fig-mult_ints-iteration-surftrace"/>, including the surface defined by <m>f</m> and the trace determined by the fixed value of <m>x</m>.
          </p> 
          <figure xml:id="fig-mult_ints-iteration-surftrace">
            <caption>A plot of the surface <m>z= 25-x^2-y^2</m> with a cross section shown at <m>x=a</m></caption>
              <interactive label="interactive-fig-mult_ints-iteration-surftrace" platform="sage" width="91%" aspect="1:1">
                <description><p>A plot of the surface <m>z= 25-x^2-y^2</m> with a cross section shown at <m>x=a</m></p>
              </description><slate surface="sage">
                  var('s,t,x,y,z')
                  f(x,y)=25-x^2-y^2
                  x1=-3;x2=3;y1=-4;y2=4;
                  param(s,t)=(s,t,f(s,t))
                  #set up grid      n is number of steps in s    m is number of steps in t  
                  #a1 is min s    a2 is max s   b1 is min t    b2 is max t
                  n=7;m=7;a1=x1;a2=x2;b1=y1;b2=y2; 
                  #c1 is surface color     o1 is surface opacity
                  #c2 and o2 are for constant t value traces
                  #c3 and o3 are for constant s value traces
                  c1="lightblue"; c2="black"; c3="black"; o1=0.5; o2=0.3; o3=0.3;
                  plot1=parametric_plot3d(param,(s,a1,a2),(t,b1,b2),color=c1,opacity=o1)
                  for i in range(n+1):
                    sv=a1+i/n*(a2-a1)
                    plot1+=parametric_plot3d(param(sv,t),(t,b1,b2),color=c2,opacity=o2)
                  for i in range(m+1):
                    tv=b1+i/m*(b2-b1)
                    plot1+=parametric_plot3d(param(s,tv),(s,a1,a2),color=c3,opacity=o3)
                  a=0.75;
                  plot1+=parametric_plot3d((a,t,s*f(a,t)),(t,b1,b2),(s,0,1),color="blue",opacity=0.6)
                  plot1+=text3d("x=a",(a,y1,20),color="blue",fontsize=25)
                  show(plot1,viewpoint=[[-0.2151,-0.5915,-0.7771],148.44],camera_position=[9.0426,10.7901,6.3889],aspect_ratio=(1,1,.2))
                </slate>
              </interactive>
          </figure>
        </statement>
        <answer>
          <p>
            Since <m>f(x,y) \geq 0</m> on the given domain, the value of <m>A(x)</m> tells us the area under the <m>y</m>-trace curve for that fixed value of <m>x</m>.
          </p>
        </answer>
        <solution>
          <p>
            Since <m>f(x,y) \geq 0</m> on the given domain, the value of <m>A(x)</m> tells us the area under the <m>y</m>-trace curve for that fixed value of <m>x</m>.
          </p>
        </solution>
      </task>
      <task>
        <statement>
          <p>
            Write a couple of sentences explaining the geometric meaning of <m>A(x_i^*) \ \Delta x</m>, where <m>x_i^*</m> is a fixed value of <m>x</m>. Your explanation should refer to the parts of  <xref ref="fig-mult_ints-iterated-PA_cross_y">Figure</xref>.
          </p>
          <figure xml:id="fig-mult_ints-iterated-PA_cross_y">
            <caption> </caption>
              <interactive label="interactive-fig-mult_ints-iterated-PA_cross_y" platform="sage" width="91%" aspect="1:1">
                <description><p>ADD ALT TEXT TO THIS IMAGE</p></description>
                <slate surface="sage">
                  <xi:include href="interacts/surftrace2.txt" parse="text"/>     
                </slate>
              </interactive>
          </figure>
        </statement>
        <answer>
          <p>
            Since <m>A(x_i^*)</m> is an area under the <m>y</m>-trace for the value <m>x = x_i^*</m>, when we multiply that area by a constant width <m>\Delta x</m>, we obtain the volume of a slab obtained by thickening the region under the <m>x=x_i^*</m> trace by a uniform thickness <m>\Delta x</m>.
          </p>
        </answer>
        <solution>
          <p>
            Since <m>A(x_i^*)</m> is an area under the <m>y</m>-trace for the value <m>x = x_i^*</m>, when we multiply that area by a constant width <m>\Delta x</m>, we obtain the volume of a slab obtained by thickening the region under the <m>x=x_i^*</m> trace by a uniform thickness <m>\Delta x</m>.
          </p>
        </solution>
      </task>     
      <!-- <figure xml:id="fig-mult_ints-iterated-PA_cross_y">
        <caption>Left: A cross section with fixed <m>x</m>. Right: A cross section with fixed <m>x</m> and <m>\Delta x</m>.</caption>
        <sidebyside widths="50% 50%">
          <image source="images/fig_11_2_preview_slice"/>
          <image source="images/fig_11_2_preview_thick"/>
          </sidebyside>
      </figure> -->
      <task>
        <statement>
          <p>
            Since <m>f</m> is continuous on <m>R</m>, we can define the function <m>A = A(x)</m> at every value of <m>x</m> in <m>[-3,3]</m>. Think about subdividing the <m>x</m>-interval <m>[-3,3]</m> into <m>m</m> subintervals and choosing a value <m>x_i^*</m> in each of those subintervals. Write a sentence describing the meaning of the sum <m>\sum_{i=1}^m A(x_i^*) \ \Delta x</m>.
          </p>
        </statement>
        <answer>
          <p>
            This sum will give us the sum of volumes of slabs with constant cross sections parallel to the <m>yz</m>-plane, where the cross sections look like the areas under the graphs of the <m>x_i^*</m> traces.
          </p>
        </answer>
        <solution>
          <p>
            This sum will give us the sum of volumes of slabs with constant cross sections parallel to the <m>yz</m>-plane, where the cross sections look like the areas under the graphs of the <m>x_i^*</m> traces.
          </p>
        </solution>
      </task>         
      <task>
        <statement>
          <p>
            Write a couple of sentences to explain why <m>\displaystyle\int_{-3}^3 A(x) \, dx</m> determines the exact value of the volume under the surface <m>z = f(x,y)</m> over the rectangle <m>R</m>.
          </p>
        </statement>
        <answer>
          <p>
            As we let <m>m</m> go to infinity, the thickness of the slabs goes to 0 and we are just adding up all of the cross sectional areas of the surface parallel to the <m>yz</m>-plane, and so
            <me>
              \int_{-3}^3 A(x) \, dx = \lim_{m \to \infty} \sum_{i=1}^m A(x_i^*) \ \Delta x
            </me>
            gives us the volume of the solid under the surface <m>z = f(x,y)</m> over the rectangle <m>R</m>.
          </p>
        </answer>
        <solution>
          <p>
            As we let <m>m</m> go to infinity, the thickness of the slabs goes to 0 and we are just adding up all of the cross sectional areas of the surface parallel to the <m>yz</m>-plane, and so
            <me>
              \int_{-3}^3 A(x) \, dx = \lim_{m \to \infty} \sum_{i=1}^m A(x_i^*) \ \Delta x
            </me>
            gives us the volume of the solid under the surface <m>z = f(x,y)</m> over the rectangle <m>R</m>.
          </p>
        </solution>
      </task>
    </exploration>
</worksheet>
  </subsection>

  <subsection>
    <title>Iterated Integrals</title>
    <p>
      The ideas that we explored in <xref ref="PA-mult_ints-iterated">Preview Activity</xref> work more generally and lead to the idea of an iterated integral. We will explore how these ideas generalize by considering a surface <m>z=f(x,y)</m> such as the one shown in <xref ref="fig-mult_ints-iterated-wavy_surface"/> over a rectangular region <m>R</m> satisfying <m>a\leq x\leq b</m> and <m>c\leq x\leq d</m>. Our goal will be to use an interated integral to find the volume beneath this surface and above the <m>xy</m>-plane over the region <m>R</m>.
    </p>
    <figure xml:id="fig-mult_ints-iterated-wavy_surface">
      <caption>A surface and the region below it</caption>
      <interactive label="interactive-mult_ints-iterated-wavy_surface" platform="sage" width="91%" aspect="1:1"> 
        <description><p>A surface and the region below it</p>
      </description><slate surface="sage">
          <xi:include href="interacts/iteratedintdemo1.txt" parse="text"/>
        </slate>
      </interactive>
    </figure>
    <p>
      To avoid technical issues, we assume that <m>f</m> is continuous. As in the Preview Activity, we define a function
      <me>
        A(x) = \int_c^d f(x,y) \, dy
      </me>.
      The function <m>A(x)</m> determines the net signed area of a slice of the solid. The slice has a fixed value of <m>x</m>. By adjusting the slider in <xref ref="fig-mult_ints-iterated-wavy_surface2"/>, you can see a tickened version of such a slice, which we will refer to as a slab. (Thus, a slice will is a <em>two</em>-dimensional object and a slab is a <em>three</em>-dimensional object.) You should also observe how the <em>shape</em> of the slice changes as the value of <m>x</m> changes. This illustrates how it is essential to use an integral to find the area of a cross section, as this area cannot be determined by using only the value of <m>x</m> and simple formulas from geometry.
    </p>
    <figure xml:id="fig-mult_ints-iterated-wavy_surface2">
      <caption>A slab with variable position underneath a surface </caption>
      <interactive label="interactive-mult_ints-iterated-wavy_surface2" platform="sage" width="95%" aspect="1:1.1"> 
        <description><p>A slab with variable position underneath a surface </p>
      </description><slate surface="sage">
          <xi:include href="interacts/iteratedintdemo2.txt" parse="text"/>
        </slate>
      </interactive>
    </figure>
    <p>
      If we add up the volumes of the slabs in <xref ref="fig-mult_ints-iterated-wavy_surface2"/>, then we obtain an approximation for the volume of the solid between the surface and the <m>xy</m>-plane over the region <m>R</m>. If we let <m>\Delta x</m> denote the thickness of each slab, the volume of the slab with constant <m>x</m>-value <m>x_i^*</m> is <m>A(x_i^*)\Delta x</m>. Hence, the sum
      <md>
        \sum_{i=1}^m A(x_i^*) \Delta x
      </md>
      is an approximation of this volume. This sum is a Riemann summ of the single-variable function <m>A</m>. Therefore, as we let the number <m>m</m> of slabs go to infinity we obtain the integral
      <md>
        \int_a^b A(x) \, dx
      </md>
      as the volume of the solid.
    </p>

    <!-- <p>
      As we let the number of subintervals in the <m>x</m> direction approach infinity, we can see that the Riemann sum <m>\sum_{i=1}^m A(x_i^*) \Delta x</m>
      approaches a limit and that limit is the sum of signed volumes bounded by the function <m>f</m> on <m>R</m>. Therefore, since <m>A(x)</m> is itself determined by an integral, we have
      <md>
        <mrow> \iint_R f(x,y) \, dA \amp= \lim_{m \to \infty} \sum_{i=1}^m A(x_i^*) \Delta x </mrow>
        <mrow> \amp= \int_a^b A(x) \, dx = \int_a^b \left[ \int_c^d f(x,y) \, dy \right] \, dx. </mrow>
      </md>
    </p> -->

   
    
    <!-- <figure xml:id="F_11_2_Cross_section_y_slab_sum">
      <caption> </caption>
        <interactive title="interactive-F_11_2_Cross_section_y_slab_sum" platform="sage" width="100%" aspect="1:1">
          <slate surface="sage">
            var('s,t,x,y,z')
            f(x,y)=25-x^2-y^2
            x1=-3;x2=3;y1=-4;y2=4;
            param(s,t)=(s,t,f(s,t))
            @interact
            def slicesinteract(ns=slider(3,25,1,default=5,label="Number of slices to use")):
              a1=x1;a2=x2;b1=y1;b2=y2; 
              xscale=5;yscale=5;zscale=30
              plot1=arrow((0,0,0),(xscale,0,0),color="black",opacity=0.5,width=2)+text3d("x",(xscale+0.5,0,0),fontsize=30)+text3d("y",(0,yscale+0.5,0),fontsize=30)+text3d("z",(0,0,zscale+0.5),fontsize=30)
              plot1+=arrow((0,0,0),(0,yscale,0),color="black",opacity=0.5)+arrow((0,0,0),(0,0,zscale),color="black",opacity=0.5)
              dx=6/ns;sc="pink";o4=.8;
              for i in range(ns+1):
                a=-3+i*dx
                plot1+=parametric_plot3d((a,t,s*f(a,t)),(t,b1,b2),(s,0,1),color=sc,opacity=o4)
                plot1+=parametric_plot3d((a+dx,t,s*f(a,t)),(t,b1,b2),(s,0,1),color=sc,opacity=o4)
                plot1+=parametric_plot3d((a+s,t,f(a,t)),(t,b1,b2),(s,0,dx),color="purple",opacity=o4)
                plot1+=parametric_plot3d((a+s,t,0),(t,b1,b2),(s,0,dx),color=sc,opacity=o4)
                plot1+=parametric_plot3d((a+s,4,t*f(a,4)),(t,0,1),(s,0,dx),color=sc,opacity=o4)
                plot1+=parametric_plot3d((a+s,-4,t*f(a,-4)),(t,0,1),(s,0,dx),color=sc,opacity=o4)
              show(plot1,viewpoint=[[-0.099,-0.6027,-0.7918],165.17],camera_position=[4.2065,9.5131,4.0273],aspect_ratio=(1,1,.2))
          </slate>
        </interactive>
    </figure> -->
    <!-- <figure xml:id="F_11_2_Cross_section_y_slab_sum">
      <caption>Summing volumes of cross section slices</caption>
      <sidebyside widths="33% 33% 33%">
      <image source="images/fig_11_2_preview_animate_0"/>
      <image source="images/fig_11_2_preview_animate_2"/>
      <image source="images/fig_11_2_preview_animate_5"/>
      </sidebyside>
    </figure> -->



    <p>
      Now remember how we originally defined <m>A(x)</m> by using an integral. Thus, since the double integral represents the (net signed) volume of the solid enclosed by the <m>xy</m>-plane and the surface <m>z=f(x,y)</m> over the region <m>R</m>, we have
      <md number="no" xml:id="eqn-iint">
        \iint_R f(x,y)\, dA = \int_a^b A(x)\, dx = \int_a^b \left[\int_c^d f(x,y)\, dy\right]\, dx = \int_a^b \int_c^d f(x,y) \, dy \, dx
      </md>.
      We call these nested integrals an <term>iterated integral</term>, which will prove to be a frequently-used tool for evaluating double integrals.
      
      <!-- Hence, we can compute the double integral of <m>f</m> over <m>R</m> by first integrating <m>f</m> with respect to <m>y</m> on <m>[c, d]</m>, then integrating the resulting function of <m>x</m> with respect to <m>x</m> on <m>[a, b]</m>. The nested integral
      <me>
        \int_a^b \left[ \int_c^d f(x,y) \, dy \right] \, dx = \int_a^b \int_c^d f(x,y) \, dy \, dx
      </me>
      is called an <em>iterated integral</em>, and we see that each double integral may be represented by two single integrals. -->
    </p>
    <p>
      In our future discussions of double integrals, it will be helpful to recognize the roles of the different components of an interated integral. When we consider
      <md>
        \int_a^b \int_c^d f(x,y) \, dy \, dx
      </md>,
      the differentials <m>dy</m> and <m>dx</m> carry both geometric and computational meaning. From a computational perspective, that <m>dy</m> is the <em>inner</em> differential tells us that the limits of integration on the inner integral sign are values of <m>y</m>: <m>c\leq y\leq d</m> for this rectangular region. Similarly, the position of <m>dx</m> as the <em>outer</em> differential tells us that when computing the inner integral, we consider <m>x</m> to be constant. After that computation is complete, we then have a single-variable integral on the interval with <m>a\leq x\leq b</m>. Thinking geometrically, since the inner integral computes the area of a cross section of the solid, we can think of <m>dy</m> as being the width of the rectangles whose areas are summed. Recalling that the <m>dx</m> arose from the limit where we had previously used <m>\Delta x</m> to find the volume of a slab, we see that the outer integral can be considered as summing up the volumes of slabs of thickness <m>dx</m>.
    </p>
    <!-- <p>
      We can also think of these iterated integrals as a description for evaluating one of our Riemann sums over fixed values (corresponding to the other input variable). As in our descriptions above, we can partition our space into pieces such that the inner sum of 
      <me>  \sum_{j=1}^m \sum_{i=1}^n f\left(x_{ij}^*, y_{ij}^*\right) \, \Delta A</me>
      corresponds to our gridding in <m>y</m> (along a constant value <m>x_i^*</m>). This corresponds to the inner sum being along a column of smaller rectangles, as shown in <xref provisional="iigrid"/>. 
    </p> -->

    <!-- <figure xml:id="iigrid">
      <caption>A splitting of a rectangular region of integration into smaller rectangles</caption>
        <image width="100%" xml:id="img-iigrid">
          <sageplot>
            from matplotlib import ticker
            a=0.5; b=9; c=1; d=3; m=4; n=6; dx=(b-a)/m; dy=(d-c)/n;
            tx=[a+dx*i for i in range(m+1)]; ty=[c+dy*i for i in range(n+1)]
            plot12=line([(a,c),(a,d),(b,d),(b,c),(a,c)],thickness=3,color="black",gridlines=True,ticks=[tx,ty],axes_labels=["$x$","$y$"],xmin=0,xmax=b+1,ymin=0,ymax=d,tick_formatter=(ticker.NullFormatter(),
            ticker.NullFormatter()))
            for i in range(m):
              plot12+=arrow((a+(dx/2)+dx*i,d-dy/2),(a+(dx/2)+dx*i,c+dy/2),color="gray")
            plot12+=text("$\\sum_{i=1}^n  \\, f(x_1^*,y^*_i) \\, \\Delta A$",(a+(dx/2),c-dy),color="black",fontsize=10)+text("$+$",(a+dx,c-dy),color="black",fontsize=10)
            plot12+=text("$\\sum_{i=1}^n \\, f(x_2^*,y^*_i) \\, \\Delta A$",(a+(dx/2)+dx,c-dy),color="black",fontsize=10)+text("$+$",(a+2*dx,c-dy),color="black",fontsize=10)
            plot12+=text("$\\sum_{i=1}^n \\, f(x_3^*,y^*_i) \\, \\Delta A$",(a+(dx/2)+2*dx,c-dy),color="black",fontsize=10)+text("$+$",(a+3*dx,c-dy),color="black",fontsize=10)
            plot12+=text("$\\sum_{i=1}^n \\, f(x_4^*,y^*_i) \\, \\Delta A$",(a+(dx/2)+3*dx,c-dy),color="black",fontsize=10)+text("$=$",(a+4*dx,c-dy),color="black",fontsize=10)
            plot12+=text("$\\sum_{j=1}^m \\, \\sum_{i=1}^n \\, f(x_j^*,y^*_i) \\, \\Delta A$",(a+(dx/2)+4*dx,c-2*dy),color="black",fontsize=10)
            plot12           
          </sageplot>
        </image>
    </figure> -->
    <!-- <p>
      Our outer sum will then correspond to the sum over each of these cross sectional areas (column sums). Because we are working with a rectangular region of integration, the limit as <m>n \to \infty</m> will make these column sums converge to integrals of the form <m>\int_c^d f(x_i^*,y) \, dy</m>, which we called <m>A(x^*_i)</m>. The outer sum will converge to the integral <m>\int_a^b A(x) \, dx</m>, giving the iterated integral form. 
    </p> -->

    <p>
      In our arguments above, we made the choice to integrate first with respect to <m>y</m> (holding <m>x</m> constant). We could just as easiy have chosen to hold <m>y</m> constant first, which yields the double integral as an iterated integral that integrates first with respect to <m>x</m>:
      <me>
        \iint_R f(x,y) \, dA = \int_c^d \left( \int_a^b f(x,y) \, dx \right) \, dy = \int_c^d  \int_a^b f(x,y) \, dx  \, dy
      </me>.
      <xref ref="fig-mult_ints-iterated-wavy_surface3"/> allows you to change the direction of slicing and provides a visualization of the slabs whose volumes are integrated by the outer integral in this iterated integral.
    </p>
     <figure xml:id="fig-mult_ints-iterated-wavy_surface3">
      <caption>Decomposition of the solid below a surface into slices along constant <m>x</m>-values or <m>y</m>-values</caption>
      <interactive label="interactive-mult_ints-iterated-wavy_surface3" platform="sage" width="95%" aspect="1:1.1"> 
        <description><p>Decomposition of the solid below a surface into slices along constant <m>x</m>-values or <m>y</m>-values</p>
      </description><slate surface="sage">
          <xi:include href="interacts/iteratedintdemo3.txt" parse="text"/>
        </slate>
      </interactive>
    </figure>
    <p>
      The fact that integrating in either order results in the same value is known as Fubini's Theorem.
    </p>

    <assemblage xml:id="Fubini-theorem">
      <title>Fubini's Theorem</title>
      <p>
        If <m>f = f(x,y)</m> is a continuous function on a rectangle <m>R = [a,b] \times [c,d]</m>, then
        <me>
          \iint_R f(x,y) \, dA = \int_c^d \int_a^b f(x,y) \, dx \, dy = \int_a^b \int_c^d f(x,y) \, dy \, dx.
        </me>
      </p>
    </assemblage>
    <p>
      Fubini's theorem enables us to evaluate double integrals by using iterated integrals instead of resorting to the limit definition. Working with one integral at a time, we can use the Fundamental Theorem of Calculus from single-variable calculus to find the exact value of each integral, starting with the inner integral.
    </p>
    <aside>
      <p>
        This is another time in which we trade a multi-dimensional problem (double integral) for multiple one-dimensional problems that we have much more experience with.
      </p>
       <image source="LBmeme.png" width="50%">
        <description><p>ADD ALT TEXT TO THIS IMAGE</p></description></image>
    </aside>
    <worksheet>
  <activity workspace="1.5in" xml:id="act-mult_ints-iterated_paraboloid">
      <introduction>
        <p>
          Let <m>f(x,y) = 25-x^2-y^2</m> on the rectangular domain <m>R</m> with <m>-3\leq x\leq 3</m> and <m>-4\leq y\leq 4</m>.
        </p>
      </introduction>
      <task>
        <statement>
          <p>
            Viewing <m>x</m> as a fixed constant, use the Fundamental Theorem of Calculus to evaluate the integral
            <me>
              A(x) = \int_{-4}^4 f(x,y) \, dy.
            </me>
            Note that you will be integrating with respect to <m>y</m>, and holding <m>x</m> constant.  Your result should be a function of <m>x</m> only.
          </p>
        </statement>
        <answer>
          <p>
            <m> \frac{472}{3} - 8x^2</m>
          </p>
        </answer>
        <solution>
          <p>
            Treating <m>x</m> as a constant we have
              <md>
                <mrow>A(x) \amp = \int_{-4}^4 f(x,y) \, dy</mrow>
                <mrow>\amp = \int_{-4}^4 25-x^2-y^2 \, dy</mrow>
                <mrow>\amp = \left[ (25-x^2)y - \frac{y^3}{3} \right] \mid_{-4}^4</mrow>
                <mrow>\amp = 8(25-x^2) - \frac{128}{3}</mrow>
                <mrow>\amp = \frac{472}{3} - 8x^2</mrow>
              </md>
          </p>
        </solution>
      </task>
      <task>
        <statement>
          <p>
            Next, use your result from (a) along with the Fundamental Theorem of Calculus to determine the value of <m>\int_{-3}^3 A(x) \, dx</m>.
          </p>
        </statement>
        <answer>
          <p>
            <m>800</m>
          </p>
        </answer>
        <solution>
          <p>
            Then
              <md>
                <mrow>\int_{-3}^3 A(x) \, dx \amp = \int_{-3}^3 \frac{472}{3} - 8x^2 \, dx</mrow>
                <mrow>\amp =  \left[ \frac{472}{3}x - \frac{8}{3}x^3 \right] \mid_{-3}^3</mrow>
                <mrow>\amp = 944 - 144</mrow>
                <mrow>\amp = 800</mrow>
              </md>
          </p>
        </solution>
      </task>
      <task>
        <statement>
          <p>
            What is the value of <m>\displaystyle{\iint_R f(x,y) \, dA}</m>? Write a sentence to interpret the meaning of this value for two out of the three different ways mentioned in <xref ref="keyidea-double-int-interp"/>.
          </p>
        </statement>
        <answer>
          <p>
            Using the results of parts (a) and (b) we have
            <me>
              \iint_R f(x,y) \, dA = \int_{-3}^3 \int_{-4}^4 f(x,y) \, dy \, dx = 800
            </me>.
            Since <m>f(x,y) \geq 0</m> on <m>R</m>, this result tells us that the volume of the solid bounded above the graph of <m>f</m> and below by the rectangle <m>R</m> is 800. The area of <m>R</m> is 48, so this result also tells us that the average value of <m>f</m> on <m>R</m> is <m>\frac{800}{48}</m>. Additionally, if <m>f</m> was a density of a material on the region of integration, there would be 800 units of material total in the region. 
          </p>
        </answer>
        <solution>
          <p>
            Using the results of parts (a) and (b) we have
            <me>
              \iint_R f(x,y) \, dA = \int_{-3}^3 \int_{-4}^4 f(x,y) \, dy \, dx = 800
            </me>.
            Since <m>f(x,y) \geq 0</m> on <m>R</m>, this result tells us that the volume of the solid bounded above the graph of <m>f</m> and below by the rectangle <m>R</m> is 800. The area of <m>R</m> is 48, so this result also tells us that the average value of <m>f</m> on <m>R</m> is <m>\frac{800}{48}</m>. Additionally, if <m>f</m> was a density of a material on the region of integration, there would be 800 units of material total in the region. 
          </p>
        </solution>
      </task>
    </activity>
</worksheet>

    <worksheet>
  <activity workspace="1.5in" xml:id="A_11_2_2">
      <introduction>
        <p>
          Let <m>f(x,y) = x+y^2</m> on the rectangle <m>R</m> with <m>0\leq x\leq 2</m> and <m>0\leq y\leq 3</m>.
        </p>
      </introduction>
      <task>
        <statement>
          <p>
            Evaluate <m>\displaystyle{\iint_R f(x,y) \, dA}</m> using an iterated integral.  Choose an order for integration by deciding whether you want to integrate first with respect to <m>x</m> or <m>y</m>.
          </p>
        </statement>
        <answer>
          <p>
             <m>24</m>
          </p>
        </answer>
        <solution>
          <p>
            We evaluate <m> \iint_R f(x,y) \, dA</m> as an iterated integral, integrating first with respect to <m>x</m>, then <m>y</m>:
            <md>
              <mrow>\iint_R f(x,y) \, dA \amp =  \int_{0}^{3} \int_{0}^{2} x+y^2 \, dx \, dy</mrow>
              <mrow>\amp = \int_{0}^{3}  \left[ \frac{x^2}{2} + xy^2 \right] \mid_{0}^{2}  \, dy</mrow>
              <mrow>\amp = \int_{0}^{3} \left[ 2 + 2y^2 \right]  \, dy</mrow>
              <mrow>\amp = \left[ 2y + \frac{2}{3}y^3 \right] \mid_{0}^{3}</mrow>
              <mrow>\amp = 24</mrow>
            </md>
          </p>
        </solution>
      </task>
      <task>
        <statement>
          <p>
            Evaluate <m>\displaystyle{\iint_R f(x,y) \, dA}</m> using the iterated integral whose order of integration is the opposite of the order you chose in (a).
          </p>
        </statement>
        <answer>
          <p>
            <m>24</m>
          </p>
        </answer>
        <solution>
          <p>
            We evaluate <m> \iint_R f(x,y) \, dA</m> as an iterated integral, integrating first with respect to <m>y</m>, then <m>x</m>:
            <md>
              <mrow>\iint_R f(x,y) \, dA \amp =  \int_{0}^{2} \int_{0}^{3} x+y^2 \, dy \, dx</mrow>
              <mrow>\amp = \int_{0}^{2}  \left[ xy + \frac{y^3}{3} \right] \mid_{0}^{3}  \, dx</mrow>
              <mrow>\amp = \int_{0}^{2} \left[ 3x + 9 \right]  \, dx</mrow>
              <mrow>\amp =  \left[ \frac{3}{2}x^2 + 9x \right] \mid_{0}^{2}</mrow>
              <mrow>\amp = 24</mrow>
            </md>
          </p>
        </solution>
      </task>
    </activity>
</worksheet>
  </subsection>
  <outcomes>
    <ul>
      <li>
        <p>
          We can evaluate the double integral <m>\iint_R f(x,y) \, dA</m> over a rectangle <m>R = [a,b] \times [c,d]</m> as an iterated integral in one of two ways:
          <ul>
            <li>
              <p>
                <m>\displaystyle{\int_a^b \left[ \int_c^d f(x,y) \, dy \right] \, dx}</m>, or
              </p>
            </li>
            <li>
              <p>
                <m>\displaystyle{\int_c^d \left[ \int_a^b f(x,y) \, dx \right] \, dy}</m>.
              </p>
            </li>
          </ul>
          This process works because each inner integral represents a cross-sectional (signed) area and the outer integral then sums all of the cross-sectional (signed) areas. Fubini's Theorem guarantees that the resulting value is the same, regardless of the order in which we integrate.
        </p>
      </li>
    </ul>

  </outcomes>

    <xi:include href="exercises/ez-S_multi_ints_iterated_ints.ptx"/>
</section>
